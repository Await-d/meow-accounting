(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8953],{29227:function(e,a,t){Promise.resolve().then(t.bind(t,25700))},57977:function(e,a,t){"use strict";t.d(a,{Z:function(){return c}});var s=t(64090);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return a.filter((e,a,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===a).join(" ").trim()};/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s.forwardRef)((e,a)=>{let{color:t="currentColor",size:n=24,strokeWidth:r=2,absoluteStrokeWidth:c,className:o="",children:d,iconNode:m,...u}=e;return(0,s.createElement)("svg",{ref:a,...l,width:n,height:n,stroke:t,strokeWidth:c?24*Number(r)/Number(n):r,className:i("lucide",o),...u},[...m.map(e=>{let[a,t]=e;return(0,s.createElement)(a,t)}),...Array.isArray(d)?d:[d]])}),c=(e,a)=>{let t=(0,s.forwardRef)((t,l)=>{let{className:c,...o}=t;return(0,s.createElement)(r,{ref:l,iconNode:a,className:i("lucide-".concat(n(e)),c),...o})});return t.displayName="".concat(e),t}},70699:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(57977).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},29910:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(57977).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},77326:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(57977).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},25700:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return k}});var s=t(3827),n=t(64090),i=t(45623),l=t(10732),r=t(67945),c=t(73031),o=t(51055),d=t(47385),m=t(56178),u=t(14078),x=t(49430),h=t(26856),f=t(70699),g=t(29910),j=t(57977);let p=(0,j.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),v=(0,j.Z)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),N=(0,j.Z)("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);var y=t(77326),b=t(94642),z=t(20568),w=t(56288),C=t(30248);let S=C.z.object({siteName:C.z.string().min(1,"站点名称不能为空").max(50,"站点名称不能超过50个字符"),siteDescription:C.z.string().max(200,"站点描述不能超过200个字符"),adminEmail:C.z.string().email("请输入有效的邮箱地址"),language:C.z.string(),timezone:C.z.string(),enableRegistration:C.z.boolean(),enableEmailNotification:C.z.boolean(),enableSMSNotification:C.z.boolean(),maxLoginAttempts:C.z.number().min(1,"最小值为1").max(10,"最大值为10"),sessionTimeout:C.z.number().min(5,"最小值为5分钟").max(1440,"最大值为24小时"),maintenanceMode:C.z.boolean()});function k(){let[e,a]=n.useState({siteName:"喵呜记账",siteDescription:"简单易用的个人和家庭记账系统",adminEmail:"admin@example.com",language:"zh-CN",timezone:"Asia/Shanghai",enableRegistration:!0,enableEmailNotification:!0,enableSMSNotification:!1,maxLoginAttempts:5,sessionTimeout:30,maintenanceMode:!1}),[t,j]=n.useState({}),{isLoading:k}=(0,b.a)({queryKey:["systemSettings"],queryFn:async()=>{try{let e=await fetch("/api/settings/system",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!e.ok)throw Error("获取系统设置失败");return await e.json()}catch(e){throw w.Am.error("获取系统设置失败"),e}}}),{mutate:E,isPending:M}=(0,z.D)({mutationFn:async e=>{let a=await fetch("/api/settings/system",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!a.ok)throw Error((await a.json()).error||"保存系统设置失败");return await a.json()},onSuccess:()=>{w.Am.success("设置保存成功")},onError:e=>{w.Am.error("设置保存失败: ".concat(e.message))}}),A=async()=>{try{let a=S.parse(e);j({}),E(a)}catch(e){if(e instanceof C.z.ZodError){let a={};e.errors.forEach(e=>{e.path[0]&&(a[e.path[0]]=e.message)}),j(a),w.Am.error("请检查输入内容")}}},Z=(e,s)=>{a(a=>({...a,[e]:s})),t[e]&&j(a=>({...a,[e]:void 0}))};return k?(0,s.jsx)("div",{className:"flex justify-center items-center h-[50vh]",children:(0,s.jsx)(i.c,{size:"lg",label:"加载中..."})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"系统设置"}),(0,s.jsx)(l.A,{color:"primary",variant:"shadow",onPress:A,isLoading:M,startContent:(0,s.jsx)(f.Z,{size:16}),children:"保存更改"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)(r.w,{className:"p-4",children:[(0,s.jsxs)(c.u,{className:"flex gap-3",children:[(0,s.jsx)(g.Z,{size:24,className:"text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold",children:"基本设置"}),(0,s.jsx)("p",{className:"text-sm text-default-500",children:"配置系统的基本信息"})]})]}),(0,s.jsxs)(o.G,{className:"space-y-4",children:[(0,s.jsx)(d.Y,{label:"站点名称",value:e.siteName,onChange:e=>Z("siteName",e.target.value),errorMessage:t.siteName,isInvalid:!!t.siteName}),(0,s.jsx)(d.Y,{label:"站点描述",value:e.siteDescription,onChange:e=>Z("siteDescription",e.target.value),errorMessage:t.siteDescription,isInvalid:!!t.siteDescription}),(0,s.jsx)(d.Y,{label:"管理员邮箱",value:e.adminEmail,onChange:e=>Z("adminEmail",e.target.value),errorMessage:t.adminEmail,isInvalid:!!t.adminEmail,startContent:(0,s.jsx)(p,{size:16})})]})]}),(0,s.jsxs)(r.w,{className:"p-4",children:[(0,s.jsxs)(c.u,{className:"flex gap-3",children:[(0,s.jsx)(v,{size:24,className:"text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold",children:"本地化设置"}),(0,s.jsx)("p",{className:"text-sm text-default-500",children:"配置系统的语言和时区"})]})]}),(0,s.jsxs)(o.G,{className:"space-y-4",children:[(0,s.jsx)(m.g,{label:"系统语言",selectedKeys:[e.language],onChange:e=>Z("language",e.target.value),errorMessage:t.language,isInvalid:!!t.language,children:[{label:"简体中文",value:"zh-CN"},{label:"繁體中文",value:"zh-TW"},{label:"English",value:"en-US"}].map(e=>(0,s.jsx)(u.R,{value:e.value,children:e.label},e.value))}),(0,s.jsx)(m.g,{label:"系统时区",selectedKeys:[e.timezone],onChange:e=>Z("timezone",e.target.value),errorMessage:t.timezone,isInvalid:!!t.timezone,children:[{label:"北京时间 (UTC+8)",value:"Asia/Shanghai"},{label:"东京时间 (UTC+9)",value:"Asia/Tokyo"},{label:"纽约时间 (UTC-5)",value:"America/New_York"}].map(e=>(0,s.jsx)(u.R,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)(r.w,{className:"p-4",children:[(0,s.jsxs)(c.u,{className:"flex gap-3",children:[(0,s.jsx)(N,{size:24,className:"text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold",children:"通知设置"}),(0,s.jsx)("p",{className:"text-sm text-default-500",children:"配置系统的通知方式"})]})]}),(0,s.jsxs)(o.G,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"邮件通知"}),(0,s.jsx)("p",{className:"text-xs text-default-500",children:"启用系统邮件通知功能"})]}),(0,s.jsx)(x.i,{isSelected:e.enableEmailNotification,onValueChange:e=>Z("enableEmailNotification",e)})]}),(0,s.jsx)(h.j,{}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"短信通知"}),(0,s.jsx)("p",{className:"text-xs text-default-500",children:"启用系统短信通知功能"})]}),(0,s.jsx)(x.i,{isSelected:e.enableSMSNotification,onValueChange:e=>Z("enableSMSNotification",e)})]})]})]}),(0,s.jsxs)(r.w,{className:"p-4",children:[(0,s.jsxs)(c.u,{className:"flex gap-3",children:[(0,s.jsx)(y.Z,{size:24,className:"text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold",children:"安全设置"}),(0,s.jsx)("p",{className:"text-sm text-default-500",children:"配置系统的安全相关选项"})]})]}),(0,s.jsxs)(o.G,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"开放注册"}),(0,s.jsx)("p",{className:"text-xs text-default-500",children:"允许新用户注册账号"})]}),(0,s.jsx)(x.i,{isSelected:e.enableRegistration,onValueChange:e=>Z("enableRegistration",e)})]}),(0,s.jsx)(h.j,{}),(0,s.jsx)(d.Y,{type:"number",label:"最大登录尝试次数",value:e.maxLoginAttempts.toString(),onChange:e=>Z("maxLoginAttempts",parseInt(e.target.value)),errorMessage:t.maxLoginAttempts,isInvalid:!!t.maxLoginAttempts,description:"超过此次数将暂时锁定账号"}),(0,s.jsx)(d.Y,{type:"number",label:"会话超时时间（分钟）",value:e.sessionTimeout.toString(),onChange:e=>Z("sessionTimeout",parseInt(e.target.value)),errorMessage:t.sessionTimeout,isInvalid:!!t.sessionTimeout,description:"用户无操作后自动退出登录的时间"})]})]}),(0,s.jsxs)(r.w,{className:"p-4",children:[(0,s.jsxs)(c.u,{className:"flex gap-3",children:[(0,s.jsx)(g.Z,{size:24,className:"text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold",children:"维护模式"}),(0,s.jsx)("p",{className:"text-sm text-default-500",children:"系统维护相关设置"})]})]}),(0,s.jsx)(o.G,{className:"space-y-4",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"维护模式"}),(0,s.jsx)("p",{className:"text-xs text-default-500",children:"启用后仅管理员可访问系统"})]}),(0,s.jsx)(x.i,{isSelected:e.maintenanceMode,onValueChange:e=>Z("maintenanceMode",e),color:"danger"})]})})]})]})]})}},73031:function(e,a,t){"use strict";t.d(a,{u:function(){return o}});var s=t(32281),n=t(84449),i=t(72874),l=t(5142),r=t(3827),c=(0,n.Gp)((e,a)=>{var t;let{as:n,className:c,children:o,...d}=e,m=(0,i.gy)(a),{slots:u,classNames:x}=(0,s.R)(),h=(0,l.W)(null==x?void 0:x.header,c);return(0,r.jsx)(n||"div",{ref:m,className:null==(t=u.header)?void 0:t.call(u,{class:h}),...d,children:o})});c.displayName="NextUI.CardHeader";var o=c},7878:function(e,a,t){"use strict";t.d(a,{l:function(){return n}});var s=t(34808);function n(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return e=>{a.forEach(a=>(function(e,a){if(null!=e){if((0,s.mf)(e)){e(a);return}try{e.current=a}catch(t){throw Error("Cannot assign value '".concat(a,"' to ref '").concat(e,"'"))}}})(a,e))}}},83025:function(e,a,t){"use strict";t.d(a,{l:function(){return n}});var s=t(81754);function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{isReadOnly:a}=e,[t,n]=(0,s.z)(e.isSelected,e.defaultSelected||!1,e.onChange);return{isSelected:t,setSelected:function(e){a||n(e)},toggle:function(){a||n(!t)}}}},20826:function(e,a,t){"use strict";function s(e,a){return"function"==typeof e?e(...a):!!e}function n(){}t.d(a,{L:function(){return s},Z:function(){return n}})}},function(e){e.O(0,[6034,9390,9689,7945,7530,5784,7385,6288,224,4187,1945,8704,4322,568,5961,4642,9430,248,2971,8069,1744],function(){return e(e.s=29227)}),_N_E=e.O()}]);