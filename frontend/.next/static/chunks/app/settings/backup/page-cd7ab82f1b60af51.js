(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8173],{29483:function(e,a,s){Promise.resolve().then(s.bind(s,91953))},57977:function(e,a,s){"use strict";s.d(a,{Z:function(){return i}});var t=s(64090);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];return a.filter((e,a,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===a).join(" ").trim()};/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t.forwardRef)((e,a)=>{let{color:s="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:u,...h}=e;return(0,t.createElement)("svg",{ref:a,...o,width:r,height:r,stroke:s,strokeWidth:i?24*Number(l)/Number(r):l,className:n("lucide",c),...h},[...u.map(e=>{let[a,s]=e;return(0,t.createElement)(a,s)}),...Array.isArray(d)?d:[d]])}),i=(e,a)=>{let s=(0,t.forwardRef)((s,o)=>{let{className:i,...c}=s;return(0,t.createElement)(l,{ref:o,iconNode:a,className:n("lucide-".concat(r(e)),i),...c})});return s.displayName="".concat(e),s}},93276:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(57977).Z)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},44715:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(57977).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},50489:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(57977).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},91953:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return O}});var t=s(3827),r=s(64090),n=s(2210),o=s(10732),l=s(67945),i=s(73031),c=s(51055),d=s(50535),u=s(75129),h=s(63053),m=s(77058),p=s(45623),f=s(36685),b=s(92339),x=s(49977),v=s(4248),g=s(99510),y=s(22561),w=s(7725),j=s(47385),C=s(2646),k=s(94642),J=s(93276);let N=(0,s(57977).Z)("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);var E=s(44715),z=s(50489),A=s(56288);let M=Array.from({length:10},(e,a)=>({id:a+1,name:"backup_".concat(new Date(Date.now()-864e5*a).toISOString().split("T")[0],".zip"),size:Math.floor(1e3*Math.random())+"MB",createdAt:new Date(Date.now()-864e5*a).toISOString(),type:["完整备份","增量备份"][Math.floor(2*Math.random())],status:"完成"}));function O(){let{isOpen:e,onOpen:a,onClose:s}=(0,n.q)(),[O,S]=r.useState(""),[P,D]=r.useState(!1),{data:Z,refetch:B}=(0,k.a)({queryKey:["backups"],queryFn:async()=>{try{let e=await fetch("/api/settings/backups",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!e.ok)throw Error("获取备份列表失败");return await e.json()}catch(e){return console.warn("备份API未实现，使用模拟数据:",e),await new Promise(e=>setTimeout(e,1e3)),M}}}),T=async()=>{D(!0);try{let e=await fetch("/api/settings/backups",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:O||"backup_".concat(new Date().toISOString().split("T")[0])})});if(!e.ok){let a=await e.json();throw Error(a.error||"创建备份失败")}A.Am.success("备份创建成功"),s(),B()}catch(e){console.error("备份创建失败:",e),A.Am.error("备份创建失败: ".concat(e instanceof Error?e.message:"未知错误"))}finally{D(!1)}},V=async e=>{try{let a=await fetch("/api/settings/backups/".concat(e,"/restore"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"});if(!a.ok){let e=await a.json();throw Error(e.error||"恢复备份失败")}A.Am.success("备份恢复成功")}catch(e){console.error("备份恢复失败:",e),A.Am.error("备份恢复失败: ".concat(e instanceof Error?e.message:"未知错误"))}},I=async e=>{try{let a=await fetch("/api/settings/backups/".concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"});if(!a.ok){let e=await a.json();throw Error(e.error||"删除备份失败")}A.Am.success("备份删除成功"),B()}catch(e){console.error("备份删除失败:",e),A.Am.error("备份删除失败: ".concat(e instanceof Error?e.message:"未知错误"))}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:"备份与恢复"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.A,{color:"primary",variant:"shadow",startContent:(0,t.jsx)(J.Z,{size:16}),onPress:a,children:"创建备份"}),(0,t.jsx)(o.A,{variant:"flat",startContent:(0,t.jsx)(N,{size:16}),onPress:()=>B(),children:"刷新"})]})]}),(0,t.jsxs)(l.w,{children:[(0,t.jsxs)(i.u,{className:"flex gap-3 px-6 py-4",children:[(0,t.jsx)(J.Z,{size:24,className:"text-primary"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold",children:"备份管理"}),(0,t.jsx)("p",{className:"text-sm text-default-500",children:"管理系统数据的备份和恢复"})]})]}),(0,t.jsx)(c.G,{children:(0,t.jsxs)(d.b,{"aria-label":"备份列表",children:[(0,t.jsxs)(u.J,{children:[(0,t.jsx)(h.j,{children:"备份名称"}),(0,t.jsx)(h.j,{children:"类型"}),(0,t.jsx)(h.j,{children:"大小"}),(0,t.jsx)(h.j,{children:"创建时间"}),(0,t.jsx)(h.j,{children:"状态"}),(0,t.jsx)(h.j,{children:"操作"})]}),(0,t.jsx)(m.y,{items:Z||[],emptyContent:P?(0,t.jsx)(p.c,{label:"加载中..."}):"暂无备份数据",children:e=>(0,t.jsxs)(f.g,{children:[(0,t.jsx)(b.X,{children:e.name}),(0,t.jsx)(b.X,{children:(0,t.jsx)(x.z,{color:"完整备份"===e.type?"primary":"secondary",variant:"flat",size:"sm",children:e.type})}),(0,t.jsx)(b.X,{children:e.size}),(0,t.jsx)(b.X,{children:new Date(e.createdAt).toLocaleString()}),(0,t.jsx)(b.X,{children:(0,t.jsx)(x.z,{color:"success",variant:"flat",size:"sm",children:e.status})}),(0,t.jsx)(b.X,{children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.A,{size:"sm",variant:"flat",color:"primary",startContent:(0,t.jsx)(E.Z,{size:14}),onPress:()=>V(e.id),children:"恢复"}),(0,t.jsx)(o.A,{size:"sm",variant:"flat",color:"danger",startContent:(0,t.jsx)(z.Z,{size:14}),onPress:()=>I(e.id),children:"删除"})]})})]},e.id)})]})})]}),(0,t.jsx)(v.R,{isOpen:e,onClose:s,children:(0,t.jsx)(g.A,{children:e=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.k,{className:"flex flex-col gap-1",children:"创建新备份"}),(0,t.jsx)(w.I,{children:(0,t.jsx)(j.Y,{label:"备份名称",placeholder:"输入备份名称",value:O,onChange:e=>S(e.target.value)})}),(0,t.jsxs)(C.R,{children:[(0,t.jsx)(o.A,{variant:"flat",onPress:e,children:"取消"}),(0,t.jsx)(o.A,{color:"primary",onPress:T,isLoading:P,children:"创建"})]})]})})})]})}},73031:function(e,a,s){"use strict";s.d(a,{u:function(){return c}});var t=s(32281),r=s(84449),n=s(72874),o=s(5142),l=s(3827),i=(0,r.Gp)((e,a)=>{var s;let{as:r,className:i,children:c,...d}=e,u=(0,n.gy)(a),{slots:h,classNames:m}=(0,t.R)(),p=(0,o.W)(null==m?void 0:m.header,i);return(0,l.jsx)(r||"div",{ref:u,className:null==(s=h.header)?void 0:s.call(h,{class:p}),...d,children:c})});i.displayName="NextUI.CardHeader";var c=i},49977:function(e,a,s){"use strict";s.d(a,{z:function(){return v}});var t=s(84449),r=s(19181),n=s(47260),o=s(25615),l=s(46385),i=s(67459),c=s(61149),d=(0,i.tv)({slots:{base:["relative","max-w-fit","min-w-min","inline-flex","items-center","justify-between","box-border","whitespace-nowrap"],content:"flex-1 text-inherit font-normal",dot:["w-2","h-2","ml-1","rounded-full"],avatar:"flex-shrink-0",closeButton:["z-10","appearance-none","outline-none","select-none","transition-opacity","opacity-70","hover:opacity-100","cursor-pointer","active:opacity-disabled","tap-highlight-transparent"]},variants:{variant:{solid:{},bordered:{base:"border-medium bg-transparent"},light:{base:"bg-transparent"},flat:{},faded:{base:"border-medium"},shadow:{},dot:{base:"border-medium border-default text-foreground bg-transparent"}},color:{default:{dot:"bg-default-400"},primary:{dot:"bg-primary"},secondary:{dot:"bg-secondary"},success:{dot:"bg-success"},warning:{dot:"bg-warning"},danger:{dot:"bg-danger"}},size:{sm:{base:"px-1 h-6 text-tiny",content:"px-1",closeButton:"text-medium",avatar:"w-4 h-4"},md:{base:"px-1 h-7 text-small",content:"px-2",closeButton:"text-large",avatar:"w-5 h-5"},lg:{base:"px-2 h-8 text-medium",content:"px-2",closeButton:"text-xl",avatar:"w-6 h-6"}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"},full:{base:"rounded-full"}},isOneChar:{true:{},false:{}},isCloseable:{true:{},false:{}},hasStartContent:{true:{}},hasEndContent:{true:{}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},isCloseButtonFocusVisible:{true:{closeButton:[...c.jR,"ring-1","rounded-full"]}}},defaultVariants:{variant:"solid",color:"default",size:"md",radius:"full",isDisabled:!1},compoundVariants:[{variant:"solid",color:"default",class:{base:l.J.solid.default}},{variant:"solid",color:"primary",class:{base:l.J.solid.primary}},{variant:"solid",color:"secondary",class:{base:l.J.solid.secondary}},{variant:"solid",color:"success",class:{base:l.J.solid.success}},{variant:"solid",color:"warning",class:{base:l.J.solid.warning}},{variant:"solid",color:"danger",class:{base:l.J.solid.danger}},{variant:"shadow",color:"default",class:{base:l.J.shadow.default}},{variant:"shadow",color:"primary",class:{base:l.J.shadow.primary}},{variant:"shadow",color:"secondary",class:{base:l.J.shadow.secondary}},{variant:"shadow",color:"success",class:{base:l.J.shadow.success}},{variant:"shadow",color:"warning",class:{base:l.J.shadow.warning}},{variant:"shadow",color:"danger",class:{base:l.J.shadow.danger}},{variant:"bordered",color:"default",class:{base:l.J.bordered.default}},{variant:"bordered",color:"primary",class:{base:l.J.bordered.primary}},{variant:"bordered",color:"secondary",class:{base:l.J.bordered.secondary}},{variant:"bordered",color:"success",class:{base:l.J.bordered.success}},{variant:"bordered",color:"warning",class:{base:l.J.bordered.warning}},{variant:"bordered",color:"danger",class:{base:l.J.bordered.danger}},{variant:"flat",color:"default",class:{base:l.J.flat.default}},{variant:"flat",color:"primary",class:{base:l.J.flat.primary}},{variant:"flat",color:"secondary",class:{base:l.J.flat.secondary}},{variant:"flat",color:"success",class:{base:l.J.flat.success}},{variant:"flat",color:"warning",class:{base:l.J.flat.warning}},{variant:"flat",color:"danger",class:{base:l.J.flat.danger}},{variant:"faded",color:"default",class:{base:l.J.faded.default}},{variant:"faded",color:"primary",class:{base:l.J.faded.primary}},{variant:"faded",color:"secondary",class:{base:l.J.faded.secondary}},{variant:"faded",color:"success",class:{base:l.J.faded.success}},{variant:"faded",color:"warning",class:{base:l.J.faded.warning}},{variant:"faded",color:"danger",class:{base:l.J.faded.danger}},{variant:"light",color:"default",class:{base:l.J.light.default}},{variant:"light",color:"primary",class:{base:l.J.light.primary}},{variant:"light",color:"secondary",class:{base:l.J.light.secondary}},{variant:"light",color:"success",class:{base:l.J.light.success}},{variant:"light",color:"warning",class:{base:l.J.light.warning}},{variant:"light",color:"danger",class:{base:l.J.light.danger}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"sm",class:{base:"w-5 h-5 min-w-5 min-h-5"}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"md",class:{base:"w-6 h-6 min-w-6 min-h-6"}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"lg",class:{base:"w-7 h-7 min-w-7 min-h-7"}},{isOneChar:!0,isCloseable:!1,hasStartContent:!1,hasEndContent:!1,class:{base:"px-0 justify-center",content:"px-0 flex-none"}},{isOneChar:!0,isCloseable:!0,hasStartContent:!1,hasEndContent:!1,class:{base:"w-auto"}},{isOneChar:!0,variant:"dot",class:{base:"w-auto h-7 px-1 items-center",content:"px-2"}},{hasStartContent:!0,size:"sm",class:{content:"pl-0.5"}},{hasStartContent:!0,size:["md","lg"],class:{content:"pl-1"}},{hasEndContent:!0,size:"sm",class:{content:"pr-0.5"}},{hasEndContent:!0,size:["md","lg"],class:{content:"pr-1"}}]}),u=s(72874),h=s(5142),m=s(96080),p=s(64090),f=s(32838),b=s(3827),x=(0,t.Gp)((e,a)=>{let{Component:s,children:l,slots:i,classNames:c,isDot:x,isCloseable:v,startContent:g,endContent:y,getCloseButtonProps:w,getChipProps:j}=function(e){let[a,s]=(0,t.oe)(e,d.variantKeys),{ref:l,as:i,children:c,avatar:f,startContent:b,endContent:x,onClose:v,classNames:g,className:y,...w}=a,j=(0,u.gy)(l),C=(0,h.W)(null==g?void 0:g.base,y),k=!!v,J="dot"===e.variant,{focusProps:N,isFocusVisible:E}=(0,o.F)(),z=(0,p.useMemo)(()=>"string"==typeof c&&(null==c?void 0:c.length)===1,[c]),A=(0,p.useMemo)(()=>!!f||!!b,[f,b]),M=(0,p.useMemo)(()=>!!x||k,[x,k]),O=(0,p.useMemo)(()=>d({...s,hasStartContent:A,hasEndContent:M,isOneChar:z,isCloseable:k,isCloseButtonFocusVisible:E}),[(0,m.Xx)(s),E,A,M,z,k]),{pressProps:S}=(0,n.r)({isDisabled:!!(null==e?void 0:e.isDisabled),onPress:v}),P=e=>(0,p.isValidElement)(e)?(0,p.cloneElement)(e,{className:(0,h.W)("max-h-[80%]",e.props.className)}):null;return{Component:i||"div",children:c,slots:O,classNames:g,isDot:J,isCloseable:k,startContent:((0,p.isValidElement)(f)?(0,p.cloneElement)(f,{className:O.avatar({class:null==g?void 0:g.avatar})}):null)||P(b),endContent:P(x),getCloseButtonProps:()=>({role:"button",tabIndex:0,className:O.closeButton({class:null==g?void 0:g.closeButton}),"aria-label":"close chip",...(0,r.d)(S,N)}),getChipProps:()=>({ref:j,className:O.base({class:C}),...w})}}({...e,ref:a}),C=(0,p.useMemo)(()=>x&&!g?(0,b.jsx)("span",{className:i.dot({class:null==c?void 0:c.dot})}):g,[i,g,x]),k=(0,p.useMemo)(()=>v?(0,b.jsx)("span",{...w(),children:y||(0,b.jsx)(f.f,{})}):y,[y,v,w]);return(0,b.jsxs)(s,{...j(),children:[C,(0,b.jsx)("span",{className:i.content({class:null==c?void 0:c.content}),children:l}),k]})});x.displayName="NextUI.Chip";var v=x},2210:function(e,a,s){"use strict";s.d(a,{q:function(){return l}});var t=s(68168),r=s(81754),n=s(44251),o=s(64090);function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{id:a,defaultOpen:s,isOpen:l,onClose:i,onOpen:c,onChange:d=()=>{}}=e,u=(0,n.W)(c),h=(0,n.W)(i),[m,p]=(0,r.z)(l,s||!1,d),f=(0,o.useId)(),b=a||f,x=void 0!==l,v=(0,o.useCallback)(()=>{x||p(!1),null==h||h()},[x,h]),g=(0,o.useCallback)(()=>{x||p(!0),null==u||u()},[x,u]),y=(0,o.useCallback)(()=>{(m?v:g)()},[m,g,v]);return{isOpen:!!m,onOpen:g,onClose:v,onOpenChange:y,isControlled:x,getButtonProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e,"aria-expanded":m,"aria-controls":b,onClick:(0,t.t)(e.onClick,y)}},getDisclosureProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e,hidden:!m,id:b}}}}}},function(e){e.O(0,[6034,9390,9689,7945,7530,5784,7385,6288,4187,224,8704,414,4642,4788,6373,2971,8069,1744],function(){return e(e.s=29483)}),_N_E=e.O()}]);