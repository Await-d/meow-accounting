(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2316],{97986:function(e,s,t){Promise.resolve().then(t.bind(t,70374))},70374:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ei}});var a=t(3827),l=t(64090),i=t(2210),n=t(49977),r=t(10732),c=t(67945),d=t(73031),o=t(51055),h=t(88925),x=t(83176),m=t(26587),u=t(81433),j=t(38333),f=t(23356),p=t(22983),g=t(10166),v=t(78720),y=t(29733),w=t(81708),N=t(69475),b=t(36107),z=t(6297),C=t(56288),D=t(58222),S=t(52131),R=t(94642),O=t(77599),Z=t(26490);function P(e){var s;let{prediction:t,isLoading:l=!1}=e;return l?(0,a.jsx)(c.w,{className:"h-40",children:(0,a.jsx)(o.G,{className:"flex items-center justify-center",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-default-200 rounded w-3/4 mb-2"}),(0,a.jsx)("div",{className:"h-4 bg-default-200 rounded w-1/2"})]})})}):t&&t.path?(0,a.jsxs)(c.w,{children:[(0,a.jsxs)(o.G,{className:"gap-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("h3",{className:"text-md font-semibold",children:t.name||"未命名路由"}),(0,a.jsxs)(n.z,{color:(s=t.confidence)>=80?"success":s>=50?"warning":"danger",size:"sm",startContent:(0,a.jsx)(y.Z,{size:12}),children:[t.confidence,"% 可能性"]})]}),(0,a.jsx)("p",{className:"text-default-500 text-xs",children:t.path}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-xs text-default-400",children:[(0,a.jsx)(Z.Z,{size:12}),(0,a.jsxs)("span",{children:["最近访问: ",new Date(t.lastAccess).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"text-xs text-default-400",children:["访问次数: ",t.accessCount]})]}),(0,a.jsx)(O.i,{children:(0,a.jsx)(r.A,{size:"sm",variant:"flat",color:"primary",startContent:(0,a.jsx)(w.Z,{size:14}),as:"a",href:t.path,fullWidth:!0,children:"访问路由"})})]}):(0,a.jsx)(c.w,{className:"h-40",children:(0,a.jsx)(o.G,{className:"flex items-center justify-center",children:(0,a.jsx)("p",{className:"text-default-500 text-center",children:"暂无预测数据"})})})}var T=t(14298),k=t(4248),A=t(99510),I=t(22561),K=t(7725),M=t(45623),E=t(23455),q=t(38721),L=t(2646),V=t(97404),F=t(69724),H=t(93276);function _(e){let{isOpen:s,onClose:t,routeId:l,fetchSuggestions:i}=e,{data:n,isLoading:c}=(0,R.a)({queryKey:["routeOptimization",l],queryFn:()=>i(l),enabled:s&&l>0}),d=e=>{switch(e){case"performance":return(0,a.jsx)(V.Z,{className:"text-warning",size:18});case"error":return(0,a.jsx)(F.Z,{className:"text-danger",size:18});case"caching":return(0,a.jsx)(H.Z,{className:"text-success",size:18});default:return(0,a.jsx)(Z.Z,{className:"text-primary",size:18})}},o=e=>{switch(e){case"high":return"danger";case"medium":return"warning";case"low":return"success";default:return"default"}};return(0,a.jsx)(k.R,{isOpen:s,onClose:t,size:"3xl",children:(0,a.jsx)(A.A,{children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(I.k,{className:"flex flex-col gap-1",children:[(0,a.jsx)("h3",{className:"text-lg",children:"路由优化建议"}),(0,a.jsx)("p",{className:"text-sm text-default-500",children:"基于性能数据为您推荐的优化方案"})]}),(0,a.jsx)(K.I,{children:c?(0,a.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,a.jsx)(M.c,{label:"加载优化建议中..."})}):n&&0!==n.length?(0,a.jsx)(E.d,{variant:"bordered",children:n.map(e=>(0,a.jsx)(q.G,{title:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[d(e.category),(0,a.jsx)("span",{children:e.title})]}),subtitle:(0,a.jsx)("span",{className:"text-".concat(o(e.priority)," text-xs"),children:"high"===e.priority?"高优先级":"medium"===e.priority?"中优先级":"低优先级"}),children:(0,a.jsxs)("div",{className:"space-y-2 px-2",children:[(0,a.jsx)("p",{children:e.description}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("strong",{children:"预期影响："})," ",e.impact]})]})},e.id))}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{children:"暂无优化建议"}),(0,a.jsx)("p",{className:"text-sm text-default-500",children:"该路由性能状况良好"})]})}),(0,a.jsx)(L.R,{children:(0,a.jsx)(r.A,{color:"primary",variant:"light",onPress:e,children:"关闭"})})]})})})}var G=t(25908),X=t(70294),J=t(26856),W=t(945),Y=t(16015),B=t(20372),U=t(2391),$=t(36747),Q=t(47385),ee=t(97307);function es(e){let{value:s,onChange:t}=e,{startDate:l,endDate:i}=s,n=e=>{let s=new Date,a=new Date;a.setDate(s.getDate()-e),t({startDate:a,endDate:s})},c=e=>e.toISOString().split("T")[0];return(0,a.jsxs)(B.j,{placement:"bottom",children:[(0,a.jsx)(U.b,{children:(0,a.jsxs)(r.A,{variant:"flat",startContent:(0,a.jsx)(ee.Z,{size:16}),children:[c(l)," 至 ",c(i)]})}),(0,a.jsx)($.g,{children:(0,a.jsxs)("div",{className:"p-4 w-80",children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-4",children:"选择日期范围"}),(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(Q.Y,{type:"date",label:"开始日期",value:c(l),onChange:e=>{let s=new Date(e.target.value);isNaN(s.getTime())||t({startDate:s,endDate:i})},max:c(i)}),(0,a.jsx)(Q.Y,{type:"date",label:"结束日期",value:c(i),onChange:e=>{let s=new Date(e.target.value);isNaN(s.getTime())||t({startDate:l,endDate:s})},min:c(l),max:c(new Date)})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[{label:"今天",days:0},{label:"过去7天",days:7},{label:"过去30天",days:30},{label:"过去90天",days:90}].map(e=>(0,a.jsx)(r.A,{size:"sm",variant:"flat",onPress:()=>n(e.days),children:e.label},e.label))})]})]})})]})}function et(e){let{isOpen:s,onClose:t,onExport:i,dateRange:n,setDateRange:c}=e,[d,o]=l.useState("pdf"),[h,x]=l.useState(!1),[m,u]=l.useState("full"),j=async()=>{x(!0);try{await i(d),t()}catch(e){console.error("导出失败:",e)}finally{x(!1)}},f=[{value:"pdf",label:"PDF文档",icon:(0,a.jsx)(N.Z,{size:16}),description:"生成PDF格式的报告文档"},{value:"excel",label:"Excel表格",icon:(0,a.jsx)(W.Z,{size:16}),description:"生成Excel格式的数据表格"},{value:"csv",label:"CSV数据",icon:(0,a.jsx)(Y.Z,{size:16}),description:"生成CSV格式的原始数据"}];return(0,a.jsx)(k.R,{isOpen:s,onClose:t,size:"lg",children:(0,a.jsx)(A.A,{children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(I.k,{className:"flex flex-col gap-1",children:[(0,a.jsx)("h3",{className:"text-lg",children:"导出分析报告"}),(0,a.jsx)("p",{className:"text-sm text-default-500",children:"导出路由性能和访问数据分析报告"})]}),(0,a.jsxs)(K.I,{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2",children:"报告类型"}),(0,a.jsxs)(G.X,{value:m,onValueChange:u,children:[(0,a.jsx)(X.J,{value:"full",children:"完整报告（包含所有数据和图表）"}),(0,a.jsx)(X.J,{value:"performance",children:"性能报告（仅包含加载时间和错误率）"}),(0,a.jsx)(X.J,{value:"usage",children:"使用报告（仅包含访问频率和分布）"})]})]}),(0,a.jsx)(J.j,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2",children:"日期范围"}),(0,a.jsx)(es,{value:n,onChange:c})]}),(0,a.jsx)(J.j,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2",children:"导出格式"}),(0,a.jsx)(G.X,{orientation:"horizontal",value:d,onValueChange:o,children:f.map(e=>(0,a.jsx)(X.J,{value:e.value,description:e.description,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e.icon,e.label]})},e.value))})]})]}),(0,a.jsxs)(L.R,{children:[(0,a.jsx)(r.A,{variant:"flat",onPress:e,children:"取消"}),(0,a.jsx)(r.A,{color:"primary",onPress:j,isLoading:h,startContent:(0,a.jsx)(N.Z,{size:16}),children:"导出"})]})]})})})}var ea=t(62665);let el=[{name:"/dashboard",loadTime:320,errorRate:.5,cacheHitRate:89},{name:"/transactions",loadTime:450,errorRate:1.2,cacheHitRate:76},{name:"/statistics",loadTime:580,errorRate:.8,cacheHitRate:62},{name:"/settings",loadTime:280,errorRate:.2,cacheHitRate:94},{name:"/profile",loadTime:390,errorRate:.7,cacheHitRate:82}];function ei(){let{user:e}=(0,S.useAuth)(),s=null==e?void 0:e.id,[t,O]=l.useState({startDate:new Date(Date.now()-2592e6),endDate:new Date}),{isOpen:Z,onOpen:k,onClose:A}=(0,i.q)(),{isOpen:I,onOpen:K,onClose:M}=(0,i.q)(),[E,q]=l.useState(null),{data:L,isLoading:V}=(0,R.a)({queryKey:["routePredictions",s],queryFn:()=>(0,D.Ds)(s||0),enabled:!!s}),{data:F,isLoading:H}=(0,R.a)({queryKey:["routeVisualization",t],queryFn:()=>(0,D.le)({type:"performance",startDate:t.startDate.toISOString(),endDate:t.endDate.toISOString()}),enabled:!!s}),G=[{header:"路由路径",accessorKey:"name",cell:e=>(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("span",{className:"text-sm",children:e.getValue()})})},{header:"加载时间 (ms)",accessorKey:"loadTime",cell:e=>{let s=e.getValue(),t="success";return s>500?t="danger":s>300&&(t="warning"),(0,a.jsxs)(n.z,{color:t,variant:"flat",size:"sm",children:[s," ms"]})}},{header:"错误率 (%)",accessorKey:"errorRate",cell:e=>{let s=e.getValue(),t="success";return s>1?t="danger":s>.5&&(t="warning"),(0,a.jsxs)(n.z,{color:t,variant:"flat",size:"sm",children:[s,"%"]})}},{header:"缓存命中率 (%)",accessorKey:"cacheHitRate",cell:e=>{let s=e.getValue(),t="success";return s<60?t="danger":s<80&&(t="warning"),(0,a.jsxs)(n.z,{color:t,variant:"flat",size:"sm",children:[s,"%"]})}},{header:"操作",cell:e=>{let s=e.row.original.id||1;return(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.A,{size:"sm",variant:"flat",color:"primary",startContent:(0,a.jsx)(y.Z,{size:14}),onPress:()=>{q(s),k()},children:"优化建议"}),(0,a.jsx)(r.A,{size:"sm",variant:"flat",startContent:(0,a.jsx)(w.Z,{size:14}),as:"a",href:"/settings/routes?highlight=".concat(s),target:"_blank",children:"管理"})]})}}],X=async e=>{try{let s=await (0,D.KX)({format:e,startDate:t.startDate.toISOString(),endDate:t.endDate.toISOString()}),a=URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download="route-report-".concat(new Date().toISOString().split("T")[0],".").concat(e),document.body.appendChild(l),l.click(),document.body.removeChild(l),C.Am.success("成功导出".concat(e.toUpperCase(),"报告"))}catch(e){C.Am.error("导出失败: ".concat(e instanceof Error?e.message:"未知错误"))}},J=(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsx)(es,{value:t,onChange:O}),(0,a.jsx)(r.A,{color:"primary",variant:"shadow",startContent:(0,a.jsx)(N.Z,{size:16}),onPress:K,children:"导出报告"})]});return(0,a.jsxs)(ea.Z,{title:"路由管理",description:"分析路由访问表现，生成预测与优化建议。",actions:J,backgroundVariant:"minimal",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(c.w,{children:[(0,a.jsxs)(d.u,{className:"flex gap-3 px-6 py-4",children:[(0,a.jsx)(b.Z,{size:24,className:"text-primary"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"路由预测"}),(0,a.jsx)("p",{className:"text-sm text-default-500",children:"基于用户行为的路由访问预测"})]})]}),(0,a.jsx)(o.G,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:V?(0,a.jsx)("div",{className:"col-span-3 text-center py-4",children:"加载中..."}):((null==L?void 0:L.topRoutes)||[,,,].fill({})).map((e,s)=>(0,a.jsx)(P,{prediction:e,isLoading:V},s))})})]}),(0,a.jsxs)(c.w,{children:[(0,a.jsxs)(d.u,{className:"flex gap-3 px-6 py-4",children:[(0,a.jsx)(z.Z,{size:24,className:"text-primary"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"路由性能"}),(0,a.jsx)("p",{className:"text-sm text-default-500",children:"监控路由加载时间和错误率"})]})]}),(0,a.jsx)(o.G,{children:(0,a.jsxs)(h.n,{children:[(0,a.jsx)(x.r,{title:"表格视图",children:(0,a.jsx)(T.w,{columns:G,data:(null==F?void 0:F.data)||el,isLoading:H})},"table"),(0,a.jsx)(x.r,{title:"图表视图",children:(0,a.jsx)("div",{className:"w-full h-80",children:(0,a.jsx)(m.h,{width:"100%",height:"100%",children:(0,a.jsxs)(u.v,{data:(null==F?void 0:F.data)||el,margin:{top:20,right:30,left:20,bottom:5},children:[(0,a.jsx)(j.q,{strokeDasharray:"3 3"}),(0,a.jsx)(f.K,{dataKey:"name"}),(0,a.jsx)(p.B,{}),(0,a.jsx)(g.u,{}),(0,a.jsx)(v.$,{dataKey:"loadTime",name:"加载时间 (ms)",fill:"#8884d8"})]})})})},"chart")]})})]})]}),(0,a.jsx)(_,{isOpen:Z,onClose:A,routeId:E||0,fetchSuggestions:D.dx}),(0,a.jsx)(et,{isOpen:I,onClose:M,onExport:X,dateRange:t,setDateRange:O})]})}},29552:function(e,s,t){"use strict";var a=t(3827),l=t(64090),i=t(71272);s.Z=e=>{let{variant:s="default"}=e,t=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(!t.current)return;let e=t.current,a=e.getContext("2d");if(!a)return;let l=()=>{e.width=window.innerWidth,e.height=window.innerHeight};l(),window.addEventListener("resize",l);let i=[],n="minimal"===s?50:100;class r{update(){this.x+=this.speedX,this.y+=this.speedY,this.x>e.width?this.x=0:this.x<0&&(this.x=e.width),this.y>e.height?this.y=0:this.y<0&&(this.y=e.height)}draw(){a&&(a.fillStyle=this.color,a.beginPath(),a.arc(this.x,this.y,this.size,0,2*Math.PI),a.fill())}constructor(){this.x=Math.random()*e.width,this.y=Math.random()*e.height,this.size=2*Math.random()+.5,this.speedX=.5*Math.random()-.25,this.speedY=.5*Math.random()-.25,this.color="hsla(".concat(60*Math.random()+200,", 70%, 60%, ").concat(.8*Math.random()+.2,")")}}let c=()=>{if(a)for(let e=0;e<i.length;e++)for(let s=e;s<i.length;s++){let t=i[e].x-i[s].x,l=i[e].y-i[s].y,n=Math.sqrt(t*t+l*l);if(n<150){let t=1-n/150;a.strokeStyle="rgba(150, 150, 255, ".concat(.15*t,")"),a.lineWidth=.8,a.beginPath(),a.moveTo(i[e].x,i[e].y),a.lineTo(i[s].x,i[s].y),a.stroke()}}},d=()=>{if(a){for(let t of(a.clearRect(0,0,e.width,e.height),"default"===s&&o(),i))t.update(),t.draw();c(),requestAnimationFrame(d)}},o=()=>{if(!a)return;a.strokeStyle="rgba(100, 100, 255, 0.1)",a.beginPath(),a.lineWidth=1.5,a.arc(0,0,200,0,.5*Math.PI),a.stroke(),a.beginPath(),a.arc(e.width,e.height,250,Math.PI,1.5*Math.PI),a.stroke(),a.beginPath(),a.lineWidth=.8;let s=e.width/2,t=e.height/2,l=.4*Math.min(e.width,e.height);a.moveTo(s-l/2,t-l/2),a.lineTo(s+l/2,t-l/2),a.lineTo(s+l/2,t+l/2),a.lineTo(s-l/2,t+l/2),a.lineTo(s-l/2,t-l/2),a.stroke()};return(()=>{for(let e=0;e<n;e++)i.push(new r)})(),d(),()=>{window.removeEventListener("resize",l)}},[s]),(0,a.jsxs)("div",{className:"fixed inset-0 -z-10 overflow-hidden",children:[(0,a.jsx)("canvas",{ref:t,className:"absolute inset-0 w-full h-full"}),(0,a.jsx)("div",{className:"absolute top-0 -left-[10%] w-[50%] h-[50%] bg-primary/10 rounded-full blur-[150px] -z-10"}),(0,a.jsx)("div",{className:"absolute bottom-[10%] right-[10%] w-[40%] h-[40%] bg-secondary/10 rounded-full blur-[150px] -z-10"}),(0,a.jsx)(i.E.div,{className:"absolute top-[20%] right-[10%] w-16 h-16 border border-primary/20 rounded-full",animate:{y:[0,15,0],opacity:[.6,.9,.6],scale:[1,1.05,1]},transition:{duration:6,repeat:1/0,ease:"easeInOut"}}),(0,a.jsx)(i.E.div,{className:"absolute top-[10%] left-[20%] w-24 h-24 border border-secondary/30 rounded-xl rotate-45",animate:{y:[0,-20,0],opacity:[.3,.6,.3],rotate:[45,35,45]},transition:{duration:8,repeat:1/0,ease:"easeInOut"}}),(0,a.jsx)(i.E.div,{className:"absolute bottom-[30%] left-[5%] w-20 h-20 bg-gradient-to-tr from-primary/5 to-secondary/5 rounded-lg",animate:{x:[0,10,0],opacity:[.4,.7,.4],rotate:[0,10,0]},transition:{duration:7,repeat:1/0,ease:"easeInOut"}})]})}},14298:function(e,s,t){"use strict";t.d(s,{w:function(){return m}});var a=t(3827),l=t(64090),i=t(50535),n=t(9410),r=t(75129),c=t(63053),d=t(77058),o=t(45623),h=t(36685),x=t(92339);function m(e){let{columns:s,data:t,isLoading:m=!1,pagination:u=!1,pageSize:j=10}=e,[f,p]=l.useState(1),g=Math.ceil(t.length/j),v=l.useMemo(()=>{let e=(f-1)*j,s=e+j;return t.slice(e,s)},[f,t,j]),y=l.useCallback((e,t)=>{let a=s.find(e=>e.accessorKey===t);return(null==a?void 0:a.cell)?a.cell({row:{original:e}}):e[t]},[s]);return(0,a.jsx)("div",{className:"w-full",children:(0,a.jsxs)(i.b,{"aria-label":"数据表格",bottomContent:u&&g>1?(0,a.jsx)("div",{className:"flex w-full justify-center",children:(0,a.jsx)(n.g,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:f,total:g,onChange:p})}):null,children:[(0,a.jsx)(r.J,{children:s.map((e,s)=>(0,a.jsx)(c.j,{children:e.header},e.accessorKey||"column-".concat(s)))}),(0,a.jsx)(d.y,{items:v,loadingContent:(0,a.jsx)(o.c,{}),isLoading:m,emptyContent:m?null:"暂无数据",children:e=>(0,a.jsx)(h.g,{children:s.map(s=>(0,a.jsx)(x.X,{children:y(e,s.accessorKey)},s.accessorKey))},e.id)})]})})}},62665:function(e,s,t){"use strict";var a=t(3827),l=t(29552);let i={lg:"max-w-5xl",xl:"max-w-7xl",full:"w-full max-w-none"},n={sm:"py-6",md:"py-10",lg:"py-16"};s.Z=function(e){let{title:s,description:t,actions:r,children:c,backgroundVariant:d="minimal",maxWidth:o="xl",padding:h="md",contentClassName:x="",headerClassName:m=""}=e,u=["relative","mx-auto","w-full","px-4",i[o],n[h],x].filter(Boolean).join(" "),j=s||t||r;return(0,a.jsxs)("main",{className:"relative min-h-screen overflow-hidden",children:["none"!==d&&(0,a.jsx)(l.Z,{variant:"default"===d?"default":"minimal"}),(0,a.jsxs)("div",{className:u,children:[j&&(0,a.jsxs)("div",{className:["mb-8","flex flex-col gap-4","sm:flex-row sm:items-center sm:justify-between",m].filter(Boolean).join(" "),children:[(0,a.jsxs)("div",{className:"space-y-1",children:[s&&(0,a.jsx)("h1",{className:"text-2xl font-bold md:text-3xl",children:s}),t&&(0,a.jsx)("p",{className:"max-w-2xl text-base text-default-500 md:text-lg",children:t})]}),r&&(0,a.jsx)("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:r})]}),(0,a.jsx)("div",{className:"relative z-10",children:c})]})]})}}},function(e){e.O(0,[6034,9390,9689,7945,7530,9178,3614,2178,5784,7385,6288,224,4187,1945,8704,414,4322,4642,4788,6373,5769,3135,1189,2131,2971,8069,1744],function(){return e(e.s=97986)}),_N_E=e.O()}]);