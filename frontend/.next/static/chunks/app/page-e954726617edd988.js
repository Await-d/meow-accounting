(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931,2131],{18803:function(e,t,r){Promise.resolve().then(r.bind(r,66504))},6297:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(57977).Z)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},16015:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(57977).Z)("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]])},26490:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(57977).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},44715:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(57977).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},34059:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(57977).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},17252:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(57977).Z)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]])},47907:function(e,t,r){"use strict";var n=r(15313);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},66504:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return I}});var n=r(3827),a=r(64090),s=r(10732),o=r(67945),i=r(51055);let c=a.forwardRef(function(e,t){let{title:r,titleId:n,...s}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),r?a.createElement("title",{id:n},r):null,a.createElement("path",{fillRule:"evenodd",d:"M11.47 2.47a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06l-6.22-6.22V21a.75.75 0 0 1-1.5 0V4.81l-6.22 6.22a.75.75 0 1 1-1.06-1.06l7.5-7.5Z",clipRule:"evenodd"}))});var l=r(72949),u=r(52131),d=r(8792),h=r(71272),f=r(47907),m=r(57977);let p=(0,m.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),y=(0,m.Z)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);var g=r(17252),x=r(6297),w=r(34059),v=r(16015),b=r(26490),j=r(44715);function I(){let e=(0,f.useRouter)(),{user:t}=(0,u.useAuth)(),[r,m]=(0,a.useState)(""),[I,N]=(0,a.useState)(!1),[S,T]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{let e=new Date().getHours();e<6?m("夜深了"):e<12?m("早上好"):e<14?m("中午好"):e<18?m("下午好"):m("晚上好")},[]),(0,a.useEffect)(()=>{let e=()=>{window.scrollY>300?N(!0):N(!1)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(0,a.useEffect)(()=>{let e=setTimeout(()=>{T(!1)},1e3);return()=>clearTimeout(e)},[]),S)?(0,n.jsx)(l.a_,{}):(0,n.jsxs)("main",{className:"relative overflow-hidden",children:[(0,n.jsx)(l.vL,{}),(0,n.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-7xl",children:[(0,n.jsxs)(h.E.div,{className:"flex flex-col gap-4 md:flex-row md:justify-between md:items-center mb-12 pt-4",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,n.jsx)(l.TR,{variant:"large"}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(l.R5,{}),t?(0,n.jsx)(s.A,{onPress:()=>{if(t){t.default_route?e.push(t.default_route):e.push("/dashboard");return}e.push("/auth/login")},color:"primary",size:"lg",className:"px-6",children:"进入应用"}):(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(d.default,{href:"/auth/login",children:(0,n.jsx)(s.A,{variant:"flat",size:"lg",children:"登录"})}),(0,n.jsx)(d.default,{href:"/auth/register",children:(0,n.jsx)(s.A,{color:"primary",size:"lg",className:"bg-gradient-to-r from-primary to-secondary border-0",children:"注册"})})]})]})]}),(0,n.jsx)("div",{className:"py-16 md:py-24",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12 items-center",children:[(0,n.jsxs)(h.E.div,{className:"space-y-6",initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},children:[(0,n.jsx)(l.qY,{title:"智能家庭记账",subtitle:"轻松管理财务，实现财务自由",size:"xl",withUnderline:!0}),(0,n.jsx)("p",{className:"text-xl text-default-600 mt-6",children:"喵呜记账是一款专为家庭设计的财务管理工具，帮助您和家人共同记录收支，分析消费习惯，实现财务目标。"}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-4 mt-8",children:[(0,n.jsx)(d.default,{href:"/auth/register",children:(0,n.jsx)(s.A,{color:"primary",size:"lg",className:"bg-gradient-to-r from-primary to-secondary border-0 px-8",endContent:(0,n.jsx)(p,{size:16}),children:"立即开始"})}),(0,n.jsx)(d.default,{href:"/dashboard",children:(0,n.jsx)(s.A,{variant:"bordered",size:"lg",className:"border-default-200",children:"了解更多"})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 mt-6",children:[(0,n.jsx)("div",{className:"flex -space-x-2",children:[1,2,3].map(e=>(0,n.jsx)("div",{className:"w-8 h-8 rounded-full bg-default-100 flex items-center justify-center border-2 border-background",children:(0,n.jsx)("span",{className:"text-xs",children:"\uD83D\uDC64"})},e))}),(0,n.jsxs)("p",{className:"text-default-500 text-sm",children:["已有 ",(0,n.jsx)("span",{className:"font-semibold text-foreground",children:"1,000+"})," 家庭正在使用"]})]})]}),(0,n.jsxs)(h.E.div,{className:"relative",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.6,delay:.4},children:[(0,n.jsx)("div",{className:"absolute -top-10 -left-10 w-20 h-20 bg-primary/10 rounded-full blur-xl"}),(0,n.jsx)("div",{className:"absolute -bottom-10 -right-10 w-20 h-20 bg-secondary/10 rounded-full blur-xl"}),(0,n.jsx)(o.w,{className:"overflow-hidden border border-default-100",children:(0,n.jsx)(i.G,{className:"p-0",children:(0,n.jsx)("img",{src:"/icons/icon-192x192.png",alt:"喵呜记账应用展示",className:"w-full h-auto object-cover aspect-video bg-default-100 p-8",onError:e=>{e.currentTarget.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100%25' height='100%25' viewBox='0 0 800 400'%3E%3Cdefs%3E%3ClinearGradient id='a' gradientUnits='userSpaceOnUse' x1='400' y1='50' x2='400' y2='350'%3E%3Cstop offset='0' stop-color='%23777' stop-opacity='0.7'/%3E%3Cstop offset='1' stop-color='%23444' stop-opacity='0.4'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill='url(%23a)' width='800' height='400'/%3E%3Cg fill-opacity='0.4'%3E%3Ccircle fill='%23FFF' cx='400' cy='200' r='150'/%3E%3Ccircle fill='%23DDD' cx='400' cy='200' r='100'/%3E%3Ccircle fill='%23999' cx='400' cy='200' r='50'/%3E%3C/g%3E%3Ctext x='400' y='220' font-family='Arial' font-size='40' text-anchor='middle' fill='%23FFFFFF'%3E喵呜记账%3C/text%3E%3C/svg%3E"}})})}),(0,n.jsx)(h.E.div,{className:"absolute -bottom-6 -right-6 bg-background p-3 rounded-xl shadow-lg border border-default-100",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.8},children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"w-10 h-10 rounded-full bg-success/10 flex items-center justify-center",children:(0,n.jsx)(y,{className:"w-5 h-5 text-success"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs text-default-500",children:"本月结余"}),(0,n.jsx)("p",{className:"font-semibold text-success",children:"+\xa53,240.50"})]})]})})]})]})}),(0,n.jsxs)("div",{className:"py-20",children:[(0,n.jsx)(l.qY,{title:"强大功能",subtitle:"专为家庭财务管理设计的全方位解决方案",align:"center",className:"mb-16",withUnderline:!0}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,n.jsx)(l.TT,{title:"智能记账",description:"简单直观地记录日常收入和支出，支持多种分类和标签，让记账变得轻松愉快。",icon:(0,n.jsx)(g.Z,{className:"w-8 h-8"}),gradient:"primary"}),(0,n.jsx)(l.TT,{title:"数据分析",description:"智能分析您的消费习惯，生成直观的图表和报告，帮助您了解资金流向。",icon:(0,n.jsx)(x.Z,{className:"w-8 h-8"}),gradient:"success"}),(0,n.jsx)(l.TT,{title:"家庭共享",description:"邀请家人加入，共同管理家庭财务，设置不同权限，保护隐私的同时实现协作。",icon:(0,n.jsx)(w.Z,{className:"w-8 h-8"}),gradient:"warning"}),(0,n.jsx)(l.TT,{title:"预算规划",description:"设置月度或年度预算目标，系统自动追踪支出情况，帮助您控制消费。",icon:(0,n.jsx)(v.Z,{className:"w-8 h-8"}),gradient:"danger"}),(0,n.jsx)(l.TT,{title:"定期报告",description:"自动生成每周、每月财务报告，通过邮件发送，让您随时了解财务状况。",icon:(0,n.jsx)(b.Z,{className:"w-8 h-8"}),gradient:"secondary"}),(0,n.jsx)(l.TT,{title:"数据导出",description:"支持多种格式导出数据，方便您进行备份或进一步分析。",icon:(0,n.jsx)(j.Z,{className:"w-8 h-8"}),gradient:"primary"})]})]}),(0,n.jsx)(h.E.div,{className:"py-16 mb-16",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},children:(0,n.jsx)(o.w,{className:"overflow-hidden border-0 bg-gradient-to-r from-primary-900/40 to-secondary-900/40 backdrop-blur-sm",children:(0,n.jsx)(i.G,{className:"p-8 md:p-12",children:(0,n.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[(0,n.jsxs)("div",{className:"space-y-4 text-center md:text-left",children:[(0,n.jsx)("h2",{className:"text-3xl font-bold",children:"准备好开始使用了吗？"}),(0,n.jsx)("p",{className:"text-xl text-default-600",children:"加入我们，开始智能管理您的家庭财务"})]}),(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsx)(d.default,{href:"/auth/register",children:(0,n.jsx)(s.A,{color:"primary",size:"lg",className:"bg-gradient-to-r from-primary to-secondary border-0 px-8",children:"免费注册"})}),(0,n.jsx)(d.default,{href:"/auth/login",children:(0,n.jsx)(s.A,{variant:"flat",size:"lg",className:"bg-background/20 backdrop-blur-md",children:"登录账号"})})]})]})})})})]}),I&&(0,n.jsx)(s.A,{isIconOnly:!0,color:"primary",variant:"flat",className:"fixed bottom-6 right-6 z-50 rounded-full",onPress:()=>{window.scrollTo({top:0,behavior:"smooth"})},children:(0,n.jsx)(c,{className:"w-5 h-5"})})]})}},96770:function(e,t,r){"use strict";r.r(t),r.d(t,{ToastProvider:function(){return c},useToast:function(){return i}});var n=r(3827),a=r(64090),s=r(10963);let o=(0,a.createContext)(void 0);function i(){let e=(0,a.useContext)(o);if(!e)throw Error("useToast must be used within a ToastProvider");return e}function c(e){let{children:t}=e;return(0,n.jsxs)(o.Provider,{value:{showToast:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r={duration:3e3,style:{padding:"16px",borderRadius:"8px"}};switch(t){case"success":s.Am.success(e,r);break;case"error":s.Am.error(e,r);break;case"warning":(0,s.Am)(e,{...r,icon:"⚠️"});break;default:(0,s.Am)(e,{...r,icon:"ℹ️"})}}},children:[t,(0,n.jsx)(s.x7,{position:"top-center"})]})}},26632:function(e,t,r){"use strict";r.d(t,{AW:function(){return s},Kz:function(){return a},P8:function(){return o}});var n=r(77785);let a={[n.Yt.DASHBOARD]:{component:()=>Promise.all([r.e(7674),r.e(6034),r.e(9390),r.e(9689),r.e(7945),r.e(7530),r.e(9178),r.e(3614),r.e(5784),r.e(7385),r.e(6288),r.e(224),r.e(4187),r.e(1945),r.e(8704),r.e(414),r.e(4322),r.e(568),r.e(5961),r.e(4642),r.e(4788),r.e(6373),r.e(8792),r.e(5769),r.e(1581),r.e(6573),r.e(9430),r.e(3135),r.e(2616),r.e(5626),r.e(3530),r.e(7456),r.e(2949),r.e(7923),r.e(8026)]).then(r.bind(r,27923)).then(e=>e.default),permission:n.wI.PRIVATE,layout:()=>Promise.all([r.e(9390),r.e(9178),r.e(3614),r.e(7108)]).then(r.bind(r,17108)).then(e=>e.default)},[n.Yt.TRANSACTIONS]:{component:()=>Promise.all([r.e(6034),r.e(9390),r.e(9689),r.e(7945),r.e(7530),r.e(9178),r.e(3614),r.e(5784),r.e(7385),r.e(6288),r.e(224),r.e(4187),r.e(1945),r.e(8704),r.e(414),r.e(4322),r.e(568),r.e(5961),r.e(4788),r.e(1581),r.e(2616),r.e(3121),r.e(7456),r.e(1731)]).then(r.bind(r,47646)).then(e=>e.default),permission:n.wI.FAMILY,layout:()=>Promise.all([r.e(6034),r.e(9390),r.e(9689),r.e(7945),r.e(7530),r.e(9178),r.e(3614),r.e(6288),r.e(3121),r.e(3345)]).then(r.bind(r,33345)).then(e=>e.default)},[n.Yt.STATISTICS]:{component:()=>Promise.all([r.e(7674),r.e(6034),r.e(9390),r.e(9689),r.e(7945),r.e(7530),r.e(9178),r.e(3614),r.e(5784),r.e(7385),r.e(6288),r.e(224),r.e(4187),r.e(1945),r.e(8704),r.e(414),r.e(4322),r.e(568),r.e(5961),r.e(4642),r.e(4788),r.e(6373),r.e(8792),r.e(5769),r.e(1581),r.e(6573),r.e(3121),r.e(7456),r.e(2949),r.e(7641)]).then(r.bind(r,87641)).then(e=>e.default),permission:n.wI.FAMILY,layout:()=>Promise.all([r.e(6034),r.e(9390),r.e(9689),r.e(7945),r.e(7530),r.e(9178),r.e(3614),r.e(6288),r.e(3121),r.e(8891)]).then(r.bind(r,18891)).then(e=>e.default)},[n.Yt.SETTINGS]:{component:()=>Promise.all([r.e(6034),r.e(9390),r.e(9689),r.e(7945),r.e(1077)]).then(r.bind(r,1077)).then(e=>e.default),permission:n.wI.PRIVATE,layout:()=>Promise.all([r.e(6034),r.e(9390),r.e(9689),r.e(7945),r.e(9178),r.e(3614),r.e(8792),r.e(1207)]).then(r.bind(r,31207)).then(e=>e.default)},[n.Yt.CUSTOM]:{component:()=>Promise.all([r.e(6034),r.e(9390),r.e(9689),r.e(7945),r.e(9178),r.e(3614),r.e(6288),r.e(3121),r.e(7386)]).then(r.bind(r,7386)).then(e=>e.default),permission:n.wI.PRIVATE,layout:()=>Promise.all([r.e(6034),r.e(9390),r.e(9689),r.e(7945),r.e(7530),r.e(9178),r.e(3614),r.e(510)]).then(r.bind(r,20510)).then(e=>e.default)}};function s(e,t,r,s){switch(a[e],t){case n.wI.PUBLIC:return!0;case n.wI.PRIVATE:return!!r;case n.wI.FAMILY:case n.wI.ADMIN:return!!r&&!!s;default:return!1}}async function o(e,t){let r=a[t];if(!r)throw Error("未找到路由类型 ".concat(t," 对应的组件"));try{let e=await r.component(),t=r.layout?await r.layout():null;return{Component:e,Layout:t,permission:r.permission}}catch(e){throw console.error("加载路由组件失败: ".concat(e)),e}}},52131:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return g},useAuth:function(){return x}});var n=r(3827),a=r(64090),s=r(47907),o=r(96770),i=r(58222),c=r(94564),l=r(37963),u=r(77785),d=r(26632);let h=async e=>{let t=await (0,i.Io)("/auth/login",{method:"POST",body:JSON.stringify(e)});return console.log("ssss",t),t.data},f=async e=>(await (0,i.Io)("/auth/register",{method:"POST",body:JSON.stringify(e)})).data,m=async e=>(await (0,i.Io)("/auth/verify-guest",{method:"POST",body:JSON.stringify({password:e})})).data,p=async e=>(await (0,i.Io)("/user/settings",{method:"PATCH",body:JSON.stringify(e)})).data,y=(0,a.createContext)(void 0);function g(e){let{children:t}=e,[r,i]=(0,a.useState)(null),[g,x]=(0,a.useState)(!1),[w,v]=(0,a.useState)(!1),b=(0,s.useRouter)(),{showToast:j}=(0,o.useToast)(),I=e=>{try{let t=(0,l.o)(e),r=Date.now()/1e3;if(t.exp&&t.exp<r)return(0,c.gy)(),localStorage.removeItem("isGuest"),null;return{id:t.id,username:t.username,email:t.email,role:t.role,privacy_mode:t.privacy_mode,default_route:t.default_route,permissions:t.permissions}}catch(e){return console.error("解析 token 失败:",e),(0,c.gy)(),localStorage.removeItem("isGuest"),null}},N=async e=>{if(!e||!e.default_route){b.push("/dashboard");return}try{let t=e.default_route,r=t.split("/")[1];if(!(0,d.AW)(r,u.wI.PRIVATE,"string"==typeof e.id?parseInt(e.id,10):e.id,e.currentFamilyId?"string"==typeof e.currentFamilyId?parseInt(e.currentFamilyId,10):e.currentFamilyId:void 0)){console.warn("用户无权访问默认路由，重定向到仪表盘"),b.push("/dashboard");return}await (0,d.P8)(t,r),b.push(t)}catch(e){console.error("路由导航失败:",e),b.push("/dashboard")}};(0,a.useEffect)(()=>{let e=(0,c.LP)(),t="true"===localStorage.getItem("isGuest"),r=window.location.pathname,n=r.startsWith("/auth/"),a="/"===r||"/about"===r;if(e){let r=I(e);r?(i(r),x(t),n&&N(r)):n||a||b.push("/auth/login")}else n||a||b.push("/auth/login")},[b]);let S=async(e,t)=>{try{let{token:r,user:n}=await h({email:e,password:t});(0,c.o4)(r),i(n),x(!1),localStorage.setItem("isGuest","false"),j("登录成功","success"),N(n)}catch(e){throw j("登录失败","error"),e}},T=async e=>{try{let{token:t,user:r}=await f(e);(0,c.o4)(t),i(r),x(!1),localStorage.setItem("isGuest","false"),j("注册成功","success"),N(r)}catch(e){throw j("注册失败","error"),e}},E=async e=>{try{await m(e),x(!0),localStorage.setItem("isGuest","true")}catch(e){throw e}},P=async e=>{try{let t=await p(e);return i(t),t}catch(e){throw e instanceof Error?j(e.message,"error"):j("更新设置失败","error"),e}};return(0,n.jsx)(y.Provider,{value:{user:r,isGuest:g,isLoading:w,setUser:i,updateUser:e=>{i(e)},updateSettings:P,login:S,register:T,logout:()=>{(0,c.gy)(),localStorage.removeItem("isGuest"),i(null),x(!1),b.push("/auth/login")},enterGuestMode:E,exitGuestMode:()=>{x(!1),localStorage.removeItem("isGuest")},handleUnauthorized:()=>{(0,c.gy)(),localStorage.removeItem("isGuest"),localStorage.removeItem("currentFamilyId"),i(null),x(!1),"/auth/login"!==window.location.pathname&&(j("登录已过期，请重新登录","error"),b.push("/auth/login"))}},children:t})}function x(){let e=(0,a.useContext)(y);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},58222:function(e,t,r){"use strict";r.d(t,{AW:function(){return E},Cp:function(){return O},Ds:function(){return m},HL:function(){return x},Hb:function(){return c},Io:function(){return h},KX:function(){return y},M$:function(){return D},Ml:function(){return A},Nq:function(){return P},Ny:function(){return w},P9:function(){return v},R5:function(){return C},_c:function(){return b},dx:function(){return p},fM:function(){return T},fq:function(){return I},h8:function(){return k},hQ:function(){return l},le:function(){return g},ot:function(){return j},qW:function(){return N},rr:function(){return S},we:function(){return f}});var n=r(77785),a=r(94564);let s=r(49079).env.NEXT_PUBLIC_API_URL||"http://localhost:3001/api",o=null,i=null;function c(e){o=e}function l(e){i=e}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";i?i(e,t):console["error"===t?"error":"warning"===t?"warn":"log"](e)}let d={400:e=>{console.warn("请求参数错误: ".concat(e)),u("请求参数错误: ".concat(e),"warning")},401:e=>{(0,a.gy)(),localStorage.removeItem("isGuest"),localStorage.removeItem("currentFamilyId"),o?o():"/auth/login"!==window.location.pathname&&(u("登录已过期，请重新登录"+window.location.pathname,"error"),window.location.href="/auth/login")},403:e=>{console.warn("无权访问: ".concat(e)),u("无权访问: ".concat(e),"error")},404:e=>{console.warn("资源不存在: ".concat(e)),u("资源不存在: ".concat(e),"warning")},422:e=>{console.warn("数据验证失败: ".concat(e)),u("数据验证失败: ".concat(e),"warning")},429:e=>{console.warn("请求过多，请稍后再试: ".concat(e)),u("请求过多，请稍后再试","warning")},500:e=>{console.error("服务器错误: ".concat(e)),u("服务器内部错误，请稍后再试: ".concat(e),"error")},502:e=>{console.error("网关错误: ".concat(e)),u("服务器网关错误，请稍后再试","error")},503:e=>{console.error("服务不可用: ".concat(e)),u("服务暂时不可用，请稍后再试","error")},504:e=>{console.error("网关超时: ".concat(e)),u("请求超时，请检查网络连接后重试","error")}};async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="".concat(s).concat(e),o=(0,a.LP)(),i={"Content-Type":"application/json",...o?{Authorization:"Bearer ".concat(o)}:{}};try{let e=await fetch(r,{...t,headers:{...i,...t.headers}}),a=await e.json();if(console.log("sssssss",a),!e.ok){let t=d[e.status];throw t&&t(a.message||"请求失败"),new n.Hx(e.status,a.message||"请求失败")}return{data:a,message:a.message,status:e.status}}catch(e){if(e instanceof n.Hx)throw e;throw new n.Hx(500,e instanceof Error?e.message:"网络错误")}}let f=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"请求失败";if(e instanceof n.Hx)switch(e.status){case 400:return"请求参数错误: ".concat(e.message);case 403:return"无权访问: ".concat(e.message);case 404:return"资源不存在: ".concat(e.message);case 429:return"请求过于频繁，请稍后再试";case 500:case 502:case 503:return"服务器错误: ".concat(e.message);default:return e.message||t}return(null==e?void 0:e.message)||t};async function m(e){return(await h("/routes/predictions?user_id=".concat(e),{method:"GET"})).data}async function p(e){return(await h("/routes/".concat(e,"/optimization"),{method:"GET"})).data}async function y(e){let t=new URLSearchParams;e.startDate&&t.append("startDate",e.startDate),e.endDate&&t.append("endDate",e.endDate),e.routeIds&&e.routeIds.length>0&&e.routeIds.forEach(e=>t.append("routeIds[]",e.toString()));let r="".concat(s,"/routes/export?").concat(t.toString(),"&format=").concat(e.format),o=(0,a.LP)(),i=await fetch(r,{method:"GET",headers:{...o?{Authorization:"Bearer ".concat(o)}:{}}});if(!i.ok){let e=await i.json();throw new n.Hx(i.status,e.message||"导出失败")}return await i.blob()}async function g(e){let t=new URLSearchParams;return t.append("type",e.type),e.startDate&&t.append("startDate",e.startDate),e.endDate&&t.append("endDate",e.endDate),e.routeIds&&e.routeIds.length>0&&e.routeIds.forEach(e=>t.append("routeIds[]",e.toString())),(await h("/routes/visualization?".concat(t.toString()),{method:"GET"})).data}async function x(e){return h("/categories",{method:"POST",body:JSON.stringify(e)})}async function w(e,t){return h("/categories/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async function v(e){return h("/categories/".concat(e),{method:"DELETE"})}async function b(){return h("/routes")}async function j(e){return h("/routes",{method:"POST",body:JSON.stringify(e)})}async function I(e,t){return h("/routes/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async function N(e){return h("/routes/".concat(e),{method:"DELETE"})}async function S(e){return h("/routes/".concat(e,"/toggle"),{method:"POST"})}async function T(e){return h("/routes/".concat(e,"/stats"))}async function E(){return h("/users")}async function P(e,t){return h("/users/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async function k(e){return h("/users/".concat(e),{method:"DELETE"})}async function A(e){return h("/users/".concat(e,"/freeze"),{method:"POST"})}async function C(e){return h("/users/".concat(e,"/unfreeze"),{method:"POST"})}async function O(e){return h("/auth/change-password",{method:"POST",body:JSON.stringify(e)})}async function D(e){return h("/users/privacy",{method:"PUT",body:JSON.stringify(e)})}},77785:function(e,t,r){"use strict";var n,a,s,o;r.d(t,{Hx:function(){return i},Yt:function(){return n},wI:function(){return a}});class i extends Error{constructor(e,t){super(t),this.status=e,this.name="APIError"}}(s=n||(n={})).DASHBOARD="dashboard",s.TRANSACTIONS="transactions",s.STATISTICS="statistics",s.SETTINGS="settings",s.CUSTOM="custom",(o=a||(a={})).PUBLIC="public",o.PRIVATE="private",o.FAMILY="family",o.ADMIN="admin"},94564:function(e,t,r){"use strict";function n(){return localStorage.getItem("token")}function a(e){localStorage.setItem("token",e)}function s(){localStorage.removeItem("token")}r.d(t,{LP:function(){return n},gy:function(){return s},o4:function(){return a}})},37963:function(e,t,r){"use strict";r.d(t,{o:function(){return a}});class n extends Error{}function a(e,t){let r;if("string"!=typeof e)throw new n("Invalid token specified: must be a string");t||(t={});let a=!0===t.header?0:1,s=e.split(".")[a];if("string"!=typeof s)throw new n("Invalid token specified: missing part #".concat(a+1));try{r=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var r;return r=t,decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return atob(t)}}(s)}catch(e){throw new n("Invalid token specified: invalid base64 for part #".concat(a+1," (").concat(e.message,")"))}try{return JSON.parse(r)}catch(e){throw new n("Invalid token specified: invalid json for part #".concat(a+1," (").concat(e.message,")"))}}n.prototype.name="InvalidTokenError"}},function(e){e.O(0,[7674,6034,9390,9689,7945,7530,9178,3614,2178,5784,7385,224,4187,1945,8704,414,4322,568,5961,4642,4788,6373,8792,5769,1581,6573,7456,2949,2971,8069,1744],function(){return e(e.s=18803)}),_N_E=e.O()}]);