"use strict";exports.id=7377,exports.ids=[7377],exports.modules={87377:(e,s,t)=>{t.r(s),t.d(s,{default:()=>eV});var a=t(95344),l=t(3729),n=t.n(l),r=t(42242),i=t(4028),c=t(44738),d=t(56460),o=t(62483),x=t(75019),m=t(56686),u=t(40237),h=t(3635),j=t(48126),p=t(30891),f=t(45191),g=t(87055),y=t(84752),N=t(70596),v=t(81686),b=t(26417),w=t(97446),C=t(75462),z=t(41931),S=t(12873),Z=t(30853),k=t(12841),L=t(80954),A=t(71699),M=t(15006),$=t(96548),_=t(25390),F=t(51838),I=t(36407),P=t(29843),D=t(33733),E=t(89895),O=t(46064),G=t(31741),R=t(38271),W=t(48869),Y=t.n(W),T=t(80089),V=t(18964),B=t(16639),H=t(20903),K=t(86902),q=t(29173),U=t(90626),X=t(31634),J=t(2303),Q=t(2422),ee=t(91529),es=t(77402);function et({statistics:e,isLoading:s,timeRange:t}){let n=(0,l.useMemo)(()=>e?.chart?e.chart.map(e=>({...e,balance:e.income-e.expense})):[],[e]),r=(0,l.useMemo)(()=>{if(n.length<2)return 0;let e=n[0].balance;return n[n.length-1].balance-e},[n]),i=e=>{let{x:s,y:t,width:l,height:n,fill:r}=e;return a.jsx(ee.E.rect,{x:s,y:t,width:l,height:n,fill:r,rx:4,ry:4,initial:{height:0,y:t+n},animate:{height:n,y:t},transition:{duration:.5,ease:"easeOut"}})},c={month:"本月收支统计",quarter:"本季度收支统计",year:"本年收支统计"},d=e=>new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY",minimumFractionDigits:0}).format(e);return s?(0,a.jsxs)(m.w,{className:"h-full",children:[a.jsx(g.u,{className:"pb-0",children:a.jsx("h3",{className:"text-lg font-medium",children:c[t]})}),a.jsx(u.G,{children:a.jsx("div",{className:"flex justify-center items-center h-[300px]",children:a.jsx(y.c,{})})})]}):e&&e.chart&&0!==e.chart.length?(0,a.jsxs)(m.w,{className:"overflow-hidden border border-default-100",children:[(0,a.jsxs)(g.u,{className:"pb-0 pt-4 px-4 flex-col items-start",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center w-full",children:[a.jsx("h4",{className:"font-bold text-large",children:"收支趋势"}),0!==r&&(0,a.jsxs)(T.z,{color:r>0?"success":"danger",variant:"flat",startContent:r>0?a.jsx(O.Z,{size:14}):a.jsx(es.Z,{size:14}),children:[r>0?"+":"",d(r)]})]}),(0,a.jsxs)("p",{className:"text-tiny text-default-500",children:["month"===t?"本月":"quarter"===t?"本季度":"本年","收支情况",e&&` (总收入: ${d(e.total_income)}, 总支出: ${d(e.total_expense)})`]})]}),a.jsx(u.G,{className:"overflow-hidden py-5",children:s?a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(y.c,{size:"lg"})}):a.jsx("div",{className:"w-full h-80",children:a.jsx(V.h,{width:"100%",height:"100%",children:(0,a.jsxs)(B.c,{data:n,margin:{top:20,right:30,left:20,bottom:5},"aria-label":"收入支出趋势图表",children:[(0,a.jsxs)("defs",{children:[(0,a.jsxs)("linearGradient",{id:"incomeGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"var(--success)",stopOpacity:.8}),a.jsx("stop",{offset:"95%",stopColor:"var(--success)",stopOpacity:.2})]}),(0,a.jsxs)("linearGradient",{id:"expenseGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"var(--danger)",stopOpacity:.8}),a.jsx("stop",{offset:"95%",stopColor:"var(--danger)",stopOpacity:.2})]}),(0,a.jsxs)("linearGradient",{id:"balanceGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"var(--primary)",stopOpacity:.8}),a.jsx("stop",{offset:"95%",stopColor:"var(--primary)",stopOpacity:.2})]})]}),a.jsx(H.q,{strokeDasharray:"3 3",stroke:"var(--default-200)",opacity:.3}),a.jsx(K.K,{dataKey:"date",tick:{fill:"var(--foreground-500)"},axisLine:{stroke:"var(--default-200)"},tickLine:{stroke:"var(--default-200)"}}),a.jsx(q.B,{tick:{fill:"var(--foreground-500)"},axisLine:{stroke:"var(--default-200)"},tickLine:{stroke:"var(--default-200)"}}),a.jsx(U.u,{content:a.jsx(({active:e,payload:s,label:t})=>e&&s&&s.length?(0,a.jsxs)("div",{className:"bg-content1 p-3 rounded-lg shadow-lg border border-default-100",children:[a.jsx("p",{className:"text-sm font-medium text-foreground",children:`日期: ${t}`}),(0,a.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,a.jsxs)("p",{className:"text-xs flex items-center",children:[a.jsx("span",{className:"w-3 h-3 inline-block mr-2 rounded-full bg-success"}),a.jsx("span",{children:"收入: "}),(0,a.jsxs)("span",{className:"ml-1 font-medium text-success",children:[s[0].value," 元"]})]}),(0,a.jsxs)("p",{className:"text-xs flex items-center",children:[a.jsx("span",{className:"w-3 h-3 inline-block mr-2 rounded-full bg-danger"}),a.jsx("span",{children:"支出: "}),(0,a.jsxs)("span",{className:"ml-1 font-medium text-danger",children:[s[1].value," 元"]})]}),(0,a.jsxs)("p",{className:"text-xs flex items-center",children:[a.jsx("span",{className:"w-3 h-3 inline-block mr-2 rounded-full bg-primary"}),a.jsx("span",{children:"余额: "}),(0,a.jsxs)("span",{className:"ml-1 font-medium text-primary",children:[s[2].value," 元"]})]})]})]}):null,{})}),a.jsx(X.D,{wrapperStyle:{paddingTop:10}}),a.jsx(J.$,{dataKey:"income",name:"收入",fill:"url(#incomeGradient)",shape:a.jsx(i,{}),radius:[4,4,0,0],barSize:"month"===t?15:10}),a.jsx(J.$,{dataKey:"expense",name:"支出",fill:"url(#expenseGradient)",shape:a.jsx(i,{}),radius:[4,4,0,0],barSize:"month"===t?15:10}),a.jsx(Q.x,{type:"monotone",dataKey:"balance",name:"余额",stroke:"var(--primary)",strokeWidth:2,dot:{r:4,strokeWidth:1,fill:"var(--content1)",stroke:"var(--primary)"},activeDot:{r:6,strokeWidth:1,fill:"var(--primary)",stroke:"var(--content1)"}})]})})})})]}):(0,a.jsxs)(m.w,{className:"h-full",children:[a.jsx(g.u,{className:"pb-0",children:a.jsx("h3",{className:"text-lg font-medium",children:c[t]})}),a.jsx(u.G,{children:a.jsx("div",{className:"flex justify-center items-center h-[300px]",children:a.jsx("p",{className:"text-default-500",children:"暂无数据"})})})]})}var ea=t(82087),el=t(55119),en=t(51236);let er=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#83a6ed","#8dd1e1","#82ca9d","#a4de6c"];function ei({data:e,isLoading:s}){if(s)return a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(y.c,{})});if(!e||0===e.length)return a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx("p",{className:"text-gray-500",children:"暂无数据"})});let t=e.find(e=>"expense"===e.type);if(!t||!t.categories||0===t.categories.length)return a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx("p",{className:"text-gray-500",children:"暂无支出数据"})});let l=[...t.categories].sort((e,s)=>s.amount-e.amount).slice(0,8);return a.jsx(V.h,{width:"100%",height:"100%",children:(0,a.jsxs)(ea.u,{"aria-label":"支出分类饼图",children:[a.jsx(el.b,{data:l,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"amount",nameKey:"name",label:({name:e,percent:s})=>`${e}: ${(100*s).toFixed(0)}%`,animationBegin:0,animationDuration:1500,animationEasing:"ease-out","aria-label":"支出分类占比饼图",children:l.map((e,s)=>a.jsx(en.b,{fill:e.color||er[s%er.length]},`cell-${s}`))}),a.jsx(U.u,{formatter:e=>[`${e} 元`,""],labelFormatter:e=>`类别: ${e}`})]})})}var ec=t(41501),ed=t(56223);let eo=({transactions:e,isLoading:s=!1,onEdit:t,onDelete:n,isPersonalMode:r=!1,userId:i,limit:d=5,onViewMore:o})=>{console.log("RecentTransactions组件接收到的交易数据:",e);let x=e=>{if(!e)return"";try{return(0,ed.WU)(new Date(e),"yyyy-MM-dd")}catch(s){return console.error("日期格式化错误:",s,e),""}},h=e=>{if(null==e)return"";let s="string"==typeof e?parseFloat(e):e;return isNaN(s)?"":new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY",minimumFractionDigits:2}).format(s)},j=e=>!!e&&!!i&&(e.user_id||e.createdBy)===Number(i),p=(0,l.useMemo)(()=>{if(!e)return console.log("交易数据为null或undefined"),[];if(!Array.isArray(e))return console.log("交易数据不是数组类型:",typeof e),[];if(0===e.length)return console.log("交易数组为空"),[];console.log("过滤前交易数量:",e.length);let s=e.filter(e=>null!=e&&"object"==typeof e&&("id"in e||"amount"in e||"type"in e));s.length<e.length&&console.warn("发现无效交易数据，已过滤");let t=[...s].sort((e,s)=>{try{let t=e.date?new Date(e.date).getTime():0;return(s.date?new Date(s.date).getTime():0)-t}catch(e){return console.error("日期排序错误:",e),0}}).slice(0,d);return console.log("过滤后交易数量:",t.length),t.forEach((e,s)=>{console.log(`交易${s+1}:`,{id:e.id,type:e.type,amount:e.amount,date:e.date,category:e.category_name})}),t},[e,d]);return console.log("过滤后的交易数据:",p),a.jsx("div",{className:"w-full",children:s?a.jsx("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>a.jsx(ec.X,{className:"h-20 w-full rounded-lg"},s))}):p.length?(0,a.jsxs)("div",{className:"space-y-3",children:[p.map((e,s)=>(console.log("渲染交易项:",s,e?.id),a.jsx(m.w,{className:"bg-content1/50",children:a.jsx(u.G,{className:"p-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`p-2 rounded-full ${e?.type==="income"?"bg-success/10":"bg-danger/10"}`,children:e?.type==="income"?a.jsx(P.Z,{size:20,className:"text-success"}):a.jsx(I.Z,{size:20,className:"text-danger"})}),a.jsx("div",{className:"flex-grow",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium",children:e?.category_name||"未分类"}),(0,a.jsxs)("p",{className:"text-xs text-default-500",children:[x(e?.date||new Date),!r&&e?.user_id&&(0,a.jsxs)("span",{className:`ml-2 ${j(e)?"text-primary font-medium":"text-default-500"}`,children:[e?.user_id?`用户${e.user_id}`:"未知用户",j(e)&&" (我)"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:`font-semibold ${e?.type==="income"?"text-success":"text-danger"}`,children:[e?.type==="income"?"+":"-",h(e?.amount)]}),e?.description&&a.jsx("p",{className:"text-xs text-default-500",children:e?.description})]})]})}),(0,a.jsxs)("div",{className:"flex gap-1",children:[a.jsx(c.A,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>t&&t(e),children:a.jsx(G.Z,{size:16})}),a.jsx(c.A,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>n&&e?.id&&n(e.id),className:"text-danger",children:a.jsx(R.Z,{size:16})})]})]})})},e?.id||`trans-${s}`))),o&&e.length>d&&a.jsx(c.A,{className:"w-full mt-2",variant:"flat",color:"primary",onPress:o,children:"查看更多交易记录"})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[a.jsx("p",{className:"text-default-500 mb-2",children:r?"您暂无交易记录":"暂无家庭交易记录"}),a.jsx(c.A,{size:"sm",color:"primary",onPress:()=>t&&t({}),children:"添加第一笔交易"})]})})};var ex=t(20518),em=t(24540),eu=t(63806),eh=t(25384),ej=t(77001),ep=t(13746),ef=t(2273),eg=t(99046),ey=t(37121),eN=t(23485),ev=t(8428);let eb=({className:e,variant:s="solid"})=>{let t=(0,ev.useRouter)(),l=e=>{switch(e){case"system":t.push("/settings/system");break;case"users":t.push("/settings/users");break;case"families":t.push("/settings/families");break;case"categories":t.push("/settings/categories");break;case"logs":t.push("/settings/logs");break;case"backup":t.push("/settings/backup");break;default:t.push("/settings")}};return(0,a.jsxs)(r.F,{children:[a.jsx(i.S,{children:a.jsx(c.A,{className:`${"shadow"!==s?"bg-gradient-to-r from-purple-500 to-purple-600 text-white":e}`,endContent:a.jsx(_.Z,{size:16}),startContent:a.jsx(ee.E.div,{animate:{rotate:[0,15,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:a.jsx(ep.Z,{size:18})}),radius:"full",size:"md",variant:s,color:"secondary",children:"后台管理"})}),(0,a.jsxs)(d.a,{"aria-label":"后台管理操作",variant:"flat",children:[a.jsx(o.W,{startContent:a.jsx(ef.Z,{size:16}),description:"管理系统仪表盘",onPress:()=>l("system"),children:"系统设置"},"dashboard"),a.jsx(o.W,{startContent:a.jsx(E.Z,{size:16}),description:"管理用户账户",onPress:()=>l("users"),children:"用户管理"},"users"),a.jsx(o.W,{startContent:a.jsx(E.Z,{size:16}),description:"管理家庭信息和成员",onPress:()=>l("families"),children:"家庭管理"},"families"),a.jsx(o.W,{startContent:a.jsx(eg.Z,{size:16}),description:"管理收支分类",onPress:()=>l("categories"),children:"分类管理"},"categories"),a.jsx(o.W,{startContent:a.jsx(ey.Z,{size:16}),description:"查看系统日志",onPress:()=>l("logs"),children:"系统日志"},"logs"),a.jsx(o.W,{startContent:a.jsx(eN.Z,{size:16}),description:"备份与恢复数据",onPress:()=>l("backup"),children:"备份恢复"},"backup")]})]})};var ew=t(16),eC=t(44360),ez=t(70199),eS=t(48411),eZ=t(36341),ek=t(66732),eL=t(38854),eA=t(53503),eM=t(55794),e$=t(15766),e_=t(53565);function eF({date:e,setDate:s,placeholder:t="选择日期",className:n}){let[r,i]=(0,l.useState)(!1),d=(0,l.useRef)(null),o=e?(0,ed.WU)(e,"yyyy年MM月dd日",{locale:e$.U}):"",x=()=>{i(!1)};return(0,l.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),a.jsx("div",{className:n,ref:d,children:(0,a.jsxs)(ek.j,{placement:"bottom",isOpen:r,onOpenChange:i,children:[a.jsx(eL.b,{children:a.jsx(z.Y,{type:"text",label:"日期",placeholder:t,value:o,readOnly:!0,onClick:()=>i(!0),startContent:a.jsx(eM.Z,{size:16,className:"text-default-500"})})}),a.jsx(eA.g,{children:a.jsx(m.w,{className:"border-none",children:a.jsx(u.G,{className:"p-0",children:a.jsx(e_._,{mode:"single",selected:e,onSelect:e=>{e&&(s(e),x())},locale:e$.U,weekStartsOn:1,footer:a.jsx("div",{className:"mt-3 flex justify-end",children:a.jsx(c.A,{variant:"flat",size:"sm",onPress:x,children:"取消"})}),className:"p-3"})})})})]})})}t(12865);var eI=t(61561);let eP=({isOpen:e,onClose:s,onSuccess:t,transaction:n,type:r="expense",familyId:i})=>{let d=(0,l.useRef)({type:r,amount:0,date:new Date,note:"",categoryId:"",familyId:i||void 0}).current,o=(0,l.useCallback)(e=>{console.log(e.title)},[]),[x,m]=(0,l.useState)(!1),[u,h]=(0,l.useState)(d),{mutate:j}=(0,M.lr)(),{mutate:p}=(0,M.wI)();(0,l.useMemo)(()=>i,[i]);let{categories:f}=(0,eI.L)(),g=(0,l.useMemo)(()=>f?.filter(e=>e.type===u.type)||[],[f,u.type]),y=(0,l.useRef)(!1);(0,l.useEffect)(()=>{if(!e){y.current=!1;return}y.current||(n?h({type:n.type,amount:parseFloat(n.amount.toString()),date:Y()(n.date).toDate(),note:n.description||"",categoryId:n.category_id?.toString()||"",familyId:i||void 0}):h({type:r||"expense",amount:0,date:new Date,note:"",categoryId:"",familyId:i||void 0}),y.current=!0)},[e,n,r,i]);let S=(0,l.useCallback)((e,s)=>{h(t=>({...t,[e]:s}))},[]),Z=async()=>{try{if(m(!0),!u.amount||0>=parseFloat(u.amount.toString())){o({title:"请输入有效的金额",variant:"destructive"});return}if(!u.categoryId){o({title:"请选择分类",variant:"destructive"});return}let e={type:u.type,amount:Number(u.amount),category_id:Number(u.categoryId),date:"string"==typeof u.date?u.date:(0,ed.WU)(u.date,"yyyy-MM-dd"),description:u.note||"",family_id:u.familyId?Number(u.familyId):void 0};n?.id?(p({...n,...e}),o({title:"交易已更新",variant:"success"})):(j(e),o({title:"交易已创建",variant:"success"})),t(),s()}catch(e){console.error("交易保存失败",e),o({title:"保存失败",variant:"destructive"})}finally{m(!1)}},k=(0,l.useCallback)(e=>{switch(e){case"income":return"success";case"expense":return"danger";default:return"default"}},[]);return a.jsx(N.R,{isOpen:e,onClose:s,size:"md",children:a.jsx(v.A,{children:()=>(0,a.jsxs)(a.Fragment,{children:[a.jsx(b.k,{className:"flex flex-col gap-1",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[n?.id?"编辑交易":"新增交易",a.jsx(T.z,{color:k(u.type),variant:"flat",radius:"sm",size:"sm",children:"income"===u.type?"收入":"支出"})]})}),(0,a.jsxs)(w.I,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx(c.A,{className:`flex-1 ${"expense"===u.type?"bg-danger text-white":"bg-default-100"}`,onPress:()=>S("type","expense"),children:"支出"}),a.jsx(c.A,{className:`flex-1 ${"income"===u.type?"bg-success text-white":"bg-default-100"}`,onPress:()=>S("type","income"),children:"收入"})]}),a.jsx(z.Y,{type:"number",label:"金额",placeholder:"0.00",startContent:a.jsx(eS.Z,{size:16}),value:u.amount?.toString()||"",onChange:e=>S("amount",parseFloat(e.target.value)||0)}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("div",{className:"flex-1",children:a.jsx(eF,{date:u.date,setDate:e=>S("date",e)})})}),a.jsx(ew.g,{label:"分类",placeholder:"选择分类",selectedKeys:u.categoryId?[u.categoryId]:[],startContent:a.jsx(eZ.Z,{size:16}),onChange:e=>S("categoryId",e.target.value),children:g.map(e=>a.jsx(eC.R,{value:e.id.toString(),children:e.name},e.id.toString()))}),a.jsx(ez.Y,{label:"备注",placeholder:"添加备注信息",startContent:a.jsx(ey.Z,{size:16}),value:u.note||"",onChange:e=>S("note",e.target.value)})]}),(0,a.jsxs)(C.R,{children:[a.jsx(c.A,{variant:"flat",onPress:s,children:"取消"}),a.jsx(c.A,{color:"primary",onPress:Z,isLoading:x,children:"保存"})]})]})})})};var eD=t(41575),eE=t(22031),eO=t(12704);let eG=({transactions:e,isLoading:s=!1,isPersonalMode:t=!1})=>{let l=new Date,n=new Date(l.getFullYear(),l.getMonth(),1),r=e?.filter(e=>"expense"===e.type&&new Date(e.date)>=n&&new Date(e.date)<=l).reduce((e,s)=>e+s.amount,0)||0,i={};e?.filter(e=>"expense"===e.type&&new Date(e.date)>=n&&new Date(e.date)<=l).forEach(e=>{let s=e.category_name||`分类ID:${e.category_id}`||"未分类";i[s]=(i[s]||0)+e.amount});let c=Object.entries(i).sort(([,e],[,s])=>s-e).slice(0,3).map(([e,s])=>({name:e,amount:s,percentage:s/r*100})),d=c.length>1?c[0].percentage-c[1].percentage:null,o=e=>`\xa5${e.toFixed(2)}`,x=e=>0===e?"danger":1===e?"warning":"success";return(0,a.jsxs)(m.w,{className:"h-full border border-default-100",children:[(0,a.jsxs)(g.u,{className:"flex gap-3 items-center",children:[a.jsx("div",{className:"p-2 rounded-full bg-danger/10",children:a.jsx(es.Z,{size:20,className:"text-danger"})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[a.jsx("p",{className:"text-md font-semibold",children:t?"我的支出":"家庭支出"}),a.jsx("p",{className:"text-small text-default-500",children:"本月支出统计"})]})]}),a.jsx(u.G,{className:"py-2",children:s?a.jsx(y.c,{size:"sm"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx("p",{className:"text-3xl font-bold text-danger",children:o(r)}),null!==d&&(0,a.jsxs)(T.z,{size:"sm",variant:"flat",color:d>0?"danger":"success",className:"ml-2",startContent:d>0?a.jsx(eO.Z,{className:"h-3 w-3"}):a.jsx(_.Z,{className:"h-3 w-3"}),children:[Math.abs(d).toFixed(0),"%"]})]}),(0,a.jsxs)("p",{className:"text-sm text-default-500 mt-1 mb-3",children:[t?"较上月":"家庭总支出较上月",null!==d&&(0,a.jsxs)("span",{className:d>0?"text-danger":"text-success",children:[d>0?" 增加":" 减少",Math.abs(d).toFixed(0),"%"]})]}),a.jsx("div",{className:"space-y-3",children:c.map((e,s)=>(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("p",{className:"text-sm font-medium",children:e.name}),a.jsx("p",{className:"text-sm",children:o(e.amount)})]}),a.jsx(eE.W,{value:e.percentage,color:x(s),size:"sm",className:"h-1","aria-label":`${e.name}支出百分比`})]},s))})]})})]})};var eR=t(67925),eW=t(95269);let eY=({transactions:e=[],isLoading:s=!1,isPersonalMode:t=!1})=>{let{accounts:n,isLoading:r,error:i}=function(){let[e,s]=(0,l.useState)([]),[t,a]=(0,l.useState)(!0),[n,r]=(0,l.useState)(null),{user:i}=(0,Z.useAuth)(),c=(0,l.useRef)(!1);return(0,l.useEffect)(()=>{i&&(c.current=!1);let e=async()=>{if(!c.current||!n)try{a(!0);let e="/accounts";i?.currentFamilyId?e+=`?family_id=${i.currentFamilyId}`:i?.id&&(e+=`?user_id=${i.id}`);let t=await (0,$.Io)(e);s(t.data),r(null)}catch(e){console.error("获取账户失败",e),r(e),s([]),c.current=!0}finally{a(!1)}};i?e():(s([]),a(!1))},[i]),{accounts:e,isLoading:t,error:n}}(),d=(0,l.useMemo)(()=>e?.length?e.filter(e=>"income"===e.type).reduce((e,s)=>e+s.amount,0):0,[e]),o=(0,l.useMemo)(()=>e?.length?e.filter(e=>"expense"===e.type).reduce((e,s)=>e+s.amount,0):0,[e]),x=(0,l.useMemo)(()=>d-o,[d,o]),h=e=>new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY",minimumFractionDigits:2}).format(e);return(0,a.jsxs)(m.w,{className:"overflow-hidden h-full border border-default-100",children:[(0,a.jsxs)(g.u,{className:"flex gap-3 items-center",children:[a.jsx("div",{className:"p-2 rounded-full bg-primary/10",children:a.jsx(eR.Z,{size:20,className:"text-primary"})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[a.jsx("p",{className:"text-md font-semibold",children:t?"我的账户":"家庭账户"}),a.jsx("p",{className:"text-small text-default-500",children:"总览"})]})]}),a.jsx(u.G,{className:"py-2",children:s||r?a.jsx(y.c,{size:"sm"}):i?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center text-center p-4",children:[a.jsx(eW.Z,{className:"text-danger mb-2",size:24}),a.jsx("p",{className:"text-danger",children:"加载账户信息失败"}),a.jsx(c.A,{size:"sm",variant:"flat",color:"primary",startContent:a.jsx(D.Z,{size:16}),className:"mt-2",onPress:()=>{window.location.reload()},children:"重试"})]}):n?.length===0?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center text-center p-4",children:[a.jsx(eS.Z,{className:"text-primary/50 h-10 w-10 mb-2"}),a.jsx("p",{className:"font-medium mb-2",children:"尚未添加账户"}),a.jsx("p",{className:"text-sm text-default-500",children:"请在设置中添加您的账户"})]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("p",{className:"text-3xl font-bold text-primary",children:h(x)}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-default-500",children:"收入"}),a.jsx("p",{className:"text-xl font-semibold text-success",children:h(d)})]}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-default-500",children:"支出"}),a.jsx("p",{className:"text-xl font-semibold text-danger",children:h(o)})]})]})]})})]})},eT=async(e,s)=>{let t="";if(e){let s=new URLSearchParams;for(let[t,a]of Object.entries(e))s.append(t,a);t=`?${s.toString()}`}return s?.pageSize&&(t+=t?`&pageSize=${s.pageSize}`:`?pageSize=${s.pageSize}`),(await (0,$.Io)(`/transactions${t}`)).data};function eV(){let{user:e}=(0,Z.useAuth)(),{currentRoute:s}=(0,k.useRoute)(),[t,$]=(0,l.useState)("month"),[W,T]=(0,l.useState)(null),[V,B]=(0,l.useState)(!1),[H,K]=(0,l.useState)(!0),{showToast:q}=(0,eu.p)(),{families:U,currentFamily:X,setCurrentFamily:J,isLoading:Q}=(0,eh.cW)(),[es,ea]=(0,l.useState)(""),[el,en]=(0,l.useState)(!1),[er,ec]=(0,l.useState)("expense"),[ed,ep]=(0,l.useState)([]),[ef,eg]=(0,l.useState)(!0),ey=(0,M.A3)(),[eN,ev]=(0,l.useState)(!1),[ew,eC]=(0,l.useState)(1),[ez,eS]=(0,l.useState)(10),[eZ,ek]=(0,l.useState)([]),[eL,eA]=(0,l.useState)(1),[eM,e$]=(0,l.useState)(""),e_=n().useRef(!1);(0,l.useEffect)(()=>{let e=new Date().getHours();e<6?ea("夜深了"):e<12?ea("早上好"):e<14?ea("中午好"):e<18?ea("下午好"):ea("晚上好")},[]);let{data:eF,isLoading:eI}=(0,L.T)(t,H&&"number"==typeof e?.id?e.id:void 0,!H&&X?X.id:void 0),{data:eE,isLoading:eO}=(0,A.B)(t),eR=()=>{eq()};(0,l.useEffect)(()=>{e&&eR()},[H,X?.id]);let eW=(0,l.useCallback)(()=>{H||Q||U&&0!==U.length||(K(!0),e_.current||(q&&q("您还没有家庭，已自动切换到个人模式","warning"),e_.current=!0))},[H,U,Q,q]),[eV,eB]=(0,l.useState)(!0),[eH,eK]=(0,l.useState)(void 0);(0,l.useEffect)(()=>{let e=setTimeout(()=>{eB(!1),Q||U&&0!==U.length||K(!0)},1e3);return()=>clearTimeout(e)},[U,Q,K]),(0,l.useEffect)(()=>{e&&eq()},[e?.id,H,X?.id]);let eq=async()=>{if(e){eg(!0),console.log("开始加载交易数据...");try{let s={};H||!X?s.user_id=String(e.id):X&&(s.family_id=String(X.id)),console.log("查询参数:",s);let t=await eT(s);console.log("获取到的交易数据:",t),Array.isArray(t)?(ep(t),console.log("成功设置交易数据，数量:",t.length)):(console.error("返回的交易数据不是数组格式",t),ep([]))}catch(e){console.error("获取交易记录失败",e),ep([])}finally{eg(!1),console.log("加载状态已重置为false")}}},eU=e=>new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY",minimumFractionDigits:2}).format(e),eX=e=>Y()(e).format("YYYY-MM-DD"),eJ=e=>{eK(void 0),ec(e),en(!0)},eQ=e=>{let s=U?.find(s=>s.id===e);s&&(J(s),K(!1))},e0=e=>{eK(e),en(!0)},e1=async e=>{if(confirm("确定要删除这笔交易吗？"))try{await ey.mutateAsync(e),eq()}catch(e){console.error("删除交易失败",e)}};(0,l.useEffect)(()=>{console.log("RecentTransactions组件状态:",{isLoading:ef,transactionsCount:ed?.length||0,hasTransactions:Array.isArray(ed)&&ed.length>0})},[ed,ef]);let e2=async()=>{try{eg(!0);let s={};H?s.user_id=String(e?.id):X&&(s.family_id=String(X.id)),console.log("加载所有交易数据的查询参数:",s);let t=await eT(s,{pageSize:100});Array.isArray(t)?(ek(t),eA(Math.ceil(t.length/ez)),console.log("加载到的所有交易数据:",t.length)):(console.error("返回的所有交易数据不是数组格式",t),ek([]))}catch(e){console.error("获取所有交易记录失败",e),ek([])}finally{eg(!1)}},e4=(0,l.useCallback)(()=>{ev(!0)},[]);(0,l.useEffect)(()=>{eN&&e2()},[eN]);let e5=(0,l.useCallback)(()=>{let e=[...eZ];if(eM){let s=eM.toLowerCase();e=e.filter(e=>e.category_name&&e.category_name.toLowerCase().includes(s)||e.description&&e.description.toLowerCase().includes(s)||e.amount&&String(e.amount).includes(s))}let s=(ew-1)*ez;return e.slice(s,s+ez)},[eZ,eM,ew,ez]);(0,l.useEffect)(()=>{if(eN&&eZ.length>0){let e=[...eZ];if(eM){let s=eM.toLowerCase();e=e.filter(e=>e.category_name&&e.category_name.toLowerCase().includes(s)||e.description&&e.description.toLowerCase().includes(s)||e.amount&&String(e.amount).includes(s))}eA(Math.ceil(e.length/ez))}},[eZ,eM,ez,eN]);let e3=e=>{eC(e)};if((0,l.useEffect)(()=>{eW()},[eW,H]),(0,l.useEffect)(()=>{!Q&&U&&U.length>0&&(X||J(U[0]),K(!1))},[U,Q,X,J]),(0,l.useEffect)(()=>{!Q&&U&&U.length>0&&(e_.current=!1)},[U,Q]),eV)return a.jsx(ej.a_,{});let e6=(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(ej.TR,{variant:"default",showText:!1}),a.jsx("span",{children:"仪表盘"}),s?.name&&"仪表盘"!==s.name&&(0,a.jsxs)("span",{className:"text-base text-default-500",children:["/ ",s.name]})]}),e8=(0,a.jsxs)("span",{children:[e?`${es}，${e.username}`:"欢迎使用喵呜记账",H&&a.jsx("span",{className:"ml-2 text-primary font-medium",children:"(个人模式)"}),!H&&X&&(0,a.jsxs)("span",{className:"ml-2 text-success font-medium",children:["(",X.name,")"]})]}),e9=(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsxs)(r.F,{children:[a.jsx(i.S,{children:a.jsx(c.A,{color:"primary",variant:"shadow",className:"bg-gradient-to-r from-blue-500 to-blue-600 border-0",endContent:a.jsx(_.Z,{size:16}),startContent:a.jsx(F.Z,{size:18}),radius:"full",size:"md",children:"添加交易"})}),(0,a.jsxs)(d.a,{"aria-label":"交易操作",children:[a.jsx(o.W,{description:"记录新的支出",startContent:a.jsx(I.Z,{className:"text-danger",size:18}),onPress:()=>eJ("expense"),children:"添加支出"},"add-expense"),a.jsx(o.W,{description:"记录新的收入",startContent:a.jsx(P.Z,{className:"text-success",size:18}),onPress:()=>eJ("income"),children:"添加收入"},"add-income")]})]}),e?.role==="admin"&&a.jsx(eb,{variant:"shadow",className:"bg-gradient-to-r from-purple-500 to-purple-600 border-0"}),a.jsx(x.e,{content:"切换主题",children:(0,a.jsxs)(c.A,{isIconOnly:!0,variant:"light","aria-label":"切换主题",radius:"full",className:"bg-default-100",onPress:()=>{document.documentElement.classList.toggle("dark"),localStorage.setItem("theme",document.documentElement.classList.contains("dark")?"dark":"light")},children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",className:"hidden dark:block text-yellow-300",fill:"currentColor",children:a.jsx("path",{d:"M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z"})}),a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",className:"block dark:hidden text-blue-900",fill:"currentColor",children:a.jsx("path",{d:"M10 6C10 10.4183 13.5817 14 18 14C19.4386 14 20.7885 13.6203 21.9549 12.9556C21.4738 18.0175 17.1419 22 12 22C6.47715 22 2 17.5228 2 12C2 6.85808 5.98249 2.5262 11.0444 2.04506C10.3797 3.21152 10 4.56142 10 6ZM4 12C4 16.4183 7.58172 20 12 20C14.9654 20 17.5757 18.3788 18.9571 15.9546C18.6407 15.9848 18.3212 16 18 16C12.4772 16 8 11.5228 8 6C8 5.67879 8.01524 5.35933 8.04536 5.04293C5.62119 6.42426 4 9.03458 4 12Z"})})]})}),a.jsx(c.A,{isIconOnly:!0,variant:"light","aria-label":"刷新数据",onPress:eR,radius:"full",children:a.jsx(D.Z,{className:"h-4 w-4"})})]});return a.jsx(eD.Z,{title:e6,description:e8,actions:e9,backgroundVariant:"default",padding:"lg",children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx(m.w,{className:"bg-content1/70 backdrop-blur-sm",children:a.jsx(u.G,{className:"py-4",children:(0,a.jsxs)("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(h.i,{size:"sm",color:H?"secondary":"primary",isSelected:H,onValueChange:e=>{if(Q){q("家庭数据加载中，请稍候...","warning");return}if(!e&&(!U||0===U.length)){q("您还没有家庭，请先创建或加入一个家庭","warning");return}K(e),e||(e_.current=!1),!e&&U&&U.length>0&&!X&&J(U[0])},startContent:a.jsx(ex.Z,{className:"h-4 w-4"}),endContent:a.jsx(em.Z,{className:"h-4 w-4"})}),a.jsx("span",{className:"text-sm font-medium whitespace-nowrap",children:H?"个人数据":"家庭数据"})]}),!H&&U&&U.length>0&&(0,a.jsxs)(r.F,{children:[a.jsx(i.S,{children:a.jsx(c.A,{variant:"flat",size:"sm",startContent:a.jsx(E.Z,{size:16}),endContent:a.jsx(_.Z,{size:16}),color:"primary",children:X?.name||"选择家庭"})}),a.jsx(d.a,{"aria-label":"家庭选择",children:U.map(e=>a.jsx(o.W,{onPress:()=>eQ(e.id),startContent:a.jsx(j.h,{name:e.name.charAt(0),size:"sm",radius:"full",className:"mr-2 bg-primary/20"}),description:e.description,className:X?.id===e.id?"bg-primary/10":"",children:e.name},e.id))})]})]}),(0,a.jsxs)(p.n,{selectedKey:t,onSelectionChange:e=>$(e),classNames:{base:"max-w-fit",tabList:"gap-2 relative rounded-lg p-1 bg-default-100",tab:"max-w-fit px-3 h-8 data-[selected=true]:bg-primary data-[selected=true]:text-white",cursor:"w-full",tabContent:"group-data-[selected=true]:text-inherit"},size:"sm",children:[a.jsx(f.r,{title:"本月"},"month"),a.jsx(f.r,{title:"本季度"},"quarter"),a.jsx(f.r,{title:"本年"},"year")]})]})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(eY,{transactions:ed,isPersonalMode:H,isLoading:ef}),a.jsx(eG,{transactions:ed,isPersonalMode:H,isLoading:ef}),(0,a.jsxs)(m.w,{className:"overflow-hidden h-full border border-default-100",children:[(0,a.jsxs)(g.u,{className:"flex gap-3 items-center",children:[a.jsx("div",{className:"p-2 rounded-full bg-blue-500/10",children:a.jsx(O.Z,{size:20,className:"text-blue-500"})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[a.jsx("p",{className:"text-md font-semibold",children:H?"个人结余":"家庭结余"}),a.jsx("p",{className:"text-small text-default-500",children:H?"本月收支差额":"本月收支统计"})]})]}),a.jsx(u.G,{className:"py-2",children:eI?a.jsx(y.c,{size:"sm"}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("p",{className:"text-3xl font-bold text-blue-500",children:eU((eF?.total_income||0)-(eF?.total_expense||0))}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-default-500",children:"month"===t?"本月":"quarter"===t?"本季度":"今年"}),a.jsx("p",{className:"text-xl font-semibold text-blue-500",children:eU((eF?.total_income||0)-(eF?.total_expense||0))})]}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-default-500",children:H?"个人":`${X?.name||"家庭"}`}),a.jsx("p",{className:"text-xl font-semibold text-blue-500",children:eU((eF?.total_income||0)-(eF?.total_expense||0))})]})]})]})})]})]}),(0,a.jsxs)(ee.E.div,{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[a.jsx(et,{statistics:eF,isLoading:eI,timeRange:t}),(0,a.jsxs)(m.w,{className:"overflow-hidden border border-default-100",children:[(0,a.jsxs)(g.u,{className:"pb-0 pt-4 px-4 flex-col items-start",children:[a.jsx("h4",{className:"font-bold text-large",children:"支出分类占比"}),(0,a.jsxs)("p",{className:"text-tiny text-default-500",children:["month"===t?"本月":"quarter"===t?"本季度":"本年","支出分类比例"]})]}),a.jsx(u.G,{className:"py-5 h-80",children:a.jsx(ei,{data:eE?[{type:"expense",categories:eE.filter(e=>"expense"===e.type).map(e=>({id:e.id||0,name:e.name||"未分类",amount:e.amount||0,count:1,color:e.color}))}]:null,isLoading:eO})})]})]}),a.jsx(ee.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:(0,a.jsxs)(m.w,{className:"overflow-hidden border border-default-100",children:[(0,a.jsxs)(g.u,{className:"pb-0 pt-4 px-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-bold text-large",children:H?"我的最近交易":`${X?.name||"家庭"}最近交易`}),a.jsx("p",{className:"text-tiny text-default-500",children:"最近的5笔交易记录"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(c.A,{size:"sm",color:"default",variant:"light",onPress:eq,startContent:a.jsx(D.Z,{size:14}),children:"刷新"}),a.jsx(c.A,{size:"sm",color:"secondary",variant:"flat",onPress:e4,children:"查看全部"}),a.jsx(c.A,{size:"sm",color:"primary",variant:"flat",onPress:()=>{if(!H&&(!X||!U||0===U.length)){q("请先创建或加入一个家庭","error");return}en(!0)},startContent:a.jsx(F.Z,{size:14}),children:"添加交易"})]})]}),a.jsx(u.G,{children:a.jsx(eo,{transactions:ed,isLoading:ef,onEdit:e0,onDelete:e1,isPersonalMode:H,userId:e?.id,onViewMore:e4})})]})})]}),a.jsx(N.R,{isOpen:V,onOpenChange:B,children:a.jsx(v.A,{children:e=>(0,a.jsxs)(a.Fragment,{children:[a.jsx(b.k,{className:"flex flex-col gap-1",children:"交易详情"}),a.jsx(w.I,{children:W&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-default-500",children:"类型"}),a.jsx("span",{className:"income"===W.type?"text-success":"expense"===W.type?"text-danger":"text-warning",children:"income"===W.type?"收入":"expense"===W.type?"支出":"转账"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-default-500",children:"金额"}),a.jsx("span",{className:"font-semibold",children:eU(W.amount)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-default-500",children:"分类"}),a.jsx("span",{children:W.category_name||"未分类"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-default-500",children:"日期"}),a.jsx("span",{children:eX(W.date)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-default-500",children:"描述"}),a.jsx("span",{children:W.description||"无描述"})]})]})}),(0,a.jsxs)(C.R,{children:[a.jsx(c.A,{color:"danger",variant:"light",onPress:e,children:"关闭"}),a.jsx(c.A,{color:"primary",onPress:()=>{e(),W&&(eK(W),en(!0))},children:"编辑"})]})]})})}),a.jsx(N.R,{isOpen:eN,onOpenChange:ev,size:"4xl",scrollBehavior:"inside",children:a.jsx(v.A,{children:s=>(0,a.jsxs)(a.Fragment,{children:[a.jsx(b.k,{className:"flex flex-col gap-1",children:H?"我的所有交易记录":`${X?.name||"家庭"}交易记录`}),(0,a.jsxs)(w.I,{children:[a.jsx("div",{className:"mb-4",children:a.jsx(z.Y,{placeholder:"搜索交易记录...",value:eM,onChange:e=>e$(e.target.value),startContent:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-default-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),className:"w-full"})}),ef?a.jsx("div",{className:"flex justify-center py-10",children:a.jsx(y.c,{})}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"space-y-3",children:e5().map((t,l)=>a.jsx(m.w,{className:"bg-content1/50",children:a.jsx(u.G,{className:"p-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`p-2 rounded-full ${t?.type==="income"?"bg-success/10":"bg-danger/10"}`,children:t?.type==="income"?a.jsx(P.Z,{size:20,className:"text-success"}):a.jsx(I.Z,{size:20,className:"text-danger"})}),a.jsx("div",{className:"flex-grow",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium",children:t?.category_name||"未分类"}),(0,a.jsxs)("p",{className:"text-xs text-default-500",children:[eX(t?.date||new Date),!H&&t?.user_id&&(0,a.jsxs)("span",{className:`ml-2 ${Number(t?.user_id)===Number(e?.id)?"text-primary font-medium":"text-default-500"}`,children:[t?.user_id?`用户${t.user_id}`:"未知用户",Number(t?.user_id)===Number(e?.id)&&" (我)"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:`font-semibold ${t?.type==="income"?"text-success":"text-danger"}`,children:[t?.type==="income"?"+":"-",eU(t?.amount)]}),t?.description&&a.jsx("p",{className:"text-xs text-default-500",children:t?.description})]})]})}),(0,a.jsxs)("div",{className:"flex gap-1",children:[a.jsx(c.A,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>{s(),e0(t)},children:a.jsx(G.Z,{size:16})}),a.jsx(c.A,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>{t?.id&&e1(t.id)},className:"text-danger",children:a.jsx(R.Z,{size:16})})]})]})})},t?.id||`trans-${l}`))}),eL>1&&a.jsx("div",{className:"flex justify-center mt-4",children:a.jsx(S.g,{total:eL,initialPage:1,page:ew,onChange:e3})})]})]}),(0,a.jsxs)(C.R,{children:[a.jsx(c.A,{color:"danger",variant:"light",onPress:s,children:"关闭"}),a.jsx(c.A,{color:"primary",onPress:()=>{s(),en(!0)},children:"添加交易"})]})]})})}),a.jsx(eP,{isOpen:el,onClose:()=>en(!1),onSuccess:()=>{eR(),en(!1)},transaction:eH,type:er,familyId:!H&&X?X.id.toString():void 0})]})})}}};