exports.id=4037,exports.ids=[4037],exports.modules={24954:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,26840,23)),Promise.resolve().then(r.t.bind(r,38771,23)),Promise.resolve().then(r.t.bind(r,13225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,43982,23))},79534:(e,t,r)=>{Promise.resolve().then(r.bind(r,16414))},6396:(e,t,r)=>{Promise.resolve().then(r.bind(r,89023)),Promise.resolve().then(r.bind(r,73237)),Promise.resolve().then(r.bind(r,30853)),Promise.resolve().then(r.bind(r,12841)),Promise.resolve().then(r.bind(r,67180))},16414:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(95344),o=r(3729),n=r(56686),s=r(40237),l=r(44738);function c({error:e,reset:t}){return(0,o.useEffect)(()=>{console.error(e)},[e]),a.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:a.jsx(n.w,{className:"max-w-lg w-full",children:(0,a.jsxs)(s.G,{className:"text-center space-y-4",children:[a.jsx("h2",{className:"text-xl font-bold",children:"出错了"}),a.jsx("p",{className:"text-default-500",children:e.message||"发生了一些错误，请稍后再试。"}),(0,a.jsxs)("div",{className:"flex justify-center gap-2",children:[a.jsx(l.A,{color:"primary",onPress:()=>t(),children:"重试"}),a.jsx(l.A,{variant:"bordered",onPress:()=>window.location.href="/",children:"返回首页"})]})]})})})}},89023:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ToastProvider:()=>c,useToast:()=>l});var a=r(95344),o=r(3729),n=r(44669);let s=(0,o.createContext)(void 0);function l(){let e=(0,o.useContext)(s);if(!e)throw Error("useToast must be used within a ToastProvider");return e}function c({children:e}){return(0,a.jsxs)(s.Provider,{value:{showToast:(e,t="info")=>{let r={duration:3e3,style:{padding:"16px",borderRadius:"8px"}};switch(t){case"success":n.Am.success(e,r);break;case"error":n.Am.error(e,r);break;case"warning":(0,n.Am)(e,{...r,icon:"⚠️"});break;default:(0,n.Am)(e,{...r,icon:"ℹ️"})}}},children:[e,a.jsx(n.x7,{position:"top-center"})]})}},73237:(e,t,r)=>{"use strict";r.r(t),r.d(t,{UnauthorizedHandler:()=>l});var a=r(3729),o=r(30853),n=r(89023),s=r(96548);function l(){let{handleUnauthorized:e}=(0,o.useAuth)(),{showToast:t}=(0,n.useToast)();return(0,a.useEffect)(()=>{e&&((0,s.Hb)(e),console.log("已设置全局未授权处理函数")),t&&((0,s.hQ)(t),console.log("已设置全局Toast处理函数"))},[e,t]),null}},14485:(e,t,r)=>{"use strict";r.d(t,{AW:()=>n,Kz:()=>o,P8:()=>s});var a=r(61261);let o={[a.Yt.DASHBOARD]:{component:()=>Promise.all([r.e(3715),r.e(1529),r.e(7279),r.e(7721),r.e(7791),r.e(1327),r.e(9799),r.e(5261),r.e(3729),r.e(6536),r.e(6250),r.e(1271),r.e(7390),r.e(3751),r.e(8275),r.e(3367),r.e(5975),r.e(5019),r.e(4393),r.e(4564),r.e(492),r.e(2873),r.e(3442),r.e(29),r.e(9760),r.e(9710),r.e(4670),r.e(7001),r.e(7377)]).then(r.bind(r,87377)).then(e=>e.default),permission:a.wI.PRIVATE,layout:()=>Promise.all([r.e(3715),r.e(1529),r.e(5485)]).then(r.bind(r,65485)).then(e=>e.default)},[a.Yt.TRANSACTIONS]:{component:()=>Promise.all([r.e(3715),r.e(1529),r.e(7279),r.e(7721),r.e(1327),r.e(9799),r.e(5261),r.e(3729),r.e(6536),r.e(6250),r.e(7390),r.e(3367),r.e(4393),r.e(29),r.e(4670),r.e(1871)]).then(r.bind(r,60469)).then(e=>e.default),permission:a.wI.FAMILY,layout:()=>Promise.all([r.e(3715),r.e(1529),r.e(5917)]).then(r.bind(r,15917)).then(e=>e.default)},[a.Yt.STATISTICS]:{component:()=>Promise.all([r.e(3715),r.e(1529),r.e(7279),r.e(7721),r.e(7791),r.e(1327),r.e(9799),r.e(5261),r.e(3729),r.e(6536),r.e(6250),r.e(1271),r.e(7390),r.e(3751),r.e(8275),r.e(3367),r.e(5975),r.e(5019),r.e(4393),r.e(4564),r.e(4670),r.e(7001),r.e(9621)]).then(r.bind(r,29621)).then(e=>e.default),permission:a.wI.FAMILY,layout:()=>Promise.all([r.e(3715),r.e(1529),r.e(1564)]).then(r.bind(r,41564)).then(e=>e.default)},[a.Yt.SETTINGS]:{component:()=>r.e(4895).then(r.bind(r,64895)).then(e=>e.default),permission:a.wI.PRIVATE,layout:()=>Promise.all([r.e(3715),r.e(1529),r.e(7791),r.e(366)]).then(r.bind(r,70366)).then(e=>e.default)},[a.Yt.CUSTOM]:{component:()=>Promise.all([r.e(3715),r.e(1529),r.e(1168)]).then(r.bind(r,11168)).then(e=>e.default),permission:a.wI.PRIVATE,layout:()=>Promise.all([r.e(3715),r.e(1529),r.e(3)]).then(r.bind(r,30003)).then(e=>e.default)}};function n(e,t,r,n){switch(o[e],t){case a.wI.PUBLIC:return!0;case a.wI.PRIVATE:return!!r;case a.wI.FAMILY:case a.wI.ADMIN:return!!r&&!!n;default:return!1}}async function s(e,t){let r=o[t];if(!r)throw Error(`未找到路由类型 ${t} 对应的组件`);try{let e=await r.component(),t=r.layout?await r.layout():null;return{Component:e,Layout:t,permission:r.permission}}catch(e){throw console.error(`加载路由组件失败: ${e}`),e}}},30853:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AuthProvider:()=>w,useAuth:()=>g});var a=r(95344),o=r(3729),n=r(8428),s=r(89023),l=r(96548),c=r(19473),u=r(70903),i=r(61261),d=r(14485);let m=async e=>{let t=await (0,l.Io)("/auth/login",{method:"POST",body:JSON.stringify(e)});return console.log("ssss",t),t.data},h=async e=>(await (0,l.Io)("/auth/register",{method:"POST",body:JSON.stringify(e)})).data,f=async e=>(await (0,l.Io)("/auth/verify-guest",{method:"POST",body:JSON.stringify({password:e})})).data,p=async e=>(await (0,l.Io)("/user/settings",{method:"PATCH",body:JSON.stringify(e)})).data,y=(0,o.createContext)(void 0);function w({children:e}){let[t,r]=(0,o.useState)(null),[l,w]=(0,o.useState)(!1),[g,S]=(0,o.useState)(!1),b=(0,n.useRouter)(),{showToast:P}=(0,s.useToast)(),x=e=>{try{let t=(0,u.o)(e),r=Date.now()/1e3;if(t.exp&&t.exp<r)return(0,c.gy)(),localStorage.removeItem("isGuest"),null;return{id:t.id,username:t.username,email:t.email,role:t.role,privacy_mode:t.privacy_mode,default_route:t.default_route,permissions:t.permissions}}catch(e){return console.error("解析 token 失败:",e),(0,c.gy)(),localStorage.removeItem("isGuest"),null}},I=async e=>{if(!e||!e.default_route){b.push("/dashboard");return}try{let t=e.default_route,r=t.split("/")[1];if(!(0,d.AW)(r,i.wI.PRIVATE,"string"==typeof e.id?parseInt(e.id,10):e.id,e.currentFamilyId?"string"==typeof e.currentFamilyId?parseInt(e.currentFamilyId,10):e.currentFamilyId:void 0)){console.warn("用户无权访问默认路由，重定向到仪表盘"),b.push("/dashboard");return}await (0,d.P8)(t,r),b.push(t)}catch(e){console.error("路由导航失败:",e),b.push("/dashboard")}};(0,o.useEffect)(()=>{let e=(0,c.LP)(),t="true"===localStorage.getItem("isGuest"),a=window.location.pathname,o=a.startsWith("/auth/"),n="/"===a||"/about"===a;if(e){let a=x(e);a?(r(a),w(t),o&&I(a)):o||n||b.push("/auth/login")}else o||n||b.push("/auth/login")},[b]);let C=async(e,t)=>{try{let{token:a,user:o}=await m({email:e,password:t});(0,c.o4)(a),r(o),w(!1),localStorage.setItem("isGuest","false"),P("登录成功","success"),I(o)}catch(e){throw P("登录失败","error"),e}},k=async e=>{try{let{token:t,user:a}=await h(e);(0,c.o4)(t),r(a),w(!1),localStorage.setItem("isGuest","false"),P("注册成功","success"),I(a)}catch(e){throw P("注册失败","error"),e}},v=async e=>{try{await f(e),w(!0),localStorage.setItem("isGuest","true")}catch(e){throw e}},T=async e=>{try{let t=await p(e);return r(t),t}catch(e){throw e instanceof Error?P(e.message,"error"):P("更新设置失败","error"),e}};return a.jsx(y.Provider,{value:{user:t,isGuest:l,isLoading:g,setUser:r,updateUser:e=>{r(e)},updateSettings:T,login:C,register:k,logout:()=>{(0,c.gy)(),localStorage.removeItem("isGuest"),r(null),w(!1),b.push("/auth/login")},enterGuestMode:v,exitGuestMode:()=>{w(!1),localStorage.removeItem("isGuest")},handleUnauthorized:()=>{(0,c.gy)(),localStorage.removeItem("isGuest"),localStorage.removeItem("currentFamilyId"),r(null),w(!1),"/auth/login"!==window.location.pathname&&(P("登录已过期，请重新登录","error"),b.push("/auth/login"))}},children:e})}function g(){let e=(0,o.useContext)(y);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},12841:(e,t,r)=>{"use strict";r.r(t),r.d(t,{RouteProvider:()=>S,useRoute:()=>b});var a=r(95344),o=r(3729),n=r(8428),s=r(30853),l=r(61261),c=r(96548),u=r(63806),i=r(14485);let d={[l.Yt.DASHBOARD]:1,[l.Yt.TRANSACTIONS]:2,[l.Yt.STATISTICS]:3,[l.Yt.SETTINGS]:4,[l.Yt.CUSTOM]:5},m={maxConcurrent:2,interval:5e3,timeout:1e4};function h(){let e=(0,o.useRef)(new Set),t=(0,o.useRef)(new Set),r=(0,o.useCallback)(e=>d[e.type]||1/0,[]),a=(0,o.useCallback)(e=>[...e].sort((e,t)=>r(e)-r(t)),[r]),n=(0,o.useCallback)(async r=>{if(!(e.current.has(r.path)||t.current.has(r.path))){e.current.add(r.path);try{let e=i.Kz[r.type];if(!e)return;let a=new Promise((e,t)=>{setTimeout(()=>t(Error("预热超时")),m.timeout)}),o=Promise.all([e.component(),e.layout?e.layout():Promise.resolve(null)]);await Promise.race([o,a]),t.current.add(r.path)}catch(e){console.warn(`路由预热失败: ${r.path}`,e)}finally{e.current.delete(r.path)}}},[]),s=(0,o.useCallback)(async e=>{let t=a(e),r=[];for(let e=0;e<t.length;e+=m.maxConcurrent)r.push(t.slice(e,e+m.maxConcurrent));for(let e of r)await Promise.all(e.map(e=>n(e))),r.indexOf(e)<r.length-1&&await new Promise(e=>setTimeout(e,m.interval))},[n,a]),l=(0,o.useCallback)(e=>t.current.has(e),[]),c=(0,o.useCallback)(()=>({preheating:Array.from(e.current),preheated:Array.from(t.current)}),[]),u=(0,o.useCallback)(()=>{e.current.clear(),t.current.clear()},[]);return(0,o.useEffect)(()=>()=>{u()},[u]),{preheatRoute:n,preheatRoutes:s,isRoutePreheated:l,getPreheatStatus:c,clearPreheatCache:u,getRoutePriority:r,sortRoutesByPriority:a}}let f={maxSize:5242880,maxAge:18e5,minPriority:3},p="route_params";var y=r(34755);let w=(0,o.createContext)(void 0);function g({children:e}){let t=(0,n.useRouter)(),r=(0,n.usePathname)(),d=(0,n.useSearchParams)(),{user:m}=(0,s.useAuth)(),[g,S]=(0,o.useState)(),[b,P]=(0,o.useState)({}),[x,I]=(0,o.useState)([]),[C,k]=(0,o.useState)([]),[v,T]=(0,o.useState)(!1),[A,$]=(0,o.useState)(!1),{showToast:E}=(0,u.p)(),{getCachedRoute:O,cacheRoute:j,clearExpiredCache:R}=function(e={}){let{maxSize:t,maxAge:r,minPriority:a}={...f,...e},[n,s]=(0,o.useState)(new Map),{getRoutePriority:l}=h(),c=(0,o.useRef)(0),u=(0,o.useCallback)(e=>JSON.stringify(e).length,[]),i=(0,o.useCallback)(e=>Date.now()-e.lastAccessed>r,[r]),d=(0,o.useCallback)(e=>l(e)<=a,[l,a]),m=(0,o.useCallback)(e=>{let t=n.get(e);return t?i(t)?(n.delete(e),c.current-=t.size,s(new Map(n)),null):(t.lastAccessed=Date.now(),s(new Map(n)),t):null},[n,i]),p=(0,o.useCallback)(e=>{let r=Array.from(n.entries());if(Date.now(),r.forEach(([e,t])=>{i(t)&&(n.delete(e),c.current-=t.size)}),c.current+e>t)for(let[a,o]of r.filter(([e,t])=>!i(t)).sort((e,t)=>{let r=t[1].priority-e[1].priority;return 0!==r?r:e[1].lastAccessed-t[1].lastAccessed})){if(c.current+e<=t)break;n.delete(a),c.current-=o.size}s(new Map(n))},[n,i,t]);return{getCachedRoute:m,cacheRoute:(0,o.useCallback)(e=>{if(!d(e))return;let r=u(e),a=l(e);c.current+r>t&&p(r);let o={...e,lastAccessed:Date.now(),priority:a,size:r};n.set(e.path,o),c.current+=r,s(new Map(n))},[d,u,l,t,p,n]),clearExpiredCache:(0,o.useCallback)(()=>{let e=!1;n.forEach((t,r)=>{i(t)&&(n.delete(r),c.current-=t.size,e=!0)}),e&&s(new Map(n))},[n,i]),getCacheStats:(0,o.useCallback)(()=>({totalSize:c.current,itemCount:n.size,maxSize:t,usage:c.current/t*100}),[n,t])}}(),{preloadRoute:N,preloadRoutes:L}=function(){let e=(0,o.useCallback)(async e=>{try{let t=i.Kz[e.type];if(!t)return;let r=t.component(),a=t.layout?t.layout():Promise.resolve(null);await Promise.all([r,a])}catch(t){console.error(`预加载路由失败: ${e.path}`,t)}},[]),t=(0,o.useCallback)(async t=>{let r=t.map(t=>e(t));await Promise.allSettled(r)},[e]);return{preloadRoute:e,preloadRoutes:t,preloadRouteType:(0,o.useCallback)(async e=>{try{let t=i.Kz[e];if(!t)return;let r=t.component(),a=t.layout?t.layout():Promise.resolve(null);await Promise.all([r,a])}catch(t){console.error(`预加载路由类型失败: ${e}`,t)}},[])}}(),{addToHistory:D,goBack:M,goForward:z,getCurrentRoute:_,getHistorySummary:F}=function(){let[e,t]=(0,o.useState)([]),[r,a]=(0,o.useState)(-1),n=(0,o.useCallback)(e=>{t(t=>{if(t[r]?.path===e.path)return t;let o=t.slice(0,r+1);return o.push(e),o.length>20&&o.shift(),a(o.length-1),o})},[r]),s=(0,o.useCallback)(()=>r>0?(a(e=>e-1),e[r-1]):null,[e,r]),l=(0,o.useCallback)(()=>r<e.length-1?(a(e=>e+1),e[r+1]):null,[e,r]);return{addToHistory:n,goBack:s,goForward:l,getCurrentRoute:(0,o.useCallback)(()=>e[r]||null,[e,r]),clearHistory:(0,o.useCallback)(()=>{t([]),a(-1)},[]),getHistorySummary:(0,o.useCallback)(()=>({canGoBack:r>0,canGoForward:r<e.length-1,historyLength:e.length,currentIndex:r}),[e.length,r])}}(),{startRouteLoad:H,endRouteLoad:U,getPerformanceReport:G,clearPerformanceData:J}=function(){let[e,t]=(0,o.useState)({}),r=(0,o.useCallback)(e=>performance.now(),[]);return{startRouteLoad:r,endRouteLoad:(0,o.useCallback)((e,r,a,o,n=!1)=>{let s=o?performance.now()-o:0;t(t=>{let a=t[e]||{accessCount:0,errorCount:0,totalLoadTime:0,averageLoadTime:0,lastAccessed:new Date().toISOString()},o={...a,accessCount:a.accessCount+1,errorCount:r?a.errorCount:a.errorCount+1,totalLoadTime:a.totalLoadTime+(n?0:s),averageLoadTime:n?a.averageLoadTime:(a.totalLoadTime+s)/(a.accessCount+1),lastAccessed:new Date().toISOString()};return{...t,[e]:o}})},[]),getPerformanceReport:(0,o.useCallback)(()=>{let t=Object.keys(e);if(0===t.length)return{totalRoutes:0,totalAccesses:0,totalErrors:0,averageLoadTime:0,mostAccessed:null,mostErrors:null,routeStats:{}};let r=0,a=0,o=0,n=t[0],s=t[0];return t.forEach(t=>{let l=e[t];r+=l.accessCount,a+=l.errorCount,o+=l.totalLoadTime,l.accessCount>e[n].accessCount&&(n=t),l.errorCount>e[s].errorCount&&(s=t)}),{totalRoutes:t.length,totalAccesses:r,totalErrors:a,averageLoadTime:o/r,mostAccessed:{path:n,...e[n]},mostErrors:{path:s,...e[s]},routeStats:e}},[e]),clearPerformanceData:(0,o.useCallback)(()=>{t({})},[])}}(),{preheatRoute:Y,preheatRoutes:B,isRoutePreheated:W,getPreheatStatus:V,getRoutePriority:K}=h(),{saveParams:q,getParams:Q,clearParams:X}=function(){let[e,t]=(0,o.useState)({});(0,o.useEffect)(()=>{try{let e=localStorage.getItem(p);e&&t(JSON.parse(e))}catch(e){console.error("Failed to load route params:",e)}},[]);let r=(0,o.useCallback)(e=>{try{localStorage.setItem(p,JSON.stringify(e))}catch(e){console.error("Failed to save route params:",e)}},[]);return{saveParams:(0,o.useCallback)((e,a)=>{t(t=>{let o={...t,[e]:a};return r(o),o})},[r]),getParams:(0,o.useCallback)(t=>e[t],[e]),clearParams:(0,o.useCallback)(e=>{e?t(t=>{let{[e]:a,...o}=t;return r(o),o}):(t({}),localStorage.removeItem(p))},[r])}}(),Z=(0,o.useCallback)(()=>{let e={};return d.forEach((t,r)=>{"page"===r||"limit"===r?e[r]=parseInt(t):e[r]=t}),e},[d]),ee=e=>{let t=new URLSearchParams;return Object.entries(e).forEach(([e,r])=>{null!=r&&t.append(e,String(r))}),t.toString()},et=(0,o.useCallback)(e=>!g?.validateParams||g.validateParams(e),[g]),er=(0,o.useCallback)(e=>{let a={...b,...e};if(et(a)){let e=ee(a);t.push(`${r}${e?`?${e}`:""}`),P(a),r&&q(r,a)}},[b,r,t,et,q]);(0,o.useEffect)(()=>{let e=Z();if(Object.keys(e).length>0)P(e),r&&q(r,e);else if(r){let e=Q(r);e&&Object.keys(e).length>0&&er(e)}},[r,Z,Q,q,er]);let ea=(0,o.useCallback)(()=>{r&&(X(r),P({}),t.push(r))},[r,t,X]),eo=(0,o.useCallback)(async()=>{if(m){T(!0);try{let e=await (0,c.Io)("/routes/user/routes");I(e.data)}catch(e){console.error("获取用户路由失败:",e)}finally{T(!1)}}},[m]),en=(0,o.useCallback)(async e=>{if(m){$(!0);try{let t=await (0,c.Io)(`/routes/family/${e}/routes`);k(t.data)}catch(e){console.error("获取家庭路由失败:",e)}finally{$(!1)}}},[m]);(0,o.useEffect)(()=>{m&&eo()},[m,eo]),(0,o.useEffect)(()=>{m?.currentFamilyId&&en(m.currentFamilyId)},[m?.currentFamilyId,en]);let es=(0,o.useCallback)(async e=>{if(m)try{let t=await (0,c.Io)("/api/routes",{method:"POST",body:JSON.stringify(e)});return e.family_id?en(e.family_id):eo(),E("路由创建成功","success"),t.data.id}catch(e){console.error("创建路由失败:",e),E("创建路由失败","error")}},[m,en,eo,E]),el=(0,o.useCallback)(async({id:e,data:t})=>{if(m)try{await (0,c.Io)(`/api/routes/${e}`,{method:"PUT",body:JSON.stringify(t)}),eo(),m.currentFamilyId&&en(m.currentFamilyId)}catch(e){throw console.error("更新路由失败:",e),e}},[m,eo,en]),ec=(0,o.useCallback)(async e=>{if(m)try{await (0,c.Io)(`/api/routes/${e}`,{method:"DELETE"}),eo(),m.currentFamilyId&&en(m.currentFamilyId)}catch(e){throw console.error("删除路由失败:",e),e}},[m,eo,en]),eu=(0,o.useCallback)(()=>[{key:l.wI.PUBLIC,label:"公开"},{key:l.wI.PRIVATE,label:"私有"},{key:l.wI.FAMILY,label:"家庭"},{key:l.wI.ADMIN,label:"管理员"}],[]),ei=e=>(0,i.AW)(e.type,e.permission,m?.id,m?.currentFamilyId);(0,o.useEffect)(()=>{g&&B([...x,...C].filter(e=>e.type===g.type&&(!g.id||e.id!==g.id)))},[g,x,C,B]);let ed=(0,o.useCallback)(async(e,r)=>{let a=[...x,...C].find(t=>t.path===e);if(a&&!ei(a)){y.Am.error("无权访问该路由");return}try{let o=H(e),n=O(e);if(n){S(n),D(n),t.push(`${e}${r?ee(r):""}`),r&&P(r),U(e,!0,void 0,o,!0);return}if(W(e)){a&&(j(a),S(a),D(a)),t.push(`${e}${r?ee(r):""}`),r&&P(r),U(e,!0,void 0,o,!1);return}t.push(`${e}${r?ee(r):""}`),r&&P(r),a&&(await Y(a),j(a),S(a),D(a)),U(e,!0,void 0,o,!1)}catch(t){console.error("导航失败:",t),U(e,!1,t),y.Am.error("导航失败")}},[t,x,C,ei,H,U,O,W,Y,j,D,ee]),em=(0,o.useCallback)(async()=>{let e=M();e&&await ed(e.path,e.params||{})},[M,ed]),eh=(0,o.useCallback)(async()=>{let e=z();e&&await ed(e.path,e.params||{})},[z,ed]);(0,o.useEffect)(()=>{let e=setInterval(R,6e4);return()=>clearInterval(e)},[R]);let ef=(0,o.useCallback)(()=>{let e=G(),{preheated:t,preheating:r}=V();return{...e,cacheHitRate:0,preheatingStatus:{total:r.length+t.length,completed:t.length}}},[G,V]);return a.jsx(w.Provider,{value:{currentRoute:g,params:b,userRoutes:x,familyRoutes:C,isLoadingUserRoutes:v,isLoadingFamilyRoutes:A,fetchUserRoutes:eo,fetchFamilyRoutes:en,createRoute:es,updateRoute:el,deleteRoute:ec,getPermissionOptions:eu,navigateToRoute:ed,checkAccess:ei,handleGoBack:em,handleGoForward:eh,getHistorySummary:F,getPerformanceReport:ef,getCacheStats:()=>({totalSize:0,itemCount:0,maxSize:0,usage:0}),getPreheatStatus:V,updateParams:er,validateParams:et,clearPerformanceData:J,resetParams:ea},children:e})}function S({children:e}){return a.jsx(o.Suspense,{fallback:a.jsx("div",{children:"Loading routes..."}),children:a.jsx(g,{children:e})})}function b(){let e=(0,o.useContext)(w);if(!e)throw Error("useRoute must be used within a RouteProvider");return e}},63806:(e,t,r)=>{"use strict";r.d(t,{p:()=>o});var a=r(44669);function o(){return{showToast:(e,t="info")=>{let r={duration:3e3,style:{padding:"16px",borderRadius:"8px"}};switch(t){case"success":a.Am.success(e,r);break;case"error":a.Am.error(e,r);break;case"warning":(0,a.Am)(e,{...r,icon:"⚠️"});break;default:(0,a.Am)(e,{...r,icon:"ℹ️"})}}}}},96548:(e,t,r)=>{"use strict";r.d(t,{AW:()=>T,Cp:()=>j,Ds:()=>f,HL:()=>g,Hb:()=>c,Io:()=>m,KX:()=>y,M$:()=>R,Ml:()=>E,Nq:()=>A,Ny:()=>S,P9:()=>b,R5:()=>O,_c:()=>P,dx:()=>p,fM:()=>v,fq:()=>I,h8:()=>$,hQ:()=>u,le:()=>w,ot:()=>x,qW:()=>C,rr:()=>k,we:()=>h});var a=r(61261),o=r(19473);let n=process.env.NEXT_PUBLIC_API_URL||"http://localhost:3001/api",s=null,l=null;function c(e){s=e}function u(e){l=e}function i(e,t="error"){l?l(e,t):console["error"===t?"error":"warning"===t?"warn":"log"](e)}let d={400:e=>{console.warn(`请求参数错误: ${e}`),i(`请求参数错误: ${e}`,"warning")},401:e=>{(0,o.gy)(),localStorage.removeItem("isGuest"),localStorage.removeItem("currentFamilyId"),s?s():"/auth/login"!==window.location.pathname&&(i("登录已过期，请重新登录"+window.location.pathname,"error"),window.location.href="/auth/login")},403:e=>{console.warn(`无权访问: ${e}`),i(`无权访问: ${e}`,"error")},404:e=>{console.warn(`资源不存在: ${e}`),i(`资源不存在: ${e}`,"warning")},422:e=>{console.warn(`数据验证失败: ${e}`),i(`数据验证失败: ${e}`,"warning")},429:e=>{console.warn(`请求过多，请稍后再试: ${e}`),i("请求过多，请稍后再试","warning")},500:e=>{console.error(`服务器错误: ${e}`),i(`服务器内部错误，请稍后再试: ${e}`,"error")},502:e=>{console.error(`网关错误: ${e}`),i("服务器网关错误，请稍后再试","error")},503:e=>{console.error(`服务不可用: ${e}`),i("服务暂时不可用，请稍后再试","error")},504:e=>{console.error(`网关超时: ${e}`),i("请求超时，请检查网络连接后重试","error")}};async function m(e,t={}){let r=`${n}${e}`,s=(0,o.LP)(),l={"Content-Type":"application/json",...s?{Authorization:`Bearer ${s}`}:{}};try{let e=await fetch(r,{...t,headers:{...l,...t.headers}}),o=await e.json();if(console.log("sssssss",o),!e.ok){let t=d[e.status];throw t&&t(o.message||"请求失败"),new a.Hx(e.status,o.message||"请求失败")}return{data:o,message:o.message,status:e.status}}catch(e){if(e instanceof a.Hx)throw e;throw new a.Hx(500,e instanceof Error?e.message:"网络错误")}}let h=(e,t="请求失败")=>{if(e instanceof a.Hx)switch(e.status){case 400:return`请求参数错误: ${e.message}`;case 403:return`无权访问: ${e.message}`;case 404:return`资源不存在: ${e.message}`;case 429:return"请求过于频繁，请稍后再试";case 500:case 502:case 503:return`服务器错误: ${e.message}`;default:return e.message||t}return e?.message||t};async function f(e){return(await m(`/routes/predictions?user_id=${e}`,{method:"GET"})).data}async function p(e){return(await m(`/routes/${e}/optimization`,{method:"GET"})).data}async function y(e){let t=new URLSearchParams;e.startDate&&t.append("startDate",e.startDate),e.endDate&&t.append("endDate",e.endDate),e.routeIds&&e.routeIds.length>0&&e.routeIds.forEach(e=>t.append("routeIds[]",e.toString()));let r=`${n}/routes/export?${t.toString()}&format=${e.format}`,s=(0,o.LP)(),l=await fetch(r,{method:"GET",headers:{...s?{Authorization:`Bearer ${s}`}:{}}});if(!l.ok){let e=await l.json();throw new a.Hx(l.status,e.message||"导出失败")}return await l.blob()}async function w(e){let t=new URLSearchParams;return t.append("type",e.type),e.startDate&&t.append("startDate",e.startDate),e.endDate&&t.append("endDate",e.endDate),e.routeIds&&e.routeIds.length>0&&e.routeIds.forEach(e=>t.append("routeIds[]",e.toString())),(await m(`/routes/visualization?${t.toString()}`,{method:"GET"})).data}async function g(e){return m("/categories",{method:"POST",body:JSON.stringify(e)})}async function S(e,t){return m(`/categories/${e}`,{method:"PUT",body:JSON.stringify(t)})}async function b(e){return m(`/categories/${e}`,{method:"DELETE"})}async function P(){return m("/routes")}async function x(e){return m("/routes",{method:"POST",body:JSON.stringify(e)})}async function I(e,t){return m(`/routes/${e}`,{method:"PUT",body:JSON.stringify(t)})}async function C(e){return m(`/routes/${e}`,{method:"DELETE"})}async function k(e){return m(`/routes/${e}/toggle`,{method:"POST"})}async function v(e){return m(`/routes/${e}/stats`)}async function T(){return m("/users")}async function A(e,t){return m(`/users/${e}`,{method:"PUT",body:JSON.stringify(t)})}async function $(e){return m(`/users/${e}`,{method:"DELETE"})}async function E(e){return m(`/users/${e}/freeze`,{method:"POST"})}async function O(e){return m(`/users/${e}/unfreeze`,{method:"POST"})}async function j(e){return m("/auth/change-password",{method:"POST",body:JSON.stringify(e)})}async function R(e){return m("/users/privacy",{method:"PUT",body:JSON.stringify(e)})}},61261:(e,t,r)=>{"use strict";var a,o;r.d(t,{Hx:()=>n,Yt:()=>a,wI:()=>o});class n extends Error{constructor(e,t){super(t),this.status=e,this.name="APIError"}}(function(e){e.DASHBOARD="dashboard",e.TRANSACTIONS="transactions",e.STATISTICS="statistics",e.SETTINGS="settings",e.CUSTOM="custom"})(a||(a={})),function(e){e.PUBLIC="public",e.PRIVATE="private",e.FAMILY="family",e.ADMIN="admin"}(o||(o={}))},67180:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Providers:()=>i});var a=r(95344),o=r(60324),n=r(88503),s=r(26274),l=r(55849),c=r(99558),u=r(3729);function i({children:e}){let[t]=(0,u.useState)(()=>new n.S({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}}));return(0,a.jsxs)(s.aH,{client:t,children:[a.jsx(c.f,{attribute:"class",defaultTheme:"dark",children:a.jsx(o.w,{children:e})}),a.jsx(l.t,{initialIsOpen:!1})]})}},19473:(e,t,r)=>{"use strict";function a(){return localStorage.getItem("token")}function o(e){localStorage.setItem("token",e)}function n(){localStorage.removeItem("token")}r.d(t,{LP:()=>a,gy:()=>n,o4:()=>o})},24117:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>o,default:()=>s});let a=(0,r(86843).createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/error.tsx`),{__esModule:o,$$typeof:n}=a,s=a.default},66053:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>$,metadata:()=>T,viewport:()=>A});var a=r(25036),o=r(42195),n=r.n(o);r(5023);var s=r(86843);let l=(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/providers/index.tsx`),{__esModule:c,$$typeof:u}=l;l.default;let i=(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/providers/index.tsx#Providers`),d=(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/hooks/useAuth.tsx`),{__esModule:m,$$typeof:h}=d;d.default;let f=(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/hooks/useAuth.tsx#AuthProvider`);(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/hooks/useAuth.tsx#useAuth`);let p=(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/components/Toast.tsx`),{__esModule:y,$$typeof:w}=p;p.default,(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/components/Toast.tsx#useToast`);let g=(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/components/Toast.tsx#ToastProvider`),S=(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/hooks/useRoute.tsx`),{__esModule:b,$$typeof:P}=S;S.default;let x=(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/hooks/useRoute.tsx#RouteProvider`);(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/hooks/useRoute.tsx#useRoute`);let I=(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/components/UnauthorizedHandler.tsx`),{__esModule:C,$$typeof:k}=I;I.default;let v=(0,s.createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/components/UnauthorizedHandler.tsx#UnauthorizedHandler`),T={title:"喵呜记账",description:"一个简单易用的个人记账应用",manifest:"/manifest.json",icons:{apple:[{url:"/icons/icon-192x192.png"},{url:"/icons/icon-512x512.png"}]},appleWebApp:{capable:!0,statusBarStyle:"default",title:"喵呜记账"}},A={themeColor:"#000000",width:"device-width",initialScale:1,maximumScale:1,userScalable:!1};function $({children:e}){return(0,a.jsxs)("html",{lang:"zh-CN",suppressHydrationWarning:!0,className:"dark",children:[(0,a.jsxs)("head",{children:[a.jsx("link",{rel:"apple-touch-icon",href:"/icons/icon-192x192.png"}),a.jsx("meta",{name:"apple-mobile-web-app-capable",content:"yes"}),a.jsx("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"}),a.jsx("meta",{name:"format-detection",content:"telephone=no"}),a.jsx("meta",{name:"mobile-web-app-capable",content:"yes"}),a.jsx("meta",{name:"msapplication-tap-highlight",content:"no"}),a.jsx("meta",{name:"theme-color",content:"#000000"})]}),a.jsx("body",{className:n().className,suppressHydrationWarning:!0,children:a.jsx(i,{children:a.jsx(g,{children:a.jsx(f,{children:(0,a.jsxs)(x,{children:[a.jsx(v,{}),e]})})})})})]})}},5023:()=>{}};