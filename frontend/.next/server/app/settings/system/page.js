(()=>{var e={};e.id=8953,e.ids=[8953],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},86794:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>r.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>h,tree:()=>c});var a=s(50482),i=s(69108),n=s(62563),r=s.n(n),l=s(68300),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["settings",{children:["system",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,80275)),"/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/settings/system/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,37384)),"/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/settings/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,66053)),"/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,24117)),"/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}],d=["/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/settings/system/page.tsx"],m="/settings/system/page",x={require:s,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/settings/system/page",pathname:"/settings/system",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},27661:(e,t,s)=>{Promise.resolve().then(s.bind(s,70366))},4332:(e,t,s)=>{Promise.resolve().then(s.bind(s,9453))},31498:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(97075).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},70366:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var a=s(95344);s(3729);var i=s(8428),n=s(56506),r=s(56686),l=s(2273),o=s(89895),c=s(54052),d=s(99046),m=s(37121),x=s(23485),h=s(13746),u=s(91529),g=s(41575);let p=[{name:"系统设置",href:"/settings/system",icon:a.jsx(l.Z,{size:20})},{name:"用户管理",href:"/settings/users",icon:a.jsx(o.Z,{size:20})},{name:"家庭管理",href:"/settings/family",icon:a.jsx(c.Z,{size:20})},{name:"分类管理",href:"/settings/category",icon:a.jsx(d.Z,{size:20})},{name:"系统日志",href:"/settings/logs",icon:a.jsx(m.Z,{size:20})},{name:"备份恢复",href:"/settings/backup",icon:a.jsx(x.Z,{size:20})}];function f({children:e}){let t=(0,i.usePathname)();return a.jsx(g.Z,{title:"系统后台管理",description:"配置平台参数、管理成员与权限，保持系统稳定运行。",backgroundVariant:"minimal",contentClassName:"py-8",children:(0,a.jsxs)("div",{className:"flex flex-col gap-6 lg:flex-row",children:[(0,a.jsxs)(r.w,{className:"w-full max-w-sm shrink-0 border border-default-100 bg-background/70 backdrop-blur",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 p-4 mb-1",children:[a.jsx(u.E.div,{animate:{rotate:[0,15,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:a.jsx(h.Z,{size:24,className:"text-primary"})}),a.jsx("h2",{className:"text-lg font-semibold",children:"管理导航"})]}),a.jsx("nav",{className:"space-y-1 p-2",children:p.map(e=>{let s=t===e.href;return(0,a.jsxs)(n.default,{href:e.href,className:`flex items-center gap-3 rounded-lg px-4 py-3 text-sm font-medium transition-colors ${s?"bg-primary text-primary-foreground shadow-md":"hover:bg-default-100"}`,children:[e.icon,a.jsx("span",{children:e.name})]},e.href)})})]}),a.jsx(r.w,{className:"flex-1 border border-default-100 bg-background/70 p-6 backdrop-blur",children:e})]})})}},9453:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>S});var a=s(95344),i=s(3729),n=s.n(i),r=s(84752),l=s(44738),o=s(56686),c=s(87055),d=s(40237),m=s(41931),x=s(16),h=s(44360),u=s(3635),g=s(4521),p=s(31498),f=s(13746),j=s(97075);let y=(0,j.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),v=(0,j.Z)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),b=(0,j.Z)("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);var N=s(23485),w=s(81271),z=s(31296),M=s(34755),k=s(29709);let P=k.z.object({siteName:k.z.string().min(1,"站点名称不能为空").max(50,"站点名称不能超过50个字符"),siteDescription:k.z.string().max(200,"站点描述不能超过200个字符"),adminEmail:k.z.string().email("请输入有效的邮箱地址"),language:k.z.string(),timezone:k.z.string(),enableRegistration:k.z.boolean(),enableEmailNotification:k.z.boolean(),enableSMSNotification:k.z.boolean(),maxLoginAttempts:k.z.number().min(1,"最小值为1").max(10,"最大值为10"),sessionTimeout:k.z.number().min(5,"最小值为5分钟").max(1440,"最大值为24小时"),maintenanceMode:k.z.boolean()});function S(){let[e,t]=n().useState({siteName:"喵呜记账",siteDescription:"简单易用的个人和家庭记账系统",adminEmail:"admin@example.com",language:"zh-CN",timezone:"Asia/Shanghai",enableRegistration:!0,enableEmailNotification:!0,enableSMSNotification:!1,maxLoginAttempts:5,sessionTimeout:30,maintenanceMode:!1}),[s,i]=n().useState({}),{isLoading:j}=(0,w.a)({queryKey:["systemSettings"],queryFn:async()=>{try{let e=await fetch("/api/settings/system",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!e.ok)throw Error("获取系统设置失败");return await e.json()}catch(e){throw M.Am.error("获取系统设置失败"),e}}}),{mutate:S,isPending:E}=(0,z.D)({mutationFn:async e=>{let t=await fetch("/api/settings/system",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"保存系统设置失败");return await t.json()},onSuccess:()=>{M.Am.success("设置保存成功")},onError:e=>{M.Am.error(`设置保存失败: ${e.message}`)}}),C=async()=>{try{let t=P.parse(e);i({}),S(t)}catch(e){if(e instanceof k.z.ZodError){let t={};e.errors.forEach(e=>{e.path[0]&&(t[e.path[0]]=e.message)}),i(t),M.Am.error("请检查输入内容")}}},T=(e,a)=>{t(t=>({...t,[e]:a})),s[e]&&i(t=>({...t,[e]:void 0}))};return j?a.jsx("div",{className:"flex justify-center items-center h-[50vh]",children:a.jsx(r.c,{size:"lg",label:"加载中..."})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"系统设置"}),a.jsx(l.A,{color:"primary",variant:"shadow",onPress:C,isLoading:E,startContent:a.jsx(p.Z,{size:16}),children:"保存更改"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)(o.w,{className:"p-4",children:[(0,a.jsxs)(c.u,{className:"flex gap-3",children:[a.jsx(f.Z,{size:24,className:"text-primary"}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-xl font-bold",children:"基本设置"}),a.jsx("p",{className:"text-sm text-default-500",children:"配置系统的基本信息"})]})]}),(0,a.jsxs)(d.G,{className:"space-y-4",children:[a.jsx(m.Y,{label:"站点名称",value:e.siteName,onChange:e=>T("siteName",e.target.value),errorMessage:s.siteName,isInvalid:!!s.siteName}),a.jsx(m.Y,{label:"站点描述",value:e.siteDescription,onChange:e=>T("siteDescription",e.target.value),errorMessage:s.siteDescription,isInvalid:!!s.siteDescription}),a.jsx(m.Y,{label:"管理员邮箱",value:e.adminEmail,onChange:e=>T("adminEmail",e.target.value),errorMessage:s.adminEmail,isInvalid:!!s.adminEmail,startContent:a.jsx(y,{size:16})})]})]}),(0,a.jsxs)(o.w,{className:"p-4",children:[(0,a.jsxs)(c.u,{className:"flex gap-3",children:[a.jsx(v,{size:24,className:"text-primary"}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-xl font-bold",children:"本地化设置"}),a.jsx("p",{className:"text-sm text-default-500",children:"配置系统的语言和时区"})]})]}),(0,a.jsxs)(d.G,{className:"space-y-4",children:[a.jsx(x.g,{label:"系统语言",selectedKeys:[e.language],onChange:e=>T("language",e.target.value),errorMessage:s.language,isInvalid:!!s.language,children:[{label:"简体中文",value:"zh-CN"},{label:"繁體中文",value:"zh-TW"},{label:"English",value:"en-US"}].map(e=>a.jsx(h.R,{value:e.value,children:e.label},e.value))}),a.jsx(x.g,{label:"系统时区",selectedKeys:[e.timezone],onChange:e=>T("timezone",e.target.value),errorMessage:s.timezone,isInvalid:!!s.timezone,children:[{label:"北京时间 (UTC+8)",value:"Asia/Shanghai"},{label:"东京时间 (UTC+9)",value:"Asia/Tokyo"},{label:"纽约时间 (UTC-5)",value:"America/New_York"}].map(e=>a.jsx(h.R,{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)(o.w,{className:"p-4",children:[(0,a.jsxs)(c.u,{className:"flex gap-3",children:[a.jsx(b,{size:24,className:"text-primary"}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-xl font-bold",children:"通知设置"}),a.jsx("p",{className:"text-sm text-default-500",children:"配置系统的通知方式"})]})]}),(0,a.jsxs)(d.G,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"邮件通知"}),a.jsx("p",{className:"text-xs text-default-500",children:"启用系统邮件通知功能"})]}),a.jsx(u.i,{isSelected:e.enableEmailNotification,onValueChange:e=>T("enableEmailNotification",e)})]}),a.jsx(g.j,{}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"短信通知"}),a.jsx("p",{className:"text-xs text-default-500",children:"启用系统短信通知功能"})]}),a.jsx(u.i,{isSelected:e.enableSMSNotification,onValueChange:e=>T("enableSMSNotification",e)})]})]})]}),(0,a.jsxs)(o.w,{className:"p-4",children:[(0,a.jsxs)(c.u,{className:"flex gap-3",children:[a.jsx(N.Z,{size:24,className:"text-primary"}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-xl font-bold",children:"安全设置"}),a.jsx("p",{className:"text-sm text-default-500",children:"配置系统的安全相关选项"})]})]}),(0,a.jsxs)(d.G,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"开放注册"}),a.jsx("p",{className:"text-xs text-default-500",children:"允许新用户注册账号"})]}),a.jsx(u.i,{isSelected:e.enableRegistration,onValueChange:e=>T("enableRegistration",e)})]}),a.jsx(g.j,{}),a.jsx(m.Y,{type:"number",label:"最大登录尝试次数",value:e.maxLoginAttempts.toString(),onChange:e=>T("maxLoginAttempts",parseInt(e.target.value)),errorMessage:s.maxLoginAttempts,isInvalid:!!s.maxLoginAttempts,description:"超过此次数将暂时锁定账号"}),a.jsx(m.Y,{type:"number",label:"会话超时时间（分钟）",value:e.sessionTimeout.toString(),onChange:e=>T("sessionTimeout",parseInt(e.target.value)),errorMessage:s.sessionTimeout,isInvalid:!!s.sessionTimeout,description:"用户无操作后自动退出登录的时间"})]})]}),(0,a.jsxs)(o.w,{className:"p-4",children:[(0,a.jsxs)(c.u,{className:"flex gap-3",children:[a.jsx(f.Z,{size:24,className:"text-primary"}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-xl font-bold",children:"维护模式"}),a.jsx("p",{className:"text-sm text-default-500",children:"系统维护相关设置"})]})]}),a.jsx(d.G,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"维护模式"}),a.jsx("p",{className:"text-xs text-default-500",children:"启用后仅管理员可访问系统"})]}),a.jsx(u.i,{isSelected:e.maintenanceMode,onValueChange:e=>T("maintenanceMode",e),color:"danger"})]})})]})]})]})}},87265:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(95344),i=s(3729),n=s(91529);let r=({variant:e="default"})=>{let t=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(!t.current)return;let s=t.current,a=s.getContext("2d");if(!a)return;let i=()=>{s.width=window.innerWidth,s.height=window.innerHeight};i(),window.addEventListener("resize",i);let n=[],r="minimal"===e?50:100;class l{constructor(){this.x=Math.random()*s.width,this.y=Math.random()*s.height,this.size=2*Math.random()+.5,this.speedX=.5*Math.random()-.25,this.speedY=.5*Math.random()-.25,this.color=`hsla(${60*Math.random()+200}, 70%, 60%, ${.8*Math.random()+.2})`}update(){this.x+=this.speedX,this.y+=this.speedY,this.x>s.width?this.x=0:this.x<0&&(this.x=s.width),this.y>s.height?this.y=0:this.y<0&&(this.y=s.height)}draw(){a&&(a.fillStyle=this.color,a.beginPath(),a.arc(this.x,this.y,this.size,0,2*Math.PI),a.fill())}}let o=()=>{if(a)for(let e=0;e<n.length;e++)for(let t=e;t<n.length;t++){let s=n[e].x-n[t].x,i=n[e].y-n[t].y,r=Math.sqrt(s*s+i*i);if(r<150){let s=1-r/150;a.strokeStyle=`rgba(150, 150, 255, ${.15*s})`,a.lineWidth=.8,a.beginPath(),a.moveTo(n[e].x,n[e].y),a.lineTo(n[t].x,n[t].y),a.stroke()}}},c=()=>{if(a){for(let t of(a.clearRect(0,0,s.width,s.height),"default"===e&&d(),n))t.update(),t.draw();o(),requestAnimationFrame(c)}},d=()=>{if(!a)return;a.strokeStyle="rgba(100, 100, 255, 0.1)",a.beginPath(),a.lineWidth=1.5,a.arc(0,0,200,0,.5*Math.PI),a.stroke(),a.beginPath(),a.arc(s.width,s.height,250,Math.PI,1.5*Math.PI),a.stroke(),a.beginPath(),a.lineWidth=.8;let e=s.width/2,t=s.height/2,i=.4*Math.min(s.width,s.height);a.moveTo(e-i/2,t-i/2),a.lineTo(e+i/2,t-i/2),a.lineTo(e+i/2,t+i/2),a.lineTo(e-i/2,t+i/2),a.lineTo(e-i/2,t-i/2),a.stroke()};return(()=>{for(let e=0;e<r;e++)n.push(new l)})(),c(),()=>{window.removeEventListener("resize",i)}},[e]),(0,a.jsxs)("div",{className:"fixed inset-0 -z-10 overflow-hidden",children:[a.jsx("canvas",{ref:t,className:"absolute inset-0 w-full h-full"}),a.jsx("div",{className:"absolute top-0 -left-[10%] w-[50%] h-[50%] bg-primary/10 rounded-full blur-[150px] -z-10"}),a.jsx("div",{className:"absolute bottom-[10%] right-[10%] w-[40%] h-[40%] bg-secondary/10 rounded-full blur-[150px] -z-10"}),a.jsx(n.E.div,{className:"absolute top-[20%] right-[10%] w-16 h-16 border border-primary/20 rounded-full",animate:{y:[0,15,0],opacity:[.6,.9,.6],scale:[1,1.05,1]},transition:{duration:6,repeat:1/0,ease:"easeInOut"}}),a.jsx(n.E.div,{className:"absolute top-[10%] left-[20%] w-24 h-24 border border-secondary/30 rounded-xl rotate-45",animate:{y:[0,-20,0],opacity:[.3,.6,.3],rotate:[45,35,45]},transition:{duration:8,repeat:1/0,ease:"easeInOut"}}),a.jsx(n.E.div,{className:"absolute bottom-[30%] left-[5%] w-20 h-20 bg-gradient-to-tr from-primary/5 to-secondary/5 rounded-lg",animate:{x:[0,10,0],opacity:[.4,.7,.4],rotate:[0,10,0]},transition:{duration:7,repeat:1/0,ease:"easeInOut"}})]})}},41575:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var a=s(95344),i=s(87265);let n={lg:"max-w-5xl",xl:"max-w-7xl",full:"w-full max-w-none"},r={sm:"py-6",md:"py-10",lg:"py-16"},l=function({title:e,description:t,actions:s,children:l,backgroundVariant:o="minimal",maxWidth:c="xl",padding:d="md",contentClassName:m="",headerClassName:x=""}){let h=["relative","mx-auto","w-full","px-4",n[c],r[d],m].filter(Boolean).join(" "),u=e||t||s;return(0,a.jsxs)("main",{className:"relative min-h-screen overflow-hidden",children:["none"!==o&&a.jsx(i.Z,{variant:"default"===o?"default":"minimal"}),(0,a.jsxs)("div",{className:h,children:[u&&(0,a.jsxs)("div",{className:["mb-8","flex flex-col gap-4","sm:flex-row sm:items-center sm:justify-between",x].filter(Boolean).join(" "),children:[(0,a.jsxs)("div",{className:"space-y-1",children:[e&&a.jsx("h1",{className:"text-2xl font-bold md:text-3xl",children:e}),t&&a.jsx("p",{className:"max-w-2xl text-base text-default-500 md:text-lg",children:t})]}),s&&a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:s})]}),a.jsx("div",{className:"relative z-10",children:l})]})]})}},37384:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>r});let a=(0,s(86843).createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/settings/layout.tsx`),{__esModule:i,$$typeof:n}=a,r=a.default},80275:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>r});let a=(0,s(86843).createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/settings/system/page.tsx`),{__esModule:i,$$typeof:n}=a,r=a.default},87055:(e,t,s)=>{"use strict";s.d(t,{u:()=>c});var a=s(92580),i=s(36279),n=s(52401),r=s(90386),l=s(95344),o=(0,i.Gp)((e,t)=>{var s;let{as:i,className:o,children:c,...d}=e,m=(0,n.gy)(t),{slots:x,classNames:h}=(0,a.R)(),u=(0,r.W)(null==h?void 0:h.header,o);return(0,l.jsx)(i||"div",{ref:m,className:null==(s=x.header)?void 0:s.call(x,{class:u}),...d,children:c})});o.displayName="NextUI.CardHeader";var c=o},18012:(e,t,s)=>{"use strict";s.d(t,{l:()=>i});var a=s(51410);function i(...e){return t=>{e.forEach(e=>(function(e,t){if(null!=e){if((0,a.mf)(e)){e(t);return}try{e.current=t}catch(s){throw Error(`Cannot assign value '${t}' to ref '${e}'`)}}})(e,t))}}},29703:(e,t,s)=>{"use strict";s.d(t,{l:()=>i});var a=s(49810);function i(e={}){let{isReadOnly:t}=e,[s,i]=(0,a.z)(e.isSelected,e.defaultSelected||!1,e.onChange);return{isSelected:s,setSelected:function(e){t||i(e)},toggle:function(){t||i(!s)}}}},63701:(e,t,s)=>{"use strict";function a(e,t){return"function"==typeof e?e(...t):!!e}function i(){}s.d(t,{L:()=>a,Z:()=>i})}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[3715,1529,8974,7279,7721,7791,1327,9799,5261,6536,6250,1271,492,7048,4037],()=>s(86794));module.exports=a})();