(()=>{var e={};e.id=1304,e.ids=[1304],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25935:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>f,originalPathname:()=>c,pages:()=>d,routeModule:()=>m,tree:()=>u});var s=r(50482),a=r(69108),i=r(62563),n=r.n(i),l=r(68300),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let u=["",{children:["settings",{children:["routes",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,58282)),"/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/settings/routes/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,16201)),"/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/settings/routes/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,37384)),"/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/settings/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,66053)),"/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,24117)),"/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}],d=["/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/settings/routes/page.tsx"],c="/settings/routes/page",f={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/settings/routes/page",pathname:"/settings/routes",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},27661:(e,t,r)=>{Promise.resolve().then(r.bind(r,70366))},88770:(e,t,r)=>{Promise.resolve().then(r.bind(r,62553))},68828:(e,t,r)=>{Promise.resolve().then(r.bind(r,65857))},51838:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(97075).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},70366:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var s=r(95344);r(3729);var a=r(8428),i=r(56506),n=r(56686),l=r(2273),o=r(89895),u=r(54052),d=r(99046),c=r(37121),f=r(23485),m=r(13746),h=r(91529);let y=[{name:"系统设置",href:"/settings/system",icon:s.jsx(l.Z,{size:20})},{name:"用户管理",href:"/settings/users",icon:s.jsx(o.Z,{size:20})},{name:"家庭管理",href:"/settings/family",icon:s.jsx(u.Z,{size:20})},{name:"分类管理",href:"/settings/category",icon:s.jsx(d.Z,{size:20})},{name:"系统日志",href:"/settings/logs",icon:s.jsx(c.Z,{size:20})},{name:"备份恢复",href:"/settings/backup",icon:s.jsx(f.Z,{size:20})}];function x({children:e}){let t=(0,a.usePathname)();return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background to-default-100",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"flex gap-6",children:[(0,s.jsxs)(n.w,{className:"w-64 h-fit p-2 shrink-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 p-4 mb-2",children:[s.jsx(h.E.div,{animate:{rotate:[0,15,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:s.jsx(m.Z,{size:24,className:"text-primary"})}),s.jsx("h2",{className:"text-xl font-bold",children:"后台管理"})]}),s.jsx("nav",{children:y.map(e=>{let r=t===e.href;return(0,s.jsxs)(i.default,{href:e.href,className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${r?"bg-primary text-white":"hover:bg-default-100"}`,children:[e.icon,s.jsx("span",{children:e.name})]},e.href)})})]}),s.jsx(n.w,{className:"flex-1 p-6",children:e})]})})})}},62553:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(95344),a=r(95396);function i({children:e}){return s.jsx(a.Z,{requiredRole:"admin",children:e})}},65857:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>th});var s=r(95344),a=r(3729),i=r.n(a),n=r(78225),l=r(44738),o=r(30891),u=r(45191),d=r(56686),c=r(40237),f=r(51838),m=r(30853),h=r(26274),y=r(81271),x=r(31296),g=r(96548),p=r(40005),v=r(75019),b=r(97075);let j=(0,b.Z)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var _=r(38271);let w=(0,b.Z)("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]),A=(0,b.Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var V=r(61261);let S=[{header:"路径",accessorKey:"path"},{header:"名称",accessorKey:"name"},{header:"描述",accessorKey:"description"},{header:"权限",accessorKey:"permission",cell:({row:e})=>{let t=e.original.permission;return({[V.wI.PUBLIC]:"公开",[V.wI.PRIVATE]:"私有",[V.wI.FAMILY]:"家庭",[V.wI.ADMIN]:"管理员"})[t]||t}},{header:"状态",accessorKey:"is_active",cell:({row:e})=>e.original.is_active?"启用":"禁用"},{header:"创建时间",accessorKey:"created_at",cell:({row:e})=>new Date(e.original.created_at).toLocaleString()},{header:"更新时间",accessorKey:"updated_at",cell:({row:e})=>new Date(e.original.updated_at).toLocaleString()},{header:"操作",cell:({row:e})=>{let t=e.original;return(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(v.e,{content:"编辑",children:s.jsx(l.A,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>t.onEdit?.(t),children:s.jsx(j,{className:"w-4 h-4"})})}),s.jsx(v.e,{content:"删除",children:s.jsx(l.A,{isIconOnly:!0,size:"sm",variant:"light",color:"danger",onPress:()=>t.onDelete?.(t),children:s.jsx(_.Z,{className:"w-4 h-4"})})}),s.jsx(v.e,{content:t.is_active?"禁用":"启用",children:s.jsx(l.A,{isIconOnly:!0,size:"sm",variant:"light",color:t.is_active?"warning":"success",onPress:()=>t.onToggleActive?.(t),children:s.jsx(w,{className:"w-4 h-4"})})}),s.jsx(v.e,{content:"查看性能",children:s.jsx(l.A,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>t.onViewStats?.(t),children:s.jsx(A,{className:"w-4 h-4"})})})]})}}];var F=r(70596),k=r(81686),D=r(26417),N=r(97446),C=r(41931),E=r(70199),O=r(16),I=r(44360),T=r(3635),P=r(75462),M=e=>"checkbox"===e.type,L=e=>e instanceof Date,R=e=>null==e;let q=e=>"object"==typeof e;var B=e=>!R(e)&&!Array.isArray(e)&&q(e)&&!L(e),U=e=>B(e)&&e.target?M(e.target)?e.target.checked:e.target.value:e,z=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,K=(e,t)=>e.has(z(t)),Y=e=>{let t=e.constructor&&e.constructor.prototype;return B(t)&&t.hasOwnProperty("isPrototypeOf")};function $(e){let t;let r=Array.isArray(e);if("undefined"!=typeof FileList&&FileList,e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(r||B(e)))return e;else if(t=r?[]:{},r||Y(e))for(let r in e)e.hasOwnProperty(r)&&(t[r]=$(e[r]));else t=e;return t}var G=e=>Array.isArray(e)?e.filter(Boolean):[],Z=e=>void 0===e,H=(e,t,r)=>{if(!t||!B(e))return r;let s=G(t.split(/[,[\].]+?/)).reduce((e,t)=>R(e)?e:e[t],e);return Z(s)||s===e?Z(e[t])?r:e[t]:s},W=e=>"boolean"==typeof e,Q=e=>/^\w*$/.test(e),X=e=>G(e.replace(/["|']|\]/g,"").split(/\.|\[/)),J=(e,t,r)=>{let s=-1,a=Q(t)?[t]:X(t),i=a.length,n=i-1;for(;++s<i;){let t=a[s],i=r;if(s!==n){let r=e[t];i=B(r)||Array.isArray(r)?r:isNaN(+a[s+1])?{}:[]}if("__proto__"===t||"constructor"===t||"prototype"===t)return;e[t]=i,e=e[t]}return e};let ee={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},et={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},er={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},es=a.createContext(null),ea=()=>a.useContext(es);var ei=(e,t,r,s=!0)=>{let a={defaultValues:t._defaultValues};for(let i in e)Object.defineProperty(a,i,{get:()=>(t._proxyFormState[i]!==et.all&&(t._proxyFormState[i]=!s||et.all),r&&(r[i]=!0),e[i])});return a},en=e=>B(e)&&!Object.keys(e).length,el=(e,t,r,s)=>{r(e);let{name:a,...i}=e;return en(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(e=>t[e]===(!s||et.all))},eo=e=>Array.isArray(e)?e:[e],eu=(e,t,r)=>!e||!t||e===t||eo(e).some(e=>e&&(r?e===t:e.startsWith(t)||t.startsWith(e)));function ed(e){let t=a.useRef(e);t.current=e,a.useEffect(()=>{let r=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{r&&r.unsubscribe()}},[e.disabled])}var ec=e=>"string"==typeof e,ef=(e,t,r,s,a)=>ec(e)?(s&&t.watch.add(e),H(r,e,a)):Array.isArray(e)?e.map(e=>(s&&t.watch.add(e),H(r,e))):(s&&(t.watchAll=!0),r);let em=e=>e.render(function(e){let t=ea(),{name:r,disabled:s,control:i=t.control,shouldUnregister:n}=e,l=K(i._names.array,r),o=function(e){let t=ea(),{control:r=t.control,name:s,defaultValue:i,disabled:n,exact:l}=e||{},o=a.useRef(s);o.current=s,ed({disabled:n,subject:r._subjects.values,next:e=>{eu(o.current,e.name,l)&&d($(ef(o.current,r._names,e.values||r._formValues,!1,i)))}});let[u,d]=a.useState(r._getWatch(s,i));return a.useEffect(()=>r._removeUnmounted()),u}({control:i,name:r,defaultValue:H(i._formValues,r,H(i._defaultValues,r,e.defaultValue)),exact:!0}),u=function(e){let t=ea(),{control:r=t.control,disabled:s,name:i,exact:n}=e||{},[l,o]=a.useState(r._formState),u=a.useRef(!0),d=a.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),c=a.useRef(i);return c.current=i,ed({disabled:s,next:e=>u.current&&eu(c.current,e.name,n)&&el(e,d.current,r._updateFormState)&&o({...r._formState,...e}),subject:r._subjects.state}),a.useEffect(()=>(u.current=!0,d.current.isValid&&r._updateValid(!0),()=>{u.current=!1}),[r]),a.useMemo(()=>ei(l,r,d.current,!1),[l,r])}({control:i,name:r,exact:!0}),d=a.useRef(i.register(r,{...e.rules,value:o,...W(e.disabled)?{disabled:e.disabled}:{}})),c=a.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!H(u.errors,r)},isDirty:{enumerable:!0,get:()=>!!H(u.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!H(u.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!H(u.validatingFields,r)},error:{enumerable:!0,get:()=>H(u.errors,r)}}),[u,r]),f=a.useMemo(()=>({name:r,value:o,...W(s)||u.disabled?{disabled:u.disabled||s}:{},onChange:e=>d.current.onChange({target:{value:U(e),name:r},type:ee.CHANGE}),onBlur:()=>d.current.onBlur({target:{value:H(i._formValues,r),name:r},type:ee.BLUR}),ref:e=>{let t=H(i._fields,r);t&&e&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}}),[r,i._formValues,s,u.disabled,o,i._fields]);return a.useEffect(()=>{let e=i._options.shouldUnregister||n,t=(e,t)=>{let r=H(i._fields,e);r&&r._f&&(r._f.mount=t)};if(t(r,!0),e){let e=$(H(i._options.defaultValues,r));J(i._defaultValues,r,e),Z(H(i._formValues,r))&&J(i._formValues,r,e)}return l||i.register(r),()=>{(l?e&&!i._state.action:e)?i.unregister(r):t(r,!1)}},[r,i,l,n]),a.useEffect(()=>{i._updateDisabledField({disabled:s,fields:i._fields,name:r})},[s,r,i]),a.useMemo(()=>({field:f,formState:u,fieldState:c}),[f,u,c])}(e));var eh=(e,t,r,s,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[s]:a||!0}}:{},ey=e=>({isOnSubmit:!e||e===et.onSubmit,isOnBlur:e===et.onBlur,isOnChange:e===et.onChange,isOnAll:e===et.all,isOnTouch:e===et.onTouched}),ex=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))));let eg=(e,t,r,s)=>{for(let a of r||Object.keys(e)){let r=H(e,a);if(r){let{_f:e,...i}=r;if(e){if(e.refs&&e.refs[0]&&t(e.refs[0],a)&&!s||e.ref&&t(e.ref,e.name)&&!s)return!0;if(eg(i,t))break}else if(B(i)&&eg(i,t))break}}};var ep=(e,t,r)=>{let s=eo(H(e,r));return J(s,"root",t[r]),J(e,r,s),e},ev=e=>"file"===e.type,eb=e=>"function"==typeof e,ej=e=>!1,e_=e=>ec(e),ew=e=>"radio"===e.type,eA=e=>e instanceof RegExp;let eV={value:!1,isValid:!1},eS={value:!0,isValid:!0};var eF=e=>{if(Array.isArray(e)){if(e.length>1){let t=e.filter(e=>e&&e.checked&&!e.disabled).map(e=>e.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Z(e[0].attributes.value)?Z(e[0].value)||""===e[0].value?eS:{value:e[0].value,isValid:!0}:eS:eV}return eV};let ek={isValid:!1,value:null};var eD=e=>Array.isArray(e)?e.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,ek):ek;function eN(e,t,r="validate"){if(e_(e)||Array.isArray(e)&&e.every(e_)||W(e)&&!e)return{type:r,message:e_(e)?e:"",ref:t}}var eC=e=>B(e)&&!eA(e)?e:{value:e,message:""},eE=async(e,t,r,s,a,i)=>{let{ref:n,refs:l,required:o,maxLength:u,minLength:d,min:c,max:f,pattern:m,validate:h,name:y,valueAsNumber:x,mount:g}=e._f,p=H(r,y);if(!g||t.has(y))return{};let v=l?l[0]:n,b=e=>{a&&v.reportValidity&&(v.setCustomValidity(W(e)?"":e||""),v.reportValidity())},j={},_=ew(n),w=M(n),A=(x||ev(n))&&Z(n.value)&&Z(p)||ej(n)&&""===n.value||""===p||Array.isArray(p)&&!p.length,V=eh.bind(null,y,s,j),S=(e,t,r,s=er.maxLength,a=er.minLength)=>{let i=e?t:r;j[y]={type:e?s:a,message:i,ref:n,...V(e?s:a,i)}};if(i?!Array.isArray(p)||!p.length:o&&(!(_||w)&&(A||R(p))||W(p)&&!p||w&&!eF(l).isValid||_&&!eD(l).isValid)){let{value:e,message:t}=e_(o)?{value:!!o,message:o}:eC(o);if(e&&(j[y]={type:er.required,message:t,ref:v,...V(er.required,t)},!s))return b(t),j}if(!A&&(!R(c)||!R(f))){let e,t;let r=eC(f),a=eC(c);if(R(p)||isNaN(p)){let s=n.valueAsDate||new Date(p),i=e=>new Date(new Date().toDateString()+" "+e),l="time"==n.type,o="week"==n.type;ec(r.value)&&p&&(e=l?i(p)>i(r.value):o?p>r.value:s>new Date(r.value)),ec(a.value)&&p&&(t=l?i(p)<i(a.value):o?p<a.value:s<new Date(a.value))}else{let s=n.valueAsNumber||(p?+p:p);R(r.value)||(e=s>r.value),R(a.value)||(t=s<a.value)}if((e||t)&&(S(!!e,r.message,a.message,er.max,er.min),!s))return b(j[y].message),j}if((u||d)&&!A&&(ec(p)||i&&Array.isArray(p))){let e=eC(u),t=eC(d),r=!R(e.value)&&p.length>+e.value,a=!R(t.value)&&p.length<+t.value;if((r||a)&&(S(r,e.message,t.message),!s))return b(j[y].message),j}if(m&&!A&&ec(p)){let{value:e,message:t}=eC(m);if(eA(e)&&!p.match(e)&&(j[y]={type:er.pattern,message:t,ref:n,...V(er.pattern,t)},!s))return b(t),j}if(h){if(eb(h)){let e=eN(await h(p,r),v);if(e&&(j[y]={...e,...V(er.validate,e.message)},!s))return b(e.message),j}else if(B(h)){let e={};for(let t in h){if(!en(e)&&!s)break;let a=eN(await h[t](p,r),v,t);a&&(e={...a,...V(t,a.message)},b(a.message),s&&(j[y]=e))}if(!en(e)&&(j[y]={ref:v,...e},!s))return j}}return b(!0),j};function eO(e,t){let r=Array.isArray(t)?t:Q(t)?[t]:X(t),s=1===r.length?e:function(e,t){let r=t.slice(0,-1).length,s=0;for(;s<r;)e=Z(e)?s++:e[t[s++]];return e}(e,r),a=r.length-1,i=r[a];return s&&delete s[i],0!==a&&(B(s)&&en(s)||Array.isArray(s)&&function(e){for(let t in e)if(e.hasOwnProperty(t)&&!Z(e[t]))return!1;return!0}(s))&&eO(e,r.slice(0,-1)),e}var eI=()=>{let e=[];return{get observers(){return e},next:t=>{for(let r of e)r.next&&r.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter(e=>e!==t)}}),unsubscribe:()=>{e=[]}}},eT=e=>R(e)||!q(e);function eP(e,t){if(eT(e)||eT(t))return e===t;if(L(e)&&L(t))return e.getTime()===t.getTime();let r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(let a of r){let r=e[a];if(!s.includes(a))return!1;if("ref"!==a){let e=t[a];if(L(r)&&L(e)||B(r)&&B(e)||Array.isArray(r)&&Array.isArray(e)?!eP(r,e):r!==e)return!1}}return!0}var eM=e=>"select-multiple"===e.type,eL=e=>ew(e)||M(e),eR=e=>ej(e)&&e.isConnected,eq=e=>{for(let t in e)if(eb(e[t]))return!0;return!1};function eB(e,t={}){let r=Array.isArray(e);if(B(e)||r)for(let r in e)Array.isArray(e[r])||B(e[r])&&!eq(e[r])?(t[r]=Array.isArray(e[r])?[]:{},eB(e[r],t[r])):R(e[r])||(t[r]=!0);return t}var eU=(e,t)=>(function e(t,r,s){let a=Array.isArray(t);if(B(t)||a)for(let a in t)Array.isArray(t[a])||B(t[a])&&!eq(t[a])?Z(r)||eT(s[a])?s[a]=Array.isArray(t[a])?eB(t[a],[]):{...eB(t[a])}:e(t[a],R(r)?{}:r[a],s[a]):s[a]=!eP(t[a],r[a]);return s})(e,t,eB(t)),ez=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:s})=>Z(e)?e:t?""===e?NaN:e?+e:e:r&&ec(e)?new Date(e):s?s(e):e;function eK(e){let t=e.ref;return ev(t)?t.files:ew(t)?eD(e.refs).value:eM(t)?[...t.selectedOptions].map(({value:e})=>e):M(t)?eF(e.refs).value:ez(Z(t.value)?e.ref.value:t.value,e)}var eY=(e,t,r,s)=>{let a={};for(let r of e){let e=H(t,r);e&&J(a,r,e._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:s}},e$=e=>Z(e)?e:eA(e)?e.source:B(e)?eA(e.value)?e.value.source:e.value:e;let eG="AsyncFunction";var eZ=e=>!!e&&!!e.validate&&!!(eb(e.validate)&&e.validate.constructor.name===eG||B(e.validate)&&Object.values(e.validate).find(e=>e.constructor.name===eG)),eH=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function eW(e,t,r){let s=H(e,r);if(s||Q(r))return{error:s,name:r};let a=r.split(".");for(;a.length;){let s=a.join("."),i=H(t,s),n=H(e,s);if(i&&!Array.isArray(i)&&r!==s)break;if(n&&n.type)return{name:s,error:n};a.pop()}return{name:r}}var eQ=(e,t,r,s,a)=>!a.isOnAll&&(!r&&a.isOnTouch?!(t||e):(r?s.isOnBlur:a.isOnBlur)?!e:(r?!s.isOnChange:!a.isOnChange)||e),eX=(e,t)=>!G(H(e,t)).length&&eO(e,t);let eJ={mode:et.onSubmit,reValidateMode:et.onChange,shouldFocusError:!0},e0=(e,t,r)=>{if(e&&"reportValidity"in e){let s=H(r,t);e.setCustomValidity(s&&s.message||""),e.reportValidity()}},e1=(e,t)=>{for(let r in t.fields){let s=t.fields[r];s&&s.ref&&"reportValidity"in s.ref?e0(s.ref,r,e):s&&s.refs&&s.refs.forEach(t=>e0(t,r,e))}},e2=(e,t)=>{t.shouldUseNativeValidation&&e1(e,t);let r={};for(let s in e){let a=H(t.fields,s),i=Object.assign(e[s]||{},{ref:a&&a.ref});if(e4(t.names||Object.keys(e),s)){let e=Object.assign({},H(r,s));J(e,"root",i),J(r,s,e)}else J(r,s,i)}return r},e4=(e,t)=>{let r=e3(t);return e.some(e=>e3(e).match(`^${r}\\.\\d+`))};function e3(e){return e.replace(/\]|\[/g,"")}var e5=r(29709);let e8=e5.z.object({path:e5.z.string().min(1,"路径不能为空"),name:e5.z.string().min(1,"名称不能为空"),description:e5.z.string(),type:e5.z.nativeEnum(V.Yt),permission:e5.z.nativeEnum(V.wI),is_active:e5.z.boolean(),user_id:e5.z.number().optional(),family_id:e5.z.number().nullable().optional()});function e6({isOpen:e,onClose:t,onSubmit:r,initialData:n}){var o;let{control:u,handleSubmit:d,formState:{errors:c,isSubmitting:f},reset:m}=function(e={}){let t=a.useRef(void 0),r=a.useRef(void 0),[s,i]=a.useState({isDirty:!1,isValidating:!1,isLoading:eb(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:eb(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...function(e={}){let t,r={...eJ,...e},s={submitCount:0,isDirty:!1,isLoading:eb(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1},a={},i=(B(r.defaultValues)||B(r.values))&&$(r.defaultValues||r.values)||{},n=r.shouldUnregister?{}:$(i),l={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u=0,d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},c={values:eI(),array:eI(),state:eI()},f=ey(r.mode),m=ey(r.reValidateMode),h=r.criteriaMode===et.all,y=e=>t=>{clearTimeout(u),u=setTimeout(e,t)},x=async e=>{if(!r.disabled&&(d.isValid||e)){let e=r.resolver?en((await _()).errors):await A(a,!0);e!==s.isValid&&c.state.next({isValid:e})}},g=(e,t)=>{!r.disabled&&(d.isValidating||d.validatingFields)&&((e||Array.from(o.mount)).forEach(e=>{e&&(t?J(s.validatingFields,e,t):eO(s.validatingFields,e))}),c.state.next({validatingFields:s.validatingFields,isValidating:!en(s.validatingFields)}))},p=(e,t)=>{J(s.errors,e,t),c.state.next({errors:s.errors})},v=(e,t,r,s)=>{let o=H(a,e);if(o){let a=H(n,e,Z(r)?H(i,e):r);Z(a)||s&&s.defaultChecked||t?J(n,e,t?a:eK(o._f)):F(e,a),l.mount&&x()}},b=(e,t,n,l,o)=>{let u=!1,f=!1,m={name:e};if(!r.disabled){let r=!!(H(a,e)&&H(a,e)._f&&H(a,e)._f.disabled);if(!n||l){d.isDirty&&(f=s.isDirty,s.isDirty=m.isDirty=V(),u=f!==m.isDirty);let a=r||eP(H(i,e),t);f=!!(!r&&H(s.dirtyFields,e)),a||r?eO(s.dirtyFields,e):J(s.dirtyFields,e,!0),m.dirtyFields=s.dirtyFields,u=u||d.dirtyFields&&!a!==f}if(n){let t=H(s.touchedFields,e);t||(J(s.touchedFields,e,n),m.touchedFields=s.touchedFields,u=u||d.touchedFields&&t!==n)}u&&o&&c.state.next(m)}return u?m:{}},j=(e,a,i,n)=>{let l=H(s.errors,e),o=d.isValid&&W(a)&&s.isValid!==a;if(r.delayError&&i?(t=y(()=>p(e,i)))(r.delayError):(clearTimeout(u),t=null,i?J(s.errors,e,i):eO(s.errors,e)),(i?!eP(l,i):l)||!en(n)||o){let t={...n,...o&&W(a)?{isValid:a}:{},errors:s.errors,name:e};s={...s,...t},c.state.next(t)}},_=async e=>{g(e,!0);let t=await r.resolver(n,r.context,eY(e||o.mount,a,r.criteriaMode,r.shouldUseNativeValidation));return g(e),t},w=async e=>{let{errors:t}=await _(e);if(e)for(let r of e){let e=H(t,r);e?J(s.errors,r,e):eO(s.errors,r)}else s.errors=t;return t},A=async(e,t,a={valid:!0})=>{for(let i in e){let l=e[i];if(l){let{_f:e,...u}=l;if(e){let u=o.array.has(e.name),c=l._f&&eZ(l._f);c&&d.validatingFields&&g([i],!0);let f=await eE(l,o.disabled,n,h,r.shouldUseNativeValidation&&!t,u);if(c&&d.validatingFields&&g([i]),f[e.name]&&(a.valid=!1,t))break;t||(H(f,e.name)?u?ep(s.errors,f,e.name):J(s.errors,e.name,f[e.name]):eO(s.errors,e.name))}en(u)||await A(u,t,a)}}return a.valid},V=(e,t)=>!r.disabled&&(e&&t&&J(n,e,t),!eP(O(),i)),S=(e,t,r)=>ef(e,o,{...l.mount?n:Z(t)?i:ec(e)?{[e]:t}:t},r,t),F=(e,t,r={})=>{let s=H(a,e),i=t;if(s){let r=s._f;r&&(r.disabled||J(n,e,ez(t,r)),i=ej(r.ref)&&R(t)?"":t,eM(r.ref)?[...r.ref.options].forEach(e=>e.selected=i.includes(e.value)):r.refs?M(r.ref)?r.refs.length>1?r.refs.forEach(e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(i)?!!i.find(t=>t===e.value):i===e.value)):r.refs[0]&&(r.refs[0].checked=!!i):r.refs.forEach(e=>e.checked=e.value===i):ev(r.ref)?r.ref.value="":(r.ref.value=i,r.ref.type||c.values.next({name:e,values:{...n}})))}(r.shouldDirty||r.shouldTouch)&&b(e,i,r.shouldTouch,r.shouldDirty,!0),r.shouldValidate&&E(e)},k=(e,t,r)=>{for(let s in t){let i=t[s],n=`${e}.${s}`,l=H(a,n);(o.array.has(e)||B(i)||l&&!l._f)&&!L(i)?k(n,i,r):F(n,i,r)}},D=(e,t,r={})=>{let u=H(a,e),f=o.array.has(e),m=$(t);J(n,e,m),f?(c.array.next({name:e,values:{...n}}),(d.isDirty||d.dirtyFields)&&r.shouldDirty&&c.state.next({name:e,dirtyFields:eU(i,n),isDirty:V(e,m)})):!u||u._f||R(m)?F(e,m,r):k(e,m,r),ex(e,o)&&c.state.next({...s}),c.values.next({name:l.mount?e:void 0,values:{...n}})},N=async e=>{l.mount=!0;let i=e.target,u=i.name,y=!0,p=H(a,u),v=e=>{y=Number.isNaN(e)||L(e)&&isNaN(e.getTime())||eP(e,H(n,u,e))};if(p){let l,w;let V=i.type?eK(p._f):U(e),S=e.type===ee.BLUR||e.type===ee.FOCUS_OUT,F=!eH(p._f)&&!r.resolver&&!H(s.errors,u)&&!p._f.deps||eQ(S,H(s.touchedFields,u),s.isSubmitted,m,f),k=ex(u,o,S);J(n,u,V),S?(p._f.onBlur&&p._f.onBlur(e),t&&t(0)):p._f.onChange&&p._f.onChange(e);let D=b(u,V,S,!1),N=!en(D)||k;if(S||c.values.next({name:u,type:e.type,values:{...n}}),F)return d.isValid&&("onBlur"===r.mode&&S?x():S||x()),N&&c.state.next({name:u,...k?{}:D});if(!S&&k&&c.state.next({...s}),r.resolver){let{errors:e}=await _([u]);if(v(V),y){let t=eW(s.errors,a,u),r=eW(e,a,t.name||u);l=r.error,u=r.name,w=en(e)}}else g([u],!0),l=(await eE(p,o.disabled,n,h,r.shouldUseNativeValidation))[u],g([u]),v(V),y&&(l?w=!1:d.isValid&&(w=await A(a,!0)));y&&(p._f.deps&&E(p._f.deps),j(u,w,l,D))}},C=(e,t)=>{if(H(s.errors,t)&&e.focus)return e.focus(),1},E=async(e,t={})=>{let i,n;let l=eo(e);if(r.resolver){let t=await w(Z(e)?e:l);i=en(t),n=e?!l.some(e=>H(t,e)):i}else e?((n=(await Promise.all(l.map(async e=>{let t=H(a,e);return await A(t&&t._f?{[e]:t}:t)}))).every(Boolean))||s.isValid)&&x():n=i=await A(a);return c.state.next({...!ec(e)||d.isValid&&i!==s.isValid?{}:{name:e},...r.resolver||!e?{isValid:i}:{},errors:s.errors}),t.shouldFocus&&!n&&eg(a,C,e?l:o.mount),n},O=e=>{let t={...l.mount?n:i};return Z(e)?t:ec(e)?H(t,e):e.map(e=>H(t,e))},I=(e,t)=>({invalid:!!H((t||s).errors,e),isDirty:!!H((t||s).dirtyFields,e),error:H((t||s).errors,e),isValidating:!!H(s.validatingFields,e),isTouched:!!H((t||s).touchedFields,e)}),T=(e,t,r)=>{let i=(H(a,e,{_f:{}})._f||{}).ref,{ref:n,message:l,type:o,...u}=H(s.errors,e)||{};J(s.errors,e,{...u,...t,ref:i}),c.state.next({name:e,errors:s.errors,isValid:!1}),r&&r.shouldFocus&&i&&i.focus&&i.focus()},P=(e,t={})=>{for(let l of e?eo(e):o.mount)o.mount.delete(l),o.array.delete(l),t.keepValue||(eO(a,l),eO(n,l)),t.keepError||eO(s.errors,l),t.keepDirty||eO(s.dirtyFields,l),t.keepTouched||eO(s.touchedFields,l),t.keepIsValidating||eO(s.validatingFields,l),r.shouldUnregister||t.keepDefaultValue||eO(i,l);c.values.next({values:{...n}}),c.state.next({...s,...t.keepDirty?{isDirty:V()}:{}}),t.keepIsValid||x()},q=({disabled:e,name:t,field:r,fields:s})=>{(W(e)&&l.mount||e||o.disabled.has(t))&&(e?o.disabled.add(t):o.disabled.delete(t),b(t,eK(r?r._f:H(s,t)._f),!1,!1,!0))},z=(e,t={})=>{let s=H(a,e),n=W(t.disabled)||W(r.disabled);return J(a,e,{...s||{},_f:{...s&&s._f?s._f:{ref:{name:e}},name:e,mount:!0,...t}}),o.mount.add(e),s?q({field:s,disabled:W(t.disabled)?t.disabled:r.disabled,name:e}):v(e,!0,t.value),{...n?{disabled:t.disabled||r.disabled}:{},...r.progressive?{required:!!t.required,min:e$(t.min),max:e$(t.max),minLength:e$(t.minLength),maxLength:e$(t.maxLength),pattern:e$(t.pattern)}:{},name:e,onChange:N,onBlur:N,ref:n=>{if(n){z(e,t),s=H(a,e);let r=Z(n.value)&&n.querySelectorAll&&n.querySelectorAll("input,select,textarea")[0]||n,l=eL(r),o=s._f.refs||[];(l?o.find(e=>e===r):r===s._f.ref)||(J(a,e,{_f:{...s._f,...l?{refs:[...o.filter(eR),r,...Array.isArray(H(i,e))?[{}]:[]],ref:{type:r.type,name:e}}:{ref:r}}}),v(e,!1,void 0,r))}else(s=H(a,e,{}))._f&&(s._f.mount=!1),(r.shouldUnregister||t.shouldUnregister)&&!(K(o.array,e)&&l.action)&&o.unMount.add(e)}}},Y=()=>r.shouldFocusError&&eg(a,C,o.mount),Q=(e,t)=>async i=>{let l;i&&(i.preventDefault&&i.preventDefault(),i.persist&&i.persist());let u=$(n);if(o.disabled.size)for(let e of o.disabled)J(u,e,void 0);if(c.state.next({isSubmitting:!0}),r.resolver){let{errors:e,values:t}=await _();s.errors=e,u=t}else await A(a);if(eO(s.errors,"root"),en(s.errors)){c.state.next({errors:{}});try{await e(u,i)}catch(e){l=e}}else t&&await t({...s.errors},i),Y(),setTimeout(Y);if(c.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:en(s.errors)&&!l,submitCount:s.submitCount+1,errors:s.errors}),l)throw l},X=(e,t={})=>{let u=e?$(e):i,f=$(u),m=en(e),h=m?i:f;if(t.keepDefaultValues||(i=u),!t.keepValues){if(t.keepDirtyValues)for(let e of Array.from(new Set([...o.mount,...Object.keys(eU(i,n))])))H(s.dirtyFields,e)?J(h,e,H(n,e)):D(e,H(h,e));else a={};n=r.shouldUnregister?t.keepDefaultValues?$(i):{}:$(h),c.array.next({values:{...h}}),c.values.next({values:{...h}})}o={mount:t.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!d.isValid||!!t.keepIsValid||!!t.keepDirtyValues,l.watch=!!r.shouldUnregister,c.state.next({submitCount:t.keepSubmitCount?s.submitCount:0,isDirty:!m&&(t.keepDirty?s.isDirty:!!(t.keepDefaultValues&&!eP(e,i))),isSubmitted:!!t.keepIsSubmitted&&s.isSubmitted,dirtyFields:m?{}:t.keepDirtyValues?t.keepDefaultValues&&n?eU(i,n):s.dirtyFields:t.keepDefaultValues&&e?eU(i,e):t.keepDirty?s.dirtyFields:{},touchedFields:t.keepTouched?s.touchedFields:{},errors:t.keepErrors?s.errors:{},isSubmitSuccessful:!!t.keepIsSubmitSuccessful&&s.isSubmitSuccessful,isSubmitting:!1})},er=(e,t)=>X(eb(e)?e(n):e,t);return{control:{register:z,unregister:P,getFieldState:I,handleSubmit:Q,setError:T,_executeSchema:_,_getWatch:S,_getDirty:V,_updateValid:x,_removeUnmounted:()=>{for(let e of o.unMount){let t=H(a,e);t&&(t._f.refs?t._f.refs.every(e=>!eR(e)):!eR(t._f.ref))&&P(e)}o.unMount=new Set},_updateFieldArray:(e,t=[],o,u,f=!0,m=!0)=>{if(u&&o&&!r.disabled){if(l.action=!0,m&&Array.isArray(H(a,e))){let t=o(H(a,e),u.argA,u.argB);f&&J(a,e,t)}if(m&&Array.isArray(H(s.errors,e))){let t=o(H(s.errors,e),u.argA,u.argB);f&&J(s.errors,e,t),eX(s.errors,e)}if(d.touchedFields&&m&&Array.isArray(H(s.touchedFields,e))){let t=o(H(s.touchedFields,e),u.argA,u.argB);f&&J(s.touchedFields,e,t)}d.dirtyFields&&(s.dirtyFields=eU(i,n)),c.state.next({name:e,isDirty:V(e,t),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else J(n,e,t)},_updateDisabledField:q,_getFieldArray:e=>G(H(l.mount?n:i,e,r.shouldUnregister?H(i,e,[]):[])),_reset:X,_resetDefaultValues:()=>eb(r.defaultValues)&&r.defaultValues().then(e=>{er(e,r.resetOptions),c.state.next({isLoading:!1})}),_updateFormState:e=>{s={...s,...e}},_disableForm:e=>{W(e)&&(c.state.next({disabled:e}),eg(a,(t,r)=>{let s=H(a,r);s&&(t.disabled=s._f.disabled||e,Array.isArray(s._f.refs)&&s._f.refs.forEach(t=>{t.disabled=s._f.disabled||e}))},0,!1))},_subjects:c,_proxyFormState:d,_setErrors:e=>{s.errors=e,c.state.next({errors:s.errors,isValid:!1})},get _fields(){return a},get _formValues(){return n},get _state(){return l},set _state(value){l=value},get _defaultValues(){return i},get _names(){return o},set _names(value){o=value},get _formState(){return s},set _formState(value){s=value},get _options(){return r},set _options(value){r={...r,...value}}},trigger:E,register:z,handleSubmit:Q,watch:(e,t)=>eb(e)?c.values.subscribe({next:r=>e(S(void 0,t),r)}):S(e,t,!0),setValue:D,getValues:O,reset:er,resetField:(e,t={})=>{H(a,e)&&(Z(t.defaultValue)?D(e,$(H(i,e))):(D(e,t.defaultValue),J(i,e,$(t.defaultValue))),t.keepTouched||eO(s.touchedFields,e),t.keepDirty||(eO(s.dirtyFields,e),s.isDirty=t.defaultValue?V(e,$(H(i,e))):V()),!t.keepError&&(eO(s.errors,e),d.isValid&&x()),c.state.next({...s}))},clearErrors:e=>{e&&eo(e).forEach(e=>eO(s.errors,e)),c.state.next({errors:e?s.errors:{}})},unregister:P,setError:T,setFocus:(e,t={})=>{let r=H(a,e),s=r&&r._f;if(s){let e=s.refs?s.refs[0]:s.ref;e.focus&&(e.focus(),t.shouldSelect&&eb(e.select)&&e.select())}},getFieldState:I}}(e),formState:s});let n=t.current.control;return n._options=e,ed({subject:n._subjects.state,next:e=>{el(e,n._proxyFormState,n._updateFormState,!0)&&i({...n._formState})}}),a.useEffect(()=>n._disableForm(e.disabled),[n,e.disabled]),a.useEffect(()=>{if(n._proxyFormState.isDirty){let e=n._getDirty();e!==s.isDirty&&n._subjects.state.next({isDirty:e})}},[n,s.isDirty]),a.useEffect(()=>{e.values&&!eP(e.values,r.current)?(n._reset(e.values,n._options.resetOptions),r.current=e.values,i(e=>({...e}))):n._resetDefaultValues()},[e.values,n]),a.useEffect(()=>{e.errors&&n._setErrors(e.errors)},[e.errors,n]),a.useEffect(()=>{n._state.mount||(n._updateValid(),n._state.mount=!0),n._state.watch&&(n._state.watch=!1,n._subjects.state.next({...n._formState})),n._removeUnmounted()}),a.useEffect(()=>{e.shouldUnregister&&n._subjects.values.next({values:n._getWatch()})},[e.shouldUnregister,n]),t.current.formState=ei(s,n),t.current}({resolver:(void 0===o&&(o={}),function(e,t,r){try{return Promise.resolve(function(t,s){try{var a=Promise.resolve(e8["sync"===o.mode?"parse":"parseAsync"](e,void 0)).then(function(t){return r.shouldUseNativeValidation&&e1({},r),{errors:{},values:o.raw?Object.assign({},e):t}})}catch(e){return s(e)}return a&&a.then?a.then(void 0,s):a}(0,function(e){if(Array.isArray(null==e?void 0:e.errors))return{values:{},errors:e2(function(e,t){for(var r={};e.length;){var s=e[0],a=s.code,i=s.message,n=s.path.join(".");if(!r[n]){if("unionErrors"in s){var l=s.unionErrors[0].errors[0];r[n]={message:l.message,type:l.code}}else r[n]={message:i,type:a}}if("unionErrors"in s&&s.unionErrors.forEach(function(t){return t.errors.forEach(function(t){return e.push(t)})}),t){var o=r[n].types,u=o&&o[s.code];r[n]=eh(n,t,r,a,u?[].concat(u,s.message):s.message)}e.shift()}return r}(e.errors,!r.shouldUseNativeValidation&&"all"===r.criteriaMode),r)};throw e}))}catch(e){return Promise.reject(e)}}),defaultValues:n||{path:"",name:"",description:"",type:V.Yt.DASHBOARD,permission:V.wI.PRIVATE,is_active:!0}});i().useEffect(()=>{e&&m(n)},[e,n,m]);let h=async e=>{try{await r(e),t()}catch(e){console.error("Failed to submit route:",e)}};return s.jsx(F.R,{isOpen:e,onClose:t,size:"2xl",children:s.jsx(k.A,{children:(0,s.jsxs)("form",{onSubmit:d(h),children:[s.jsx(D.k,{children:n?"编辑路由":"新增路由"}),(0,s.jsxs)(N.I,{className:"space-y-4",children:[s.jsx(em,{name:"path",control:u,render:({field:e})=>s.jsx(C.Y,{...e,label:"路径",placeholder:"请输入路由路径",errorMessage:c.path?.message,isInvalid:!!c.path})}),s.jsx(em,{name:"name",control:u,render:({field:e})=>s.jsx(C.Y,{...e,label:"名称",placeholder:"请输入路由名称",errorMessage:c.name?.message,isInvalid:!!c.name})}),s.jsx(em,{name:"description",control:u,render:({field:e})=>s.jsx(E.Y,{...e,label:"描述",placeholder:"请输入路由描述",errorMessage:c.description?.message,isInvalid:!!c.description})}),s.jsx(em,{name:"type",control:u,render:({field:e})=>(0,s.jsxs)(O.g,{...e,label:"类型",errorMessage:c.type?.message,isInvalid:!!c.type,children:[s.jsx(I.R,{value:V.Yt.DASHBOARD,children:"仪表盘"},V.Yt.DASHBOARD),s.jsx(I.R,{value:V.Yt.TRANSACTIONS,children:"交易记录"},V.Yt.TRANSACTIONS),s.jsx(I.R,{value:V.Yt.STATISTICS,children:"统计分析"},V.Yt.STATISTICS),s.jsx(I.R,{value:V.Yt.SETTINGS,children:"设置"},V.Yt.SETTINGS),s.jsx(I.R,{value:V.Yt.CUSTOM,children:"自定义页面"},V.Yt.CUSTOM)]})}),s.jsx(em,{name:"permission",control:u,render:({field:e})=>(0,s.jsxs)(O.g,{...e,label:"权限",errorMessage:c.permission?.message,isInvalid:!!c.permission,children:[s.jsx(I.R,{value:V.wI.PUBLIC,children:"公开，任何人可访问"},V.wI.PUBLIC),s.jsx(I.R,{value:V.wI.PRIVATE,children:"私有，仅创建者可访问"},V.wI.PRIVATE),s.jsx(I.R,{value:V.wI.FAMILY,children:"家庭，仅家庭成员可访问"},V.wI.FAMILY),s.jsx(I.R,{value:V.wI.ADMIN,children:"管理员，仅家庭管理员可访问"},V.wI.ADMIN)]})}),s.jsx(em,{name:"is_active",control:u,render:({field:e})=>s.jsx(T.i,{name:e.name,ref:e.ref,isSelected:e.value,onValueChange:e.onChange,children:"启用状态"})})]}),(0,s.jsxs)(P.R,{children:[s.jsx(l.A,{color:"danger",variant:"light",onPress:t,children:"取消"}),s.jsx(l.A,{color:"primary",type:"submit",isLoading:f,children:"确定"})]})]})})})}var e9=r(18964),e7=r(86517),te=r(2422),tt=r(86902),tr=r(29173),ts=r(39078),ta=(0,e7.z)({chartName:"LineChart",GraphicalChild:te.x,axisComponents:[{axisType:"xAxis",AxisComp:tt.K},{axisType:"yAxis",AxisComp:tr.B}],formatAxisMap:ts.t9}),ti=r(20903),tn=r(90626),tl=r(31634),to=r(82087),tu=r(55119),td=r(51236);let tc=["#00C49F","#FF8042","#FFBB28","#FF0000"];function tf({isOpen:e,onClose:t,route:r}){let{data:a,isLoading:i}=(0,y.a)({queryKey:["route-stats",r?.id],queryFn:()=>(0,g.fM)(r?.id),enabled:e&&!!r?.id});if(!r)return null;let n=a?.data?.accessHistory?.map(e=>({time:new Date(e.timestamp).toLocaleString(),loadTime:e.loadTime,errorCount:e.errorCount}))||[],o=[{name:"成功访问",value:a?.data?.totalAccesses||0},{name:"缓存命中",value:a?.data?.cacheHits||0},{name:"错误次数",value:a?.data?.totalErrors||0}];return s.jsx(F.R,{isOpen:e,onClose:t,size:"3xl",scrollBehavior:"inside",children:(0,s.jsxs)(k.A,{children:[(0,s.jsxs)(D.k,{children:["路由性能统计 - ",r.name]}),s.jsx(N.I,{className:"space-y-6",children:i?s.jsx("div",{children:"加载中..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[s.jsx(d.w,{children:s.jsx(c.G,{children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"text-sm text-gray-500",children:"总访问次数"}),s.jsx("div",{className:"text-2xl font-bold",children:a?.data?.totalAccesses||0})]})})}),s.jsx(d.w,{children:s.jsx(c.G,{children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"text-sm text-gray-500",children:"平均加载时间"}),(0,s.jsxs)("div",{className:"text-2xl font-bold",children:[a?.data?.averageLoadTime?.toFixed(2)||0,"ms"]})]})})}),s.jsx(d.w,{children:s.jsx(c.G,{children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"text-sm text-gray-500",children:"错误率"}),(0,s.jsxs)("div",{className:"text-2xl font-bold",children:[((a?.data?.totalErrors||0)/(a?.data?.totalAccesses||1)*100).toFixed(2),"%"]})]})})})]}),s.jsx(d.w,{children:s.jsx(c.G,{children:s.jsx("div",{className:"h-80",children:s.jsx(e9.h,{width:"100%",height:"100%",children:(0,s.jsxs)(ta,{data:n,children:[s.jsx(ti.q,{strokeDasharray:"3 3"}),s.jsx(tt.K,{dataKey:"time"}),s.jsx(tr.B,{yAxisId:"left"}),s.jsx(tr.B,{yAxisId:"right",orientation:"right"}),s.jsx(tn.u,{}),s.jsx(tl.D,{}),s.jsx(te.x,{yAxisId:"left",type:"monotone",dataKey:"loadTime",stroke:"#8884d8",name:"加载时间(ms)"}),s.jsx(te.x,{yAxisId:"right",type:"monotone",dataKey:"errorCount",stroke:"#ff0000",name:"错误次数"})]})})})})}),s.jsx(d.w,{children:s.jsx(c.G,{children:s.jsx("div",{className:"h-80",children:s.jsx(e9.h,{width:"100%",height:"100%",children:(0,s.jsxs)(to.u,{children:[s.jsx(tu.b,{data:o,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:t})=>`${e}: ${(100*t).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:o.map((e,t)=>s.jsx(td.b,{fill:tc[t%tc.length]},`cell-${t}`))}),s.jsx(tn.u,{})]})})})})})]})}),s.jsx(P.R,{children:s.jsx(l.A,{color:"primary",onPress:t,children:"关闭"})})]})})}var tm=r(34755);function th(){let{user:e,handleUnauthorized:t,isLoading:r}=(0,m.useAuth)(),a=e?.role==="admin",v=(0,h.NL)(),{isOpen:b,onOpen:j,onClose:_}=(0,n.q)(),{isOpen:w,onOpen:A,onClose:V}=(0,n.q)(),[F,k]=i().useState(),{data:D,isLoading:N}=(0,y.a)({queryKey:["routes","all"],queryFn:async()=>{try{return await (0,g._c)()}catch(e){throw e?.status===401?t():tm.Am.error(`获取路由失败: ${e?.message||"未知错误"}`),e}},enabled:a}),C=(0,x.D)({mutationFn:g.ot,onSuccess:()=>{v.invalidateQueries({queryKey:["routes"]}),tm.Am.success("创建成功"),_()},onError:e=>{tm.Am.error("创建失败: "+e.message)}}),E=(0,x.D)({mutationFn:e=>(0,g.fq)(e,{}),onSuccess:()=>{v.invalidateQueries({queryKey:["routes"]}),tm.Am.success("更新成功"),_()},onError:e=>{tm.Am.error("更新失败: "+e.message)}}),O=(0,x.D)({mutationFn:g.qW,onSuccess:()=>{v.invalidateQueries({queryKey:["routes"]}),tm.Am.success("删除成功")},onError:e=>{tm.Am.error("删除失败: "+e.message)}}),I=(0,x.D)({mutationFn:g.rr,onSuccess:()=>{v.invalidateQueries({queryKey:["routes"]}),tm.Am.success("状态更新成功")},onError:e=>{tm.Am.error("状态更新失败: "+e.message)}}),T=async e=>{F?await E.mutateAsync(F.id):await C.mutateAsync(e)},P=e=>{k(e),j()},M=async e=>{confirm("确定要删除该路由吗？")&&await O.mutateAsync(e.id)},L=async e=>{await I.mutateAsync(e.id)},R=e=>{k(e),A()},q=[...S,{header:"创建者",accessorKey:"user.username"}],B=[...S,{header:"所属家庭",accessorKey:"family.name"},{header:"创建者",accessorKey:"user.username"}],U=e=>e.map(e=>({...e,onEdit:P,onDelete:M,onToggleActive:L,onViewStats:R}));return a?(0,s.jsxs)("div",{className:"w-full space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-bold",children:"路由管理"}),s.jsx(l.A,{color:"primary",endContent:s.jsx(f.Z,{className:"w-4 h-4"}),onPress:()=>{k(void 0),j()},children:"新增路由"})]}),(0,s.jsxs)(o.n,{"aria-label":"路由类型",children:[s.jsx(u.r,{title:"个人路由",children:s.jsx(d.w,{children:s.jsx(c.G,{children:s.jsx(p.w,{columns:q,data:U(D?.data?.personalRoutes||[]),isLoading:N,pagination:!0})})})},"personal"),s.jsx(u.r,{title:"家庭路由",children:s.jsx(d.w,{children:s.jsx(c.G,{children:s.jsx(p.w,{columns:B,data:U(D?.data?.familyRoutes||[]),isLoading:N,pagination:!0})})})},"family")]}),s.jsx(e6,{isOpen:b,onClose:_,onSubmit:T,initialData:F}),s.jsx(tf,{isOpen:w,onClose:V,route:F})]}):(0,s.jsxs)("div",{className:"p-4",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"无权访问"}),s.jsx("p",{children:"只有管理员可以访问此页面"})]})}},40005:(e,t,r)=>{"use strict";r.d(t,{w:()=>h});var s=r(95344),a=r(3729),i=r.n(a),n=r(98400),l=r(12873),o=r(20516),u=r(61387),d=r(3394),c=r(84752),f=r(52914),m=r(1629);function h({columns:e,data:t,isLoading:r=!1,pagination:a=!1,pageSize:h=10}){let[y,x]=i().useState(1),g=Math.ceil(t.length/h),p=i().useMemo(()=>{let e=(y-1)*h,r=e+h;return t.slice(e,r)},[y,t,h]),v=i().useCallback((t,r)=>{let s=e.find(e=>e.accessorKey===r);return s?.cell?s.cell({row:{original:t}}):t[r]},[e]);return s.jsx("div",{className:"w-full",children:(0,s.jsxs)(n.b,{"aria-label":"数据表格",bottomContent:a&&g>1?s.jsx("div",{className:"flex w-full justify-center",children:s.jsx(l.g,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:y,total:g,onChange:x})}):null,children:[s.jsx(o.J,{children:e.map((e,t)=>s.jsx(u.j,{children:e.header},e.accessorKey||`column-${t}`))}),s.jsx(d.y,{items:p,loadingContent:s.jsx(c.c,{}),isLoading:r,emptyContent:r?null:"暂无数据",children:t=>s.jsx(f.g,{children:e.map(e=>s.jsx(m.X,{children:v(t,e.accessorKey)},e.accessorKey))},t.id)})]})})}},95396:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var s=r(95344),a=r(3729),i=r.n(a),n=r(8428),l=r(30853),o=r(84752);function u({children:e,requiredRole:t}){let r=(0,n.useRouter)(),{user:u,isLoading:d}=(0,l.useAuth)(),[c,f]=i().useState(!0);return((0,a.useEffect)(()=>{let e=setTimeout(()=>{if(f(!1),!d&&!u){r.push("/auth/login");return}t&&u&&u.role!==t&&"owner"!==u.role&&r.push("/dashboard")},500);return()=>clearTimeout(e)},[u,d,r,t]),d||c)?s.jsx("div",{className:"flex justify-center items-center h-[calc(100vh-200px)]",children:s.jsx(o.c,{size:"lg"})}):!u||t&&u.role!==t&&"owner"!==u.role?null:s.jsx(s.Fragment,{children:e})}},37384:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let s=(0,r(86843).createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/settings/layout.tsx`),{__esModule:a,$$typeof:i}=s,n=s.default},16201:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let s=(0,r(86843).createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/settings/routes/layout.tsx`),{__esModule:a,$$typeof:i}=s,n=s.default},58282:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let s=(0,r(86843).createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/settings/routes/page.tsx`),{__esModule:a,$$typeof:i}=s,n=s.default}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[3715,1599,8974,7279,7721,352,1327,9799,5261,3729,6536,6250,1271,7390,3751,8275,5019,492,2873,3442,9760,7048,4037],()=>r(25935));module.exports=s})();