(()=>{var e={};e.id=8164,e.ids=[8164],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},31298:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>x,tree:()=>l});var n=s(50482),r=s(69108),a=s(62563),i=s.n(a),o=s(68300),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);s.d(t,c);let l=["",{children:["invite",{children:["[token]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,82768)),"/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/invite/[token]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,66053)),"/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,24117)),"/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}],d=["/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/invite/[token]/page.tsx"],m="/invite/[token]/page",u={require:s,loadChunk:()=>Promise.resolve()},x=new n.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/invite/[token]/page",pathname:"/invite/[token]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},32328:(e,t,s)=>{Promise.resolve().then(s.bind(s,29394))},29394:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var n=s(95344),r=s(3729),a=s(8428),i=s(84752),o=s(56686),c=s(40237),l=s(44738),d=s(96548),m=s(89023),u=s(30853);function x({params:e}){let{token:t}=e,[s,x]=(0,r.useState)(null),[p,h]=(0,r.useState)(!0),[f,g]=(0,r.useState)(null),[j,v]=(0,r.useState)(!1),[w,y]=(0,r.useState)(!1),{showToast:P}=(0,m.useToast)(),N=(0,a.useRouter)(),{user:_}=(0,u.useAuth)();(0,r.useEffect)(()=>{p&&!w&&(async()=>{try{let e=await (0,d.Io)(`/families/invitations/${t}`);x(e.data),h(!1)}catch(e){console.error("获取邀请信息失败:",e),g(e.message||"邀请不存在或已过期"),h(!1)}})()},[t,p,w]),(0,r.useEffect)(()=>{if(!p&&!w&&!_){y(!0);let e=`/auth/login?redirect=/invite/${t}`;console.log("重定向到登录页面:",e),N.push(e)}},[_,t,N,p,w]);let b=async()=>{if(s&&_){v(!0);try{await (0,d.Io)(`/families/invitations/${t}/accept`,{method:"POST"}),P("已成功加入家庭","success"),N.push("/settings/family")}catch(e){P(e.message||"接受邀请失败","error"),v(!1)}}},k=async()=>{if(s&&_){v(!0);try{await (0,d.Io)(`/families/invitations/${t}/reject`,{method:"POST"}),P("已拒绝邀请","success"),N.push("/settings/family")}catch(e){P(e.message||"拒绝邀请失败","error"),v(!1)}}};return p?n.jsx("div",{className:"flex justify-center items-center min-h-screen",children:n.jsx(i.c,{size:"lg"})}):f?n.jsx("div",{className:"max-w-md mx-auto mt-12 p-4",children:n.jsx(o.w,{children:(0,n.jsxs)(c.G,{className:"flex flex-col items-center text-center p-8 gap-4",children:[n.jsx("div",{className:"text-danger text-5xl mb-4",children:"✗"}),n.jsx("h1",{className:"text-2xl font-bold",children:"邀请无效"}),n.jsx("p",{className:"text-default-500",children:f}),n.jsx(l.A,{color:"primary",onPress:()=>N.push("/settings/family"),className:"mt-4",children:"返回家庭设置"})]})})}):s&&_?n.jsx("div",{className:"max-w-md mx-auto mt-12 p-4",children:n.jsx(o.w,{children:(0,n.jsxs)(c.G,{className:"flex flex-col items-center text-center p-8 gap-4",children:[n.jsx("div",{className:"text-primary text-5xl mb-4",children:"\uD83C\uDFE0"}),n.jsx("h1",{className:"text-2xl font-bold",children:"家庭邀请"}),(0,n.jsxs)("p",{className:"text-default-700",children:["您被邀请加入 ",n.jsx("span",{className:"font-bold",children:s.family_name})," 家庭"]}),(0,n.jsxs)("p",{className:"text-default-500",children:["您将以 ",n.jsx("span",{className:"font-medium",children:"admin"===s.role?"管理员":"成员"})," 身份加入此家庭"]}),(0,n.jsxs)("div",{className:"text-sm text-default-400 mt-2",children:["邀请将于 ",new Date(s.expires_at).toLocaleString()," 过期"]}),(0,n.jsxs)("div",{className:"flex gap-4 mt-6 w-full",children:[n.jsx(l.A,{color:"danger",variant:"flat",onPress:k,isDisabled:j,className:"flex-1",children:"拒绝"}),n.jsx(l.A,{color:"primary",onPress:b,isDisabled:j,isLoading:j,className:"flex-1",children:"接受"})]})]})})}):n.jsx("div",{className:"flex justify-center items-center min-h-screen",children:n.jsx(i.c,{size:"lg"})})}},82768:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>a,__esModule:()=>r,default:()=>i});let n=(0,s(86843).createProxy)(String.raw`/home/runner/work/meow-accounting/meow-accounting/frontend/src/app/invite/[token]/page.tsx`),{__esModule:r,$$typeof:a}=n,i=n.default}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),n=t.X(0,[8974,4037],()=>s(31298));module.exports=n})();