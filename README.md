# å–µå‘œè®°è´¦

ä¸€ä¸ªç®€å•æ˜“ç”¨çš„ä¸ªäººè®°è´¦åº”ç”¨ï¼Œæ”¯æŒæ”¶æ”¯è®°å½•ã€åˆ†ç±»ç»Ÿè®¡å’Œæ•°æ®å¯è§†åŒ–ã€‚æ”¯æŒç§»åŠ¨ç«¯å’Œå¹³æ¿è®¾å¤‡ã€‚

## æœ€è¿‘æ›´æ–°

### 2024-03-04 (è®¡åˆ’ä¸­)
- ğŸ‘¥ æ·»åŠ ç”¨æˆ·ç³»ç»Ÿ
  - ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
  - ä¸ªäººä¿¡æ¯ç®¡ç†
  - è´¦å·å®‰å…¨è®¾ç½®
- ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ æ–°å¢å®¶åº­åŠŸèƒ½
  - åˆ›å»ºå’Œç®¡ç†å®¶åº­
  - é‚€è¯·å®¶åº­æˆå‘˜
  - å®¶åº­è´¦å•å…±äº«
  - æˆå‘˜æƒé™ç®¡ç†
- ğŸ”’ éšç§æ¨¡å¼
  - é¦–é¡µéšç§æ§åˆ¶
  - è®¿å®¢æµè§ˆæ¨¡å¼
  - æƒé™åˆ†çº§ç®¡ç†

### 2024-03-04
- ğŸ¨ ä¼˜åŒ–åˆ†ç±»ç»Ÿè®¡ç»„ä»¶çš„å¯è®¿é—®æ€§
- ğŸ“Š æ”¹è¿›å›¾è¡¨å±•ç¤ºæ•ˆæœ
- ğŸ”§ ä¿®å¤æ—¶é—´èŒƒå›´é€‰æ‹©å™¨çš„äº¤äº’é—®é¢˜
- â™¿ æ·»åŠ  ARIA æ ‡ç­¾æ”¯æŒ

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ“ å¿«é€Ÿè®°è´¦ï¼šæ”¯æŒæ”¶å…¥å’Œæ”¯å‡ºè®°å½•
- ğŸ“Š æ•°æ®ç»Ÿè®¡ï¼šç›´è§‚å±•ç¤ºæ”¶æ”¯æƒ…å†µ
- ğŸ“… æ—¶é—´ç®¡ç†ï¼šæŒ‰æ—¥æœŸæŸ¥çœ‹å’Œç»Ÿè®¡
- ğŸ·ï¸ åˆ†ç±»ç®¡ç†ï¼šè‡ªå®šä¹‰æ”¶æ”¯åˆ†ç±»
- ğŸ“± å“åº”å¼è®¾è®¡ï¼šå®Œç¾é€‚é…æ‰‹æœºã€å¹³æ¿å’Œæ¡Œé¢ç«¯
- ğŸ’¾ æœ¬åœ°å­˜å‚¨ï¼šæ•°æ®ä¿å­˜åœ¨æœ¬åœ°SQLiteæ•°æ®åº“
- ğŸš€ PWAæ”¯æŒï¼šå¯å®‰è£…åˆ°ç§»åŠ¨è®¾å¤‡
- â™¿ å¯è®¿é—®æ€§ï¼šæ”¯æŒå±å¹•é˜…è¯»å™¨
- ğŸ‘¥ å¤šç”¨æˆ·æ”¯æŒï¼šç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å®¶åº­å…±äº«ï¼šå®¶åº­æˆå‘˜åä½œè®°è´¦
- ï¿½ï¿½ éšç§ä¿æŠ¤ï¼šå¯æ§çš„æ•°æ®å¯è§æ€§

## æŠ€æœ¯æ ˆ

### å‰ç«¯

- Next.js 14
- TypeScript
- NextUI
- TailwindCSS
- Chart.js
- Dayjs

### åç«¯

- Node.js
- Express
- TypeScript
- SQLite3
- PM2
- Winston

## ç³»ç»Ÿè¦æ±‚

- Node.js 16.x æˆ–æ›´é«˜ç‰ˆæœ¬
- NPM 7.x æˆ–æ›´é«˜ç‰ˆæœ¬
- SQLite3

## é¡¹ç›®ç»“æ„

```
bill-app/
â”œâ”€â”€ frontend/                # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/           # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ globals.css # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ components/    # é€šç”¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ utils/        # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ public/           # é™æ€èµ„æº
â””â”€â”€ backend/              # åç«¯é¡¹ç›®
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ controllers/  # æ§åˆ¶å™¨
    â”‚   â”œâ”€â”€ models/      # æ•°æ®æ¨¡å‹
    â”‚   â”œâ”€â”€ routes/      # è·¯ç”±
    â”‚   â””â”€â”€ utils/       # å·¥å…·å‡½æ•°
    â”œâ”€â”€ logs/           # æ—¥å¿—æ–‡ä»¶
    â””â”€â”€ database/        # SQLiteæ•°æ®åº“
```

## å®‰è£…å’Œè¿è¡Œ

### 1. å…‹éš†é¡¹ç›®

```bash
git clone [é¡¹ç›®åœ°å€]
cd bill-app
```

### 2. åç«¯è®¾ç½®

```bash
cd backend
npm install
npm install -g pm2  # å…¨å±€å®‰è£…PM2

# å¼€å‘ç¯å¢ƒ
npm run dev

# ç”Ÿäº§ç¯å¢ƒ
npm run build
npm start  # ä½¿ç”¨PM2å¯åŠ¨æœåŠ¡
```

åç«¯æœåŠ¡å°†åœ¨ http://localhost:3001 è¿è¡Œ

PM2 å¸¸ç”¨å‘½ä»¤ï¼š
- `npm run logs` - æŸ¥çœ‹æ—¥å¿—
- `npm run stop` - åœæ­¢æœåŠ¡
- `npm run restart` - é‡å¯æœåŠ¡

### 3. å‰ç«¯è®¾ç½®

```bash
cd frontend
npm install
npm run dev  # å¼€å‘ç¯å¢ƒ
npm run build  # ç”Ÿäº§ç¯å¢ƒæ„å»º
npm start  # ç”Ÿäº§ç¯å¢ƒè¿è¡Œ
```

å‰ç«¯åº”ç”¨å°†åœ¨ http://localhost:3000 è¿è¡Œ

## ç§»åŠ¨ç«¯é€‚é…

### å“åº”å¼è®¾è®¡

- è‡ªé€‚åº”å¸ƒå±€ï¼šé€‚é…ä¸åŒå±å¹•å°ºå¯¸
- è§¦æ‘¸ä¼˜åŒ–ï¼šé€‚åˆæ‰‹æŒ‡æ“ä½œçš„æŒ‰é’®å’Œè¡¨å•
- åº•éƒ¨å¿«æ·æ“ä½œï¼šç§»åŠ¨ç«¯ç‰¹æœ‰çš„å¿«é€Ÿè®°è´¦æŒ‰é’®
- é¡¶éƒ¨å›ºå®šå¯¼èˆªï¼šæ–¹ä¾¿å•æ‰‹æ“ä½œ

### iPadä¼˜åŒ–

- åŒåˆ—å¸ƒå±€ï¼šå……åˆ†åˆ©ç”¨å±å¹•ç©ºé—´
- æ‰‹åŠ¿æ”¯æŒï¼šæ”¯æŒæ»‘åŠ¨æ“ä½œ
- é”®ç›˜ä¼˜åŒ–ï¼šæ”¯æŒå¤–æ¥é”®ç›˜å¿«æ·æ“ä½œ

### PWAæ”¯æŒ

1. å®‰è£…åˆ°ä¸»å±å¹•
   - iOSï¼šä½¿ç”¨Safariæµè§ˆå™¨è®¿é—® -> åˆ†äº« -> æ·»åŠ åˆ°ä¸»å±å¹•
   - Androidï¼šä½¿ç”¨Chromeè®¿é—® -> èœå• -> æ·»åŠ åˆ°ä¸»å±å¹•

2. ç¦»çº¿æ”¯æŒ
   - åŸºæœ¬åŠŸèƒ½å¯ç¦»çº¿ä½¿ç”¨
   - æ•°æ®ä¼šåœ¨è”ç½‘åè‡ªåŠ¨åŒæ­¥

## APIæ–‡æ¡£

### åˆ†ç±»ç®¡ç†

#### è·å–æ‰€æœ‰åˆ†ç±»
- GET `/api/categories`
- å“åº”ï¼šåˆ†ç±»åˆ—è¡¨

#### åˆ›å»ºåˆ†ç±»
- POST `/api/categories`
- è¯·æ±‚ä½“ï¼š
```json
{
  "name": "åˆ†ç±»åç§°",
  "type": "income|expense",
  "icon": "emojiå›¾æ ‡"
}
```

#### æ›´æ–°åˆ†ç±»
- PUT `/api/categories/:id`
- è¯·æ±‚ä½“ï¼šåŒåˆ›å»ºåˆ†ç±»

#### åˆ é™¤åˆ†ç±»
- DELETE `/api/categories/:id`

### äº¤æ˜“è®°å½•

#### è·å–æ‰€æœ‰äº¤æ˜“
- GET `/api/transactions`
- å“åº”ï¼šäº¤æ˜“è®°å½•åˆ—è¡¨

#### æŒ‰æ—¥æœŸèŒƒå›´è·å–äº¤æ˜“
- GET `/api/transactions/range?startDate=YYYY-MM-DD&endDate=YYYY-MM-DD`

#### åˆ›å»ºäº¤æ˜“
- POST `/api/transactions`
- è¯·æ±‚ä½“ï¼š
```json
{
  "amount": 100,
  "type": "income|expense",
  "category_id": 1,
  "description": "æè¿°",
  "date": "YYYY-MM-DD"
}
```

#### æ›´æ–°äº¤æ˜“
- PUT `/api/transactions/:id`
- è¯·æ±‚ä½“ï¼šåŒåˆ›å»ºäº¤æ˜“

#### åˆ é™¤äº¤æ˜“
- DELETE `/api/transactions/:id`

### ç»Ÿè®¡æ•°æ®

#### è·å–ç»Ÿè®¡ä¿¡æ¯
- GET `/api/statistics?startDate=YYYY-MM-DD&endDate=YYYY-MM-DD`
- å“åº”ï¼šåŒ…å«æ”¶æ”¯ç»Ÿè®¡å’Œåˆ†ç±»ç»Ÿè®¡

### ç”¨æˆ·ç®¡ç†

#### ç”¨æˆ·æ³¨å†Œ
- POST `/api/auth/register`
- è¯·æ±‚ä½“ï¼š
```json
{
  "username": "ç”¨æˆ·å",
  "email": "é‚®ç®±",
  "password": "å¯†ç "
}
```

#### ç”¨æˆ·ç™»å½•
- POST `/api/auth/login`
- è¯·æ±‚ä½“ï¼š
```json
{
  "email": "é‚®ç®±",
  "password": "å¯†ç "
}
```

#### è·å–ç”¨æˆ·ä¿¡æ¯
- GET `/api/user/profile`
- å“åº”ï¼šç”¨æˆ·ä¸ªäººä¿¡æ¯

#### æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- PUT `/api/user/profile`
- è¯·æ±‚ä½“ï¼šç”¨æˆ·ä¿¡æ¯å­—æ®µ

### å®¶åº­ç®¡ç†

#### åˆ›å»ºå®¶åº­
- POST `/api/family`
- è¯·æ±‚ä½“ï¼š
```json
{
  "name": "å®¶åº­åç§°",
  "description": "æè¿°"
}
```

#### è·å–å®¶åº­ä¿¡æ¯
- GET `/api/family/:id`
- å“åº”ï¼šå®¶åº­è¯¦ç»†ä¿¡æ¯

#### é‚€è¯·æˆå‘˜
- POST `/api/family/:id/invite`
- è¯·æ±‚ä½“ï¼š
```json
{
  "email": "æˆå‘˜é‚®ç®±",
  "role": "member|admin"
}
```

#### ç®¡ç†æˆå‘˜æƒé™
- PUT `/api/family/:id/members/:userId`
- è¯·æ±‚ä½“ï¼š
```json
{
  "role": "member|admin",
  "permissions": ["read", "write", "manage"]
}
```

### éšç§è®¾ç½®

#### è·å–éšç§è®¾ç½®
- GET `/api/settings/privacy`
- å“åº”ï¼šå½“å‰éšç§è®¾ç½®

#### æ›´æ–°éšç§è®¾ç½®
- PUT `/api/settings/privacy`
- è¯·æ±‚ä½“ï¼š
```json
{
  "privacyMode": true,
  "guestAccess": false,
  "dataVisibility": "private|family|public"
}
```

## ä½¿ç”¨è¯´æ˜

1. æ·»åŠ äº¤æ˜“è®°å½•
   - ç‚¹å‡»å³ä¸Šè§’"è®°ä¸€ç¬”"æŒ‰é’®
   - é€‰æ‹©æ”¶å…¥æˆ–æ”¯å‡º
   - å¡«å†™é‡‘é¢å’Œé€‰æ‹©åˆ†ç±»
   - å¯é€‰å¡«å†™æè¿°
   - é€‰æ‹©æ—¥æœŸ
   - ç‚¹å‡»ä¿å­˜

2. æŸ¥çœ‹ç»Ÿè®¡
   - é¦–é¡µé¡¶éƒ¨æ˜¾ç¤ºæœ¬æœˆæ”¶æ”¯ç»Ÿè®¡
   - å›¾è¡¨å±•ç¤ºåˆ†ç±»ç»Ÿè®¡
   - åˆ—è¡¨æ˜¾ç¤ºæœ€è¿‘äº¤æ˜“è®°å½•

3. æ•°æ®ç®¡ç†
   - æ‰€æœ‰æ•°æ®ä¿å­˜åœ¨æœ¬åœ°SQLiteæ•°æ®åº“
   - æ•°æ®åº“æ–‡ä»¶ä½äº `backend/database/bill.db`
   - å¯ä»¥é€šè¿‡å¤åˆ¶æ•°æ®åº“æ–‡ä»¶è¿›è¡Œå¤‡ä»½

## å¸¸è§é—®é¢˜è§£å†³

### 1. æ¨¡å—æ‰¾ä¸åˆ°é”™è¯¯

é—®é¢˜ï¼š`Module not found: Can't resolve './globals.css'`
è§£å†³ï¼šç¡®ä¿å…¨å±€æ ·å¼æ–‡ä»¶ `globals.css` ä½äº `frontend/src/app/` ç›®å½•ä¸‹ï¼Œè€Œä¸æ˜¯ `src/styles/` ç›®å½•ã€‚

### 2. åç«¯è¿æ¥é”™è¯¯

é—®é¢˜ï¼šå‰ç«¯æ— æ³•è¿æ¥åˆ°åç«¯API
è§£å†³ï¼š
- ç¡®ä¿åç«¯æœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼ˆhttp://localhost:3001ï¼‰
- æ£€æŸ¥CORSè®¾ç½®æ˜¯å¦æ­£ç¡®
- ç¡®è®¤APIè¯·æ±‚åœ°å€æ˜¯å¦æ­£ç¡®

### 3. æ•°æ®åº“é”™è¯¯

é—®é¢˜ï¼šæ•°æ®åº“æ“ä½œå¤±è´¥
è§£å†³ï¼š
- ç¡®ä¿ `backend/database` ç›®å½•å­˜åœ¨
- æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æƒé™
- ç¡®ä¿SQLite3æ­£ç¡®å®‰è£…

### 4. PM2ç›¸å…³é—®é¢˜

é—®é¢˜ï¼šPM2å¯åŠ¨å¤±è´¥
è§£å†³ï¼š
- ç¡®ä¿å…¨å±€å®‰è£…äº†PM2ï¼š`npm install -g pm2`
- æ£€æŸ¥æ˜¯å¦å·²ç¼–è¯‘TypeScriptï¼š`npm run build`
- æ£€æŸ¥æ—¥å¿—æ–‡ä»¶ï¼š`npm run logs`

### 5. ç§»åŠ¨ç«¯æ˜¾ç¤ºé—®é¢˜

é—®é¢˜ï¼šç§»åŠ¨ç«¯é¡µé¢æ˜¾ç¤ºå¼‚å¸¸
è§£å†³ï¼š
- ç¡®ä¿æ·»åŠ äº†viewport metaæ ‡ç­¾
- æ£€æŸ¥åª’ä½“æŸ¥è¯¢æ˜¯å¦æ­£ç¡®
- æµ‹è¯•ä¸åŒè®¾å¤‡çš„æ˜¾ç¤ºæ•ˆæœ

## éƒ¨ç½²è¯´æ˜

### åç«¯éƒ¨ç½²

1. å‡†å¤‡å·¥ä½œ
   ```bash
   cd backend
   npm install
   npm run build
   ```

2. ä½¿ç”¨PM2éƒ¨ç½²
   ```bash
   npm start  # å¯åŠ¨æœåŠ¡
   pm2 save   # ä¿å­˜å½“å‰è¿›ç¨‹åˆ—è¡¨
   pm2 startup # è®¾ç½®å¼€æœºè‡ªå¯
   ```

3. Nginxé…ç½®ï¼ˆå¯é€‰ï¼‰
   ```nginx
   location /api {
     proxy_pass http://localhost:3001;
     proxy_http_version 1.1;
     proxy_set_header Upgrade $http_upgrade;
     proxy_set_header Connection 'upgrade';
     proxy_set_header Host $host;
     proxy_cache_bypass $http_upgrade;
   }
   ```

### å‰ç«¯éƒ¨ç½²

1. æ„å»º
   ```bash
   cd frontend
   npm install
   npm run build
   ```

2. ä½¿ç”¨Nginxéƒ¨ç½²
   ```nginx
   location / {
     root /path/to/frontend/dist;
     try_files $uri $uri/ /index.html;
   }
   ```

## æ³¨æ„äº‹é¡¹

1. é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“å’Œé»˜è®¤åˆ†ç±»
2. ç¡®ä¿åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œï¼Œå¦åˆ™å‰ç«¯æ— æ³•è·å–å’Œä¿å­˜æ•°æ®
3. å¦‚éœ€å¤‡ä»½æ•°æ®ï¼Œç›´æ¥å¤åˆ¶ `bill.db` æ–‡ä»¶å³å¯
4. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰è¯·ä¿®æ”¹ç¯å¢ƒå˜é‡
5. å®šæœŸæ£€æŸ¥æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œé¿å…å ç”¨è¿‡å¤šç£ç›˜ç©ºé—´

## å¼€å‘è®¡åˆ’

### è¿›è¡Œä¸­
- [ ] ç”¨æˆ·ç³»ç»Ÿå¼€å‘
  - [ ] ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
  - [ ] ä¸ªäººä¿¡æ¯ç®¡ç†
  - [ ] è´¦å·å®‰å…¨è®¾ç½®
- [ ] å®¶åº­åŠŸèƒ½å®ç°
  - [ ] åˆ›å»ºå’Œç®¡ç†å®¶åº­
  - [ ] é‚€è¯·å®¶åº­æˆå‘˜
  - [ ] æƒé™ç®¡ç†ç³»ç»Ÿ
- [ ] éšç§æ¨¡å¼
  - [ ] é¦–é¡µéšç§æ§åˆ¶
  - [ ] è®¿å®¢æ¨¡å¼
  - [ ] æƒé™ç®¡ç†

### åç»­è®¡åˆ’
- [ ] æ·»åŠ æ•°æ®å¯¼å‡ºåŠŸèƒ½
- [ ] æ”¯æŒé¢„ç®—ç®¡ç†
- [ ] æ·»åŠ å›¾è¡¨åˆ†æ
- [ ] æ”¯æŒå¤šå¸ç§
- [ ] æ·»åŠ è´¦æˆ·ç®¡ç†
- [ ] ä¼˜åŒ–ç§»åŠ¨ç«¯æ€§èƒ½
- [ ] æ·»åŠ æ‰‹åŠ¿æ“ä½œ
- [ ] æ”¯æŒæ•°æ®åŒæ­¥
- [ ] æ·»åŠ å®šæ—¶å¤‡ä»½

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestã€‚

## è®¸å¯è¯

MIT License 